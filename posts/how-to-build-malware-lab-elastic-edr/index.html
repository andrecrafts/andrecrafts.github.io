<!DOCTYPE html><html lang="en" data-mode="dark" class="scroll-smooth" data-astro-cid-ouamjn2i> <head><!-- Basic Meta Tags --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Astro v5.14.6"><!-- Icons & Links --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/png" href="/favicon.png" sizes="96x96"><link rel="icon" href="/favicon.ico" sizes="any"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical" href="https://andrecrafts.com"><!-- Page Title & Description --><title>How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#39;s AD Lab</title><meta name="description" content="Learn how to create your own malware testing lab with Elastic EDR and TCM Security's AD lab for malware evasion testing."><!-- Social Media / Open Graph Tags --><meta property="og:title" content="How to Easily Build a Malware Testing Lab with Elastic EDR and TCM's AD Lab | AndreCrafts"><meta property="og:description" content="Learn how to create your own malware testing lab with Elastic EDR and TCM Security's AD lab for malware evasion testing."><meta property="og:type" content="website"><meta property="og:url" content="https://andrecrafts.com/posts/how-to-build-malware-lab-elastic-edr/"><meta property="og:image" content="https://andrecrafts.com/heroImages/malware-testing-lab.png"><meta property="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/_astro/about.B3NFc2Ml.css">
<style>@font-face{font-family:Inter;src:url(/fonts/Inter.ttf) format("truetype-variations");font-weight:100 900;font-display:swap;font-style:normal}@font-face{font-family:Montserrat;src:url(/fonts/Montserrat.ttf) format("truetype-variations");font-weight:100 900;font-display:swap;font-style:normal}header[data-astro-cid-3ef6ksr2]#main-header[aria-expanded=true],header[data-astro-cid-3ef6ksr2]#main-header[data-scrolled=true]{background-color:color-mix(in srgb,var(--colors-header) var(--un-bg-opacity),transparent);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,--un-gradient-from,--un-gradient-via,--un-gradient-to;transition-timing-function:var(--un-ease, var(--default-transition-timingFunction));transition-duration:var(--un-duration, var(--default-transition-duration));--un-duration:.3s;transition-duration:.3s}@supports (color: color-mix(in lab,red,red)){header[data-astro-cid-3ef6ksr2]#main-header[aria-expanded=true],header[data-astro-cid-3ef6ksr2]#main-header[data-scrolled=true]{background-color:color-mix(in oklab,var(--colors-header) var(--un-bg-opacity),transparent)}}a[data-astro-cid-3ef6ksr2][aria-current=page]{color:var(--color-sky-500)}.highlight-btn[data-astro-cid-sz7xmlte]:hover{color:color-mix(in srgb,var(--colors-sky-400) var(--un-text-opacity),transparent)}@property --un-text-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.highlight-btn[data-astro-cid-sz7xmlte]:hover{color:color-mix(in oklab,var(--colors-sky-400) var(--un-text-opacity),transparent)}}.tooltip-arrow[data-astro-cid-sz7xmlte]{background-color:color-mix(in srgb,var(--colors-secondary-accent) var(--un-bg-opacity),transparent);clip-path:polygon(50% 100%,0 0,100% 0)}@property --un-bg-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.tooltip-arrow[data-astro-cid-sz7xmlte]{background-color:color-mix(in oklab,var(--colors-secondary-accent) var(--un-bg-opacity),transparent)}}:root{@media (min-width: 1024px){font-size:1.27rem}--background: hsl(214, 44%, 8%)}html{scroll-padding-top:3rem}
</style>
<link rel="stylesheet" href="/_astro/_slug_.xiPQw92k.css">
<style>.title-clamp[data-astro-cid-r7kjq4ip]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden}.description-clamp[data-astro-cid-r7kjq4ip]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden;overflow-wrap:anywhere}.hide-scrollbar[data-astro-cid-oyovcjtc]{scrollbar-width:thin;scrollbar-color:transparent transparent}.dot[data-astro-cid-oyovcjtc].active{background-color:color-mix(in srgb,var(--colors-sky-500) var(--un-bg-opacity),transparent)}@property --un-bg-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.dot[data-astro-cid-oyovcjtc].active{background-color:color-mix(in oklab,var(--colors-sky-500) var(--un-bg-opacity),transparent)}}@media (min-width: 768px){.dot[data-astro-cid-oyovcjtc]:nth-child(n+3){display:none}}
.img-class[data-astro-cid-qqdm6bys]{cursor:pointer;transition:opacity .2s ease-in-out}.img-class[data-astro-cid-qqdm6bys]:hover{opacity:.85}
</style><style>video[data-astro-cid-rk4szbjr]{max-width:100%;height:auto;margin-block:1.5rem;border-radius:.5rem;display:block}
</style></head> <body class="bg-background text-white font-sans selection:bg-sky-500 selection:text-white" data-astro-cid-ouamjn2i> <header id="main-header" data-scrolled="true" class="sticky top-0 z-50" data-astro-cid-3ef6ksr2> <div class="mx-auto px-4 py-1" data-astro-cid-3ef6ksr2> <div class="flex items-center justify-between -ml-1" data-astro-cid-3ef6ksr2> <!-- Logo --> <a href="/" class="flex items-center gap-1" data-astro-cid-3ef6ksr2> <img src="/images/logo.png" alt="AndreCrafts Logo" class="h-10 w-10 object-contain" data-astro-cid-3ef6ksr2> <span class="text-xl font-bold font-display text-white" data-astro-cid-3ef6ksr2>
AndreCrafts
</span> </a> <nav id="menu" class="
  bg-header absolute top-full left-0 w-full 
  border-t-1 border-white 
  hidden flex-col gap-4 p-4
  md:flex md:static md:w-auto md:bg-transparent
  md:border-t-0 md:flex-row md:items-center md:gap-8 md:p-0 " data-astro-cid-3ef6ksr2> <a href="/#services" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> Services </a><a href="/work" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> Work </a><a href="/about" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> About </a> <a href="/#contact" class="
  text-center text-white font-bold px-3 py-1.5 rounded-md 
  bg-[linear-gradient(to_top_right,theme(colors.cyan.500),theme(colors.blue.600))] 
  hover:bg-[linear-gradient(to_top_right,theme(colors.cyan.400),theme(colors.blue.500))] 
  transition-all duration-300
" data-astro-cid-3ef6ksr2>
Contact
</a> </nav> <!-- Mobile Menu Button (Hamburger) --> <button id="mobile-menu-button" class="cursor-pointer text-white md:hidden" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open main menu" data-astro-cid-3ef6ksr2> <svg class="h-6 w-6" id="hamburger-icon" data-astro-cid-3ef6ksr2="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path> </svg> <svg class="h-6 w-6 hidden" id="close-icon" data-astro-cid-3ef6ksr2="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </div> </div> </header> <script type="module">function n(){const t=window.location.pathname,c=window.location.hash;document.querySelectorAll("#menu a").forEach(a=>{const i=new URL(a.href),s=i.pathname,o=i.hash,d=["/work","/posts","/projects"],r=t.endsWith("/")&&t.length>1?t.slice(0,-1):t;if(o==="#contact")return;let e=!1;o?e=o===c:s==="/work"?e=d.includes(r):s==="/"?e=r==="/":e=r===s,e?a.setAttribute("aria-current","page"):a.removeAttribute("aria-current")})}document.addEventListener("DOMContentLoaded",n);window.addEventListener("hashchange",n);window.addEventListener("urlchange",n);window.addEventListener("popstate",n);</script>  <script type="module">const e=document.getElementById("mobile-menu-button"),t=document.getElementById("menu"),i=document.getElementById("hamburger-icon"),d=document.getElementById("close-icon"),o=document.getElementById("main-header");function c(){if(!t||!i||!d||!e||!o)return;t.classList.toggle("hidden"),t.classList.toggle("flex"),i.classList.toggle("hidden"),d.classList.toggle("hidden");const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!n)),o.setAttribute("aria-expanded",String(!n))}e&&t&&i&&d&&o&&(e.addEventListener("click",c),t.querySelectorAll("a").forEach(s=>{s.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"&&c()})}));</script>  <main data-astro-cid-ouamjn2i> <!-- The content of the page will be injected here -->  <div id="content-div" class="max-w-7xl mx-auto pt-4 px-4 lg:px-0 lg:ml-[17%] lg:grid lg:grid-cols-12 lg:gap-x-12" data-astro-cid-scuu7fyy> <article class="lg:col-span-7" data-astro-cid-scuu7fyy> <header data-astro-cid-scuu7fyy> <h1 class="text-3xl md:text-4xl mb-2 font-semibold" data-astro-cid-scuu7fyy>How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#39;s AD Lab</h1> <h3 class="mb-4 wrap-anywhere" data-astro-cid-scuu7fyy>Learn how to create your own malware testing lab with Elastic EDR and TCM Security&#39;s AD lab for malware evasion testing.</h3> <div class="w-full aspect-[204/100] 
rounded-lg bg-black mb-2 overflow-hidden flex justify-center items-center" data-astro-cid-scuu7fyy> <!-- If scale exists, then apply the img-class class --><img src="/_astro/malware-testing-lab.FpYsyurl_aXFJy.png" alt="Hero image for How to Easily Build a Malware Testing Lab with Elastic EDR and TCM's AD Lab" data-astro-cid-scuu7fyy="true" data-full-src="/_astro/malware-testing-lab.FpYsyurl.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="1285" height="630" class="h-full w-auto object-cover img-class">  </div> <div class="text-sm text-subtle-gray mb-6 flex flex-wrap justify-between gap-x-4 gap-y-2 " data-astro-cid-scuu7fyy> <span class="" data-astro-cid-scuu7fyy>Posted <span class="font-semibold text-slate-300" data-astro-cid-scuu7fyy>22 Sept 2024</span></span> <span data-astro-cid-scuu7fyy>By <a class="font-semibold text-slate-300 hover:text-sky-500 hover:underline" href="/about" data-astro-cid-scuu7fyy>André Oliveira</a></span> </div> <!-- Project --> <div class="md:text-lg flex flex-row justify-left items-center gap-2 mb-6 text-sky-500" data-astro-cid-scuu7fyy>  <div id="share-trigger" class="cursor-pointer font-semibold flex items-center gap-1 hover:text-sky-400 hover:underline transition-colors " data-astro-cid-scuu7fyy> <svg class="w-6 h-auto" data-astro-cid-scuu7fyy="true" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g fill="currentColor"> <path d="M6.746704,4 L10.2109085,4 C10.625122,4 10.9609085,4.33578644 10.9609085,4.75 C10.9609085,5.12969577 10.6787546,5.44349096 10.312679,5.49315338 L10.2109085,5.5 L6.746704,5.5 C5.55584001,5.5 4.58105908,6.42516159 4.50189481,7.59595119 L4.496704,7.75 L4.496704,17.25 C4.496704,18.440864 5.42186559,19.4156449 6.59265519,19.4948092 L6.746704,19.5 L16.247437,19.5 C17.438301,19.5 18.4130819,18.5748384 18.4922462,17.4040488 L18.497437,17.25 L18.497437,16.752219 C18.497437,16.3380054 18.8332234,16.002219 19.247437,16.002219 C19.6271328,16.002219 19.940928,16.2843728 19.9905904,16.6504484 L19.997437,16.752219 L19.997437,17.25 C19.997437,19.2542592 18.4250759,20.8912737 16.4465956,20.994802 L16.247437,21 L6.746704,21 C4.74244483,21 3.10543026,19.4276389 3.00190201,17.4491586 L2.996704,17.25 L2.996704,7.75 C2.996704,5.74574083 4.56906505,4.10872626 6.54754543,4.00519801 L6.746704,4 L10.2109085,4 L6.746704,4 Z M14.5006976,6.51985416 L14.5006976,3.75 C14.5006976,3.12602964 15.20748,2.7899466 15.6876724,3.13980165 L15.7698701,3.20874226 L21.7644714,8.95874226 C22.0442311,9.22708681 22.0696965,9.65811353 21.8408438,9.95607385 L21.7645584,10.0411742 L15.7699571,15.7930263 C15.3196822,16.2250675 14.5877784,15.9476738 14.5078455,15.3589039 L14.5006976,15.2518521 L14.5006976,12.5265324 L14.1572053,12.5566444 C11.7575155,12.8069657 9.45747516,13.8878535 7.24265269,15.8173548 C6.72354372,16.2695904 5.9204142,15.8420034 6.00578894,15.1588473 C6.67057872,9.83929778 9.45245108,6.90729635 14.2013326,6.53950096 L14.5006976,6.51985416 L14.5006976,3.75 L14.5006976,6.51985416 Z M16.0006976,5.50864341 L16.0006976,7.25 C16.0006976,7.66421356 15.6649111,8 15.2506976,8 C11.3772927,8 8.97667396,9.67612932 7.93942891,13.1571821 L7.86037164,13.4357543 L8.21256044,13.1989337 C10.4490427,11.7371925 12.7984587,11 15.2506976,11 C15.6303934,11 15.9441885,11.2821539 15.993851,11.6482294 L16.0006976,11.75 L16.0006976,13.4928166 L20.1619348,9.50008715 L16.0006976,5.50864341 Z" id="🎨-Color"></path> </g> </g> </svg>
Share
</div>  </div> </header> <hr class="mt-6 mb-6 border-gray-700" data-astro-cid-scuu7fyy> <!-- ToC Button section --> <button id="toc-trigger" class="flex items-center gap-1 lg:hidden mb-6 cursor-pointer font-semibold py-2 pl-4 pr-2 rounded-md bg-secondary-accent hover:bg-white/20 transition-colors" data-astro-cid-scuu7fyy>
Table of Contents
<svg class="w-5 h-auto rotate-180" data-astro-cid-scuu7fyy="true" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path> </svg> </button> <!-- Content sections --> <div class="content-style " data-astro-cid-scuu7fyy>  <h2 id="introduction">Introduction</h2>
<p>I wanted to test malware evasion techniques specifically against Elastic EDR, so I decided to build an Active Directory (AD) lab for this purpose.</p>
<p>In this blog post, I’ll guide you step-by-step on how to create your own malware testing environment.</p>
<p>We’ll containerize Elastic EDR using Docker, with a fully pre-configured setup that includes Elasticsearch, Kibana, Fleet, and the Detection Engine.</p>
<p>For the AD lab, we’ll use TCM Security’s Active Directory Lab as the foundation.</p>
<h2 id="initial-lab">Initial Lab</h2>
<p>This section focuses on creating 3 VMs: 1 Domain Controller and 2 User Machines.</p>
<p>This initial lab is based entirely on TCM’s Active Directory Lab from the <a href="https://academy.tcm-sec.com/p/practical-ethical-hacking-the-complete-course">Practical Ethical Hacking Course</a>. I highly recommend checking out their course.</p>
<p>However, you can use any lab environment you prefer, such as <a href="https://github.com/Orange-Cyberdefense/GOAD">GOAD</a>.</p>
<h3 id="pre-requisites">Pre-requisites</h3>
<p>Recommended Specs:</p>
<ul>
<li>60 GB Disk Space.</li>
<li>16 GB RAM.</li>
</ul>
<p>Download necessary ISOs:</p>
<ul>
<li><a href="https://www.microsoft.com/en-us/evalcenter/download-windows-server-2022">Windows Server 2022 ISO</a>.</li>
<li><a href="https://www.microsoft.com/en-us/evalcenter/download-windows-11-enterprise">Windows 11 Enterprise ISO</a>.</li>
</ul>
<p>Download a virtualization software:</p>
<ul>
<li>VirtualBox.</li>
<li>Hyper-V.</li>
<li>VMware Workstation Pro.
<ul>
<li>I will use this one.</li>
<li>You can download it <a href="https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.5.1/23298084/windows/core/">here</a>.</li>
<li>I recommend the version 17.5.1 since it has more features than 17.6.</li>
</ul>
</li>
</ul>
<h3 id="setting-up-the-domain-controller">Setting up the Domain Controller</h3>
<h4 id="creating-the-domain-controller-vm">Creating the Domain Controller VM</h4>
<ol>
<li>After opening VMware, click on “Create a new Virtual Machine”.</li>
<li>Next, Select the configuration <code>Typical</code> and click <code>Next</code>.</li>
<li>Select <code>Installer disc image file (iso)</code>, and select the <code>SERVER_EVAL_x64FRE_en-us</code> file you download.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/50c2ba5765a544629b79936dffd759c3.BC4reHl9_Z1qaGoN.png" alt="b0b2f451839ce45047eb9941b3c5331f.png" data-full-src="/_astro/50c2ba5765a544629b79936dffd759c3.BC4reHl9.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="235" height="51" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next</code>, and you should see this window:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/64127b294ecf4cebbc68b6c9463c498a.BfbnJlHR_Z1TrXKw.png" alt="9d32511d8affbacac239afb10d2c29cf.png" data-full-src="/_astro/64127b294ecf4cebbc68b6c9463c498a.BfbnJlHR.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="149" height="105" class="img-class"> 
</li>
</ul>
</li>
<li>We won’t be using Easy Install, so click <code>Next</code>.</li>
<li>You can use the default Disk options, and click <code>Next</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/163346d950884a5b9d364467a6ad5453.CS3FqQT4_Z2kghJd.png" alt="277f8c4ab91ac09cba55147377628f0a.png" data-full-src="/_astro/163346d950884a5b9d364467a6ad5453.CS3FqQT4.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="222" height="115" class="img-class"> 
</li>
</ul>
</li>
<li>Uncheck <code>&quot;Power on this virtual machine after creation&quot;</code>, and click <code>Finish</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/309ea4958fa4464284057d845abbb4c5.CmZcbHBt_ZcAFOi.png" alt="7f0327af3ed26aa45c032fa809f9e5ec.png" data-full-src="/_astro/309ea4958fa4464284057d845abbb4c5.CmZcbHBt.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="297" height="196" class="img-class"> 
</li>
</ul>
</li>
<li>Click on <code>&quot;Edit Virtual Machine Settings&quot;</code>.</li>
<li>Do the following:
<ul>
<li>Remove the Floppy disk:</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/79d658d3b49642d986f523cbeb54498b.BL8Sl3Lx_Z2bPIdj.png" alt="da83be80151024220679eced6fa4f34e.png" data-full-src="/_astro/79d658d3b49642d986f523cbeb54498b.BL8Sl3Lx.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="251" height="142" class="img-class"> 
</li>
<li>Change the memory to 4 GB Ram.</li>
<li>You can lower this down once you have finished the Setup.</li>
<li>Click <code>Okay</code> to exit from the Virtual Machine’s settings.</li>
</ul>
</li>
<li>Power the VM.</li>
<li>Press Enter 1-2 times and you should see this screen:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/206135dc92e84688b431cd5317a7194f.B32omgm__Z1io2eh.png" alt="fa43e228d4583ec47c78ed75af723d07.png" data-full-src="/_astro/206135dc92e84688b431cd5317a7194f.B32omgm_.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="274" height="202" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next &gt; Install</code>.</li>
<li>Select <code>&quot;Windows 2022 Standard Evaluation (Desktop Experience)&quot;</code>, and click <code>Next</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/f9e9daf16cb84e16bb9388ea1f6e3f2b.C58K0qMS_ZM4F5n.png" alt="9d22b97b7b28b6a57a556431162cfbc3.png" data-full-src="/_astro/f9e9daf16cb84e16bb9388ea1f6e3f2b.C58K0qMS.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="250" height="185" class="img-class"> 
</li>
</ul>
</li>
<li>Accept the License terms, and click <code>Next</code>.</li>
<li>As the type of installation, Select <code>Custom</code>:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/b6860f545f9d4fadba65e903b58deb98.COQgRSkZ_Z1rKQzb.png" alt="583defd9d553c703d9792fca22becb89.png" data-full-src="/_astro/b6860f545f9d4fadba65e903b58deb98.COQgRSkZ.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="316" height="156" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>New &gt; Apply &gt; Okay &gt; Next</code>, and the Windows Server should start installing:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/012daafbf6154dfabb06e62029979506.Bkt08rpK_Z28A9AV.png" alt="01e50fcc1c71017d7505b94db36ead4c.png" data-full-src="/_astro/012daafbf6154dfabb06e62029979506.Bkt08rpK.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="259" height="126" class="img-class"> 
</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/400de22961864190a518130012f46250.BSeXQRHK_ZC1Y6M.png" alt="3bf17d77b929b999633e95e649116c70.png" data-full-src="/_astro/400de22961864190a518130012f46250.BSeXQRHK.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="257" height="191" class="img-class"> 
</li>
</ul>
</li>
<li>While this installs, you can start installing the User Machines.</li>
<li>After the Server finishes installing, you should have the following screen:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/fcb42b95e80e4e71bab68b01cecfb22f.sc5UVcfT_x1iHG.png" alt="3da19e850014680df0d2b0768ec188c3.png" data-full-src="/_astro/fcb42b95e80e4e71bab68b01cecfb22f.sc5UVcfT.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="359" height="138" class="img-class"> 
</li>
<li>For the password, I will use <code>Pa$$w0rd!</code>.</li>
<li>Click <code>Next</code>, after you insert your password.</li>
</ul>
</li>
<li>Now, you should be able to login with the password you just set.
<ul>
<li>Press CRTL+ALT+DEL to show the login screen.</li>
<li>With VMWare you can use this option:</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/cb16f427de0743eeaa0dc7c642e0dbb6.CvJUGd7N_16J8Ph.png" alt="2b3dbbb91fdf15957ae5ea62d55d0acf.png" data-full-src="/_astro/cb16f427de0743eeaa0dc7c642e0dbb6.CvJUGd7N.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="179" height="152" class="img-class"> 
</li>
</ul>
</li>
<li>If the screen is small, it’s because you need to Install VMWare Tools.
<ul>
<li>On the VM, Select <code>VM &gt; Install VMware Tools</code>.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/25241c1709a34a449471fc120dba470f.CQJGZFT9_2wsePj.png" alt="9931765d2aedbfee02ed24ffcfc55dea.png" data-full-src="/_astro/25241c1709a34a449471fc120dba470f.CQJGZFT9.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="178" height="154" class="img-class"> 
</li>
<li>Alternatively, you can directly download the VMware Tools package <a href="https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.5.1/23298084/windows/packages/tools-windows.tar">here</a>, extract the <code>.tar</code> with 7zip, and left-click the <code>.iso</code>.</li>
<li>Open <code>setup64</code>, click <code>Next</code> and <code>Install</code>.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/ef17804184d9410ba35a4a8faac911b2.C7uqnBGW_1tSIyy.png" alt="a696b99aa75bfe4729ab98adacdb2b41.png" data-full-src="/_astro/ef17804184d9410ba35a4a8faac911b2.C7uqnBGW.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="280" height="183" class="img-class"> 
</li>
<li>This should install VMware tools.</li>
</ul>
</li>
<li>Rename your PC
<ol>
<li>Search for <code>&quot;About your PC&quot;</code> in the Windows Search bar.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/badc596b7ca5497b824eeb96af665987.CAdhG9qX_Z1LS2n.png" alt="cf10b7288e0221f435ea9e6ba8ee8360.png" data-full-src="/_astro/badc596b7ca5497b824eeb96af665987.CAdhG9qX.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="150" height="88" class="img-class"> 
</li>
</ul>
</li>
<li>Click on <code>Rename this PC</code>, choose a name, click <code>Next</code>, and click <code>Restart now</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/bd782166c7234646a8f964e13ddf5673.HqFur3FW_2qyorI.png" alt="c7108e11cdbd74fd616357d696fb8497.png" data-full-src="/_astro/bd782166c7234646a8f964e13ddf5673.HqFur3FW.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="544" height="187" class="img-class"> 
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h4 id="make-this-machine-the-domain-controller">Make this machine the Domain Controller</h4>
<ol>
<li>After logging in, In the Server Manager dashboard, Go to <code>Manage &gt; Add Roles and Features</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/f1aa1b80e5d8485a90d71b656ccdd0dd.B60Ny7nU_1XqP9d.png" alt="1dd0a8d9e2039a27be6230881917b513.png" data-full-src="/_astro/f1aa1b80e5d8485a90d71b656ccdd0dd.B60Ny7nU.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="511" height="78" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next</code> until the <code>Server Roles</code> section, check <code>&quot;Active Directory Domain Services&quot;</code> and click <code>Add Features</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/e17f6af2a8ce4fd0861365846da22bcd.5tYHQvhC_Z10UtVY.png" alt="38c9607ca02ce34a0999325c1ac4d1b1.png" data-full-src="/_astro/e17f6af2a8ce4fd0861365846da22bcd.5tYHQvhC.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="226" height="82" class="img-class"> 
</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/3a6932d8879046e5b62faf2c53f48281.CyY8eyQC_Z7xoNa.png" alt="ca52d10c577fe32d99c1a51b0a7dbda1.png" data-full-src="/_astro/3a6932d8879046e5b62faf2c53f48281.CyY8eyQC.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="170" height="164" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next</code> until the <code>Confirmation</code> section, check <code>&quot;Restart the destination server automatically if required&quot;</code>, select <code>Yes &gt; Install</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/c637619416024c10960b92fadc9a51d1.DjuZDRxb_1HONAu.png" alt="404b5e47cf58e8a5af77d1cbb40ea36d.png" data-full-src="/_astro/c637619416024c10960b92fadc9a51d1.DjuZDRxb.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="447" height="175" class="img-class"> 
</li>
</ul>
</li>
<li>When the installation finishes, Select <code>Promote this server to a domain controller</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/d325acfe030049428dcde3ba0c2545a3.DkEXOi71_WO0Jh.png" alt="6b4234f96843115ee1a32f8c4f53d026.png" data-full-src="/_astro/d325acfe030049428dcde3ba0c2545a3.DkEXOi71.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="304" height="111" class="img-class"> 
</li>
</ul>
</li>
<li>Select <code>Add a new forest</code>, choose a domain name, and click <code>Next</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/fc1d2a45b0b94926a5b6c9e543616644.CZ69ZOep_Z1Yl8qu.png" alt="6194c1501bc41ca4c35b2855984658c9.png" data-full-src="/_astro/fc1d2a45b0b94926a5b6c9e543616644.CZ69ZOep.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="342" height="133" class="img-class"> 
</li>
</ul>
</li>
<li>In the next window, select a DSRM Password and click <code>Next</code>.
<ul>
<li>I used <code>Pa$$w0rd!</code> again.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/cc14f9f77173441fbb817aa125da0208.B2yECqIN_Z2oLgV6.png" alt="f190c61d4bf98301a2d4b18f3b9b5923.png" data-full-src="/_astro/cc14f9f77173441fbb817aa125da0208.B2yECqIN.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="352" height="74" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next</code> until <code>Prerequisites check</code>, and Click <code>Install</code>.</li>
<li>After installation, click <code>Close</code> and restart the Domain Controller VM.</li>
<li>After rebooting, In the Server Manager dashboard, Go to <code>Manage &gt; Add Roles and Features</code>.</li>
<li>Click <code>Next</code> until the <code>Server Roles</code> section, check <code>&quot;Active Directory Certificate Services&quot;</code> and click <code>Add Features</code>.</li>
<li>Click <code>Next</code> until the <code>Role Services</code> section and check if <code>Certification Authority box</code> is check.</li>
<li>Click <code>Next</code> until <code>Confirmation</code> section, check <code>&quot;Restart the destination server automatically if required&quot;</code>, select <code>Yes &gt; Install</code>.</li>
<li>When the installation finishes, Select <code>Configure Active Directory Certificate Services on the destination server</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/cac938e4087e436588416aae7951cbb7.B6yGCsAK_1auwbP.png" alt="df21f0f637f8347660c4720337b2b429.png" data-full-src="/_astro/cac938e4087e436588416aae7951cbb7.B6yGCsAK.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="283" height="85" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next</code>. In the <code>Role Services</code> section check the <code>Certification Authority</code> box.</li>
<li>Click <code>Next</code> until <code>Validity Period</code> section, and set the Validity years to <code>99</code>.</li>
<li>Click <code>Next</code> until <code>Confirmation</code> section, click <code>Configure &gt; Close</code>, and reboot your server.</li>
</ol>
<p>Your Domain Server Initial Setup is finally finished! You can <a href="#setting-up-the-user-machines">setup the user machines</a>.</p>
<h3 id="setting-up-the-user-machines">Setting up the User Machines</h3>
<h4 id="creating-the-users-vms">Creating the Users VMs</h4>
<p>This is almost identical to <a href="#creating-the-domain-controller-vm">Creating the Domain Controller VM</a>, the only difference are:</p>
<ol>
<li>Use the Windows 11 Enterprise Evaluation ISO:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/ff4a1370f30847deb24878b2826c0f50.DtCbUW9i_Z1TndHz.png" alt="94e6f33f06e05afdf928b82a3e22c5a7.png" data-full-src="/_astro/ff4a1370f30847deb24878b2826c0f50.DtCbUW9i.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="372" height="39" class="img-class"> 
</li>
</ul>
</li>
<li>Use the Windows 11 Enterprise as the Version of installation.</li>
<li>I will name the First machine “THEPUNISHER”, and the Second machine “SPIDERMAN”.</li>
<li>VMware will ask you for the encryption type, select <code>Only the files needed to support a TPM are encrypted</code>.
<ul>
<li>I used <code>12345678</code> as the password.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/d72021360e894174928e8289b5284189.BpL_W-JV_qjqLm.png" alt="14ca204077e5fdc3e0271408c9889c6a.png" data-full-src="/_astro/d72021360e894174928e8289b5284189.BpL_W-JV.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="268" height="124" class="img-class"> 
</li>
</ul>
</li>
<li>After the installation finishes, select <code>Sign-in options &gt; Domain join instead</code>.
<ul>
<li>This will allows us to create an Local Account.</li>
</ul>
</li>
<li>For the user name, I will use <code>frankcastle</code> for <code>THEPUNISHER</code>, and <code>peterparker</code> for <code>SPIDERMAN</code>.</li>
<li>For the password, I will use <code>Password1</code> for <code>THEPUNISHER</code>, <code>Password2</code> for <code>SPIDERMAN</code>.</li>
<li>For the security questions, I will use <code>bob</code> for everything.</li>
<li>Rename the PCs to their VM Name respectively, <code>THEPUNISHER</code> and <code>SPIDERMAN</code>, and restart them.</li>
</ol>
<h3 id="setting-up-users-groups-and-policies-on-the-domain-controller">Setting up Users, Groups, and Policies on the Domain Controller</h3>
<ol>
<li>Start the DC (Domain Controller) VM, and search for <code>Active Directory Users and Computers</code>, and open it.</li>
<li>Right-click on <code>MARVEL.local</code> and select <code>New &gt; Organizational Unit</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/54b2df1c23fa4ae58f73f1463c53777e.CWhkh6Z6_1vfKe6.png" alt="c86a34f1a205359a684467ca40168f92.png" data-full-src="/_astro/54b2df1c23fa4ae58f73f1463c53777e.CWhkh6Z6.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="263" height="159" class="img-class"> 
</li>
</ul>
</li>
<li>Name it <code>&quot;Groups&quot;</code> and click <code>Okay</code>.</li>
<li>Left-click on the <code>Users</code>, click on <code>Type</code> to organize users by type, select all Users that belong to the type <code>&quot;Security Group&quot;</code> and drag them to the OU (Organizational Unit) named Groups, that you just created.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/5d51cbd07ae740c68f692183a8c431f7.BHrY8vRk_Zp8jMR.png" alt="4e5b2860d5d93c9282a8ff706fb0459d.png" data-full-src="/_astro/5d51cbd07ae740c68f692183a8c431f7.BHrY8vRk.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="315" height="225" class="img-class"> 
</li>
</ul>
</li>
<li>Right-click on the Administrator user and select <code>Copy...</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/7b6f63cef6c647798126f6fd8f480d12.B9MEh9Zz_Z1DbPd7.png" alt="667f6f6be9f7cfebe799c09cb64feb20.png" data-full-src="/_astro/7b6f63cef6c647798126f6fd8f480d12.B9MEh9Zz.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="185" height="56" class="img-class"> 
</li>
</ul>
</li>
<li>Create the Tony Stark user:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/00d85bace0a749278d61cac373cdcc17.BGhMNnhl_Z2ncA90.png" alt="78918d2d4e3b7aa755a39bf3d0066aba.png" data-full-src="/_astro/00d85bace0a749278d61cac373cdcc17.BGhMNnhl.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="235" height="205" class="img-class"> 
</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/840596f5da234a9e8af979ab09885474.CqIUpREx_Y57We.png" alt="f1dd770344a86dbc7f716b6fc747edae.png" data-full-src="/_astro/840596f5da234a9e8af979ab09885474.CqIUpREx.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="219" height="135" class="img-class"> 
</li>
<li>Password: <code>Password12345!</code></li>
<li>Check <code>Password never expires</code>.</li>
</ul>
</li>
<li>Create another user the same way you created Tony stark:
<ul>
<li>Full Name: SQL Service</li>
<li>User Logon: SQLService</li>
<li>Password: <code>MYpassword123#</code></li>
<li>Check <code>Password never expires</code>.</li>
<li>After creating the user, right-click on him, select <code>Properties</code>, set its description to <code>&quot;My password is MYpassword123#&quot;</code>, and select <code>Apply &gt; Okay</code>.</li>
</ul>
</li>
<li>Right-click on the Users, select <code>New &gt; User</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/89a866ea865242199ee7517f7d9f915b.BEl1G_SD_rJre2.png" alt="469bbf648398431140308aeb33a0c027.png" data-full-src="/_astro/89a866ea865242199ee7517f7d9f915b.BEl1G_SD.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="238" height="155" class="img-class"> 
</li>
</ul>
</li>
<li>Create 2 users with this method:
<ul>
<li>First User:
<ul>
<li>Full Name: Frank Castle</li>
<li>User Logon: fcastle</li>
<li>Password: <code>Password1</code></li>
<li>Check <code>Password never expires</code>.</li>
</ul>
</li>
<li>Second User:
<ul>
<li>Full Name: Peter parker</li>
<li>User Logon: pparker</li>
<li>Password: <code>Password2</code></li>
<li>Check <code>Password never expires</code>.</li>
</ul>
</li>
</ul>
</li>
<li>In the DC’s Server manager, Go to <code>File and Storage Services &gt; Shares &gt; TASKS &gt; New Share</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/a7688cd66f034e2e981e499ebb69c1d5.BYK_nnS6_Z2tirHP.png" alt="fe895e8a21c7b1bcf2dc4ca80b03a720.png" data-full-src="/_astro/a7688cd66f034e2e981e499ebb69c1d5.BYK_nnS6.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="162" height="136" class="img-class"> 
</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/cce781fb771e484aada1511a0689ea52.BxCYvxkj_1yrTut.png" alt="6edbc0073ede98040fc2c936917420ab.png" data-full-src="/_astro/cce781fb771e484aada1511a0689ea52.BxCYvxkj.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="286" height="89" class="img-class"> 
</li>
</ul>
</li>
<li>In the New Share Wizard:
<ol>
<li>Select <code>SMB Share Quick</code>.</li>
<li>Click <code>Next</code> 2 times.</li>
<li>Set share name to <code>hackme</code>.</li>
<li>Click <code>Next</code> until <code>Confirmation</code>, and click <code>Create &gt; Close</code>.</li>
</ol>
</li>
<li>Open the <code>cmd.exe</code> on the DC, and run the following  commands:</li>
</ol>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>setspn -a HYDRA-DC/SQLService.MARVEL.local:60111 MARVEL\SQLService</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div> <script type="module">function r(e){e.classList.toggle("copied"),setTimeout(()=>{e.classList.toggle("copied")},2e3)}function i(e){const t=e.closest(".code-block-wrapper")?.querySelector("pre");if(!t)return;const c=t.querySelector("code")?.innerText||"";navigator.clipboard.writeText(c).then(()=>{r(e)}).catch(n=>{console.error("Failed to copy text: ",n)})}function s(){document.querySelectorAll(".copy-button").forEach(o=>{o instanceof HTMLButtonElement&&o.addEventListener("click",()=>i(o))})}document.addEventListener("DOMContentLoaded",s);</script> 
<ol start="13">
<li>Check if the SQLService SPN is found:</li>
</ol>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>setspn -l SQLService</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<ol start="14">
<li>
<p>Right-click the <code>Ethernet/WIFI</code> symbol and click on <code>Open Network &amp; Internet Settings</code>.</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/a111b4790986495ea1c19eaf2e47d5ac.CsrOOiYU_Z2bPURD.png" alt="af55aa0e26c0ac68f9fe7ef45db5fd76.png" data-full-src="/_astro/a111b4790986495ea1c19eaf2e47d5ac.CsrOOiYU.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="210" height="88" class="img-class"> 
</li>
</ul>
</li>
<li>
<p>On <code>Advanced Network</code> settings, select <code>Network and Sharing Center</code>.</p>
</li>
<li>
<p>On <code>active networks</code>, click on the <code>MARVEL.local</code> Connection.</p>
<ul>
<li>In my case, it’s <code>Ethernet0</code>.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/63e813045fdd49108235c5bf472eebe6.DAlNJGjE_2w3OsX.png" alt="814bd1d4417d087c041e5ab1b49e2df2.png" data-full-src="/_astro/63e813045fdd49108235c5bf472eebe6.DAlNJGjE.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="263" height="58" class="img-class"> 
</li>
</ul>
</li>
<li>
<p>Next, Go to <code>Properties &gt; Internet Protocol Version 4 (TCP/IPv4)</code>.</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/5c6769539ed847158aff59e97b762653.BzmBHjK2_1tkn9o.png" alt="80ac61c7d3fcd5259888c9cb4a33739e.png" data-full-src="/_astro/5c6769539ed847158aff59e97b762653.BzmBHjK2.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="301" height="214" class="img-class"> 
</li>
<li>
<p>Open <code>cmd.exe</code>, run <code>ipconfig</code>, and copy the values from the command and use them in the IPv4 Properties, like so:</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/34e11dfde69f4ee68e7e3d22dfb75196.B9VtONo9_Z1zh7FJ.png" alt="b55a2248fec423a5b038ff6ae4662b9d.png" data-full-src="/_astro/34e11dfde69f4ee68e7e3d22dfb75196.B9VtONo9.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="433" height="141" class="img-class"> 
</li>
</ul>
</li>
<li>
<p>On the IPv4 Properties, click <code>Okay &gt; Okay &gt; Close</code>.</p>
</li>
</ul>
</li>
<li>
<p>Open any folder, go to the <code>Network</code> section, click the blue rectangle with <code>Click to Change...</code>, and choose <code>Turn on Network Discovery and File Sharing</code>:</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/c4f6bcc76af94d8dad7d343d09bc7ec5.CA1-U73O_1GggVO.png" alt="baf310060dc521f0be2c1b944f3c6e94.png" data-full-src="/_astro/c4f6bcc76af94d8dad7d343d09bc7ec5.CA1-U73O.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="238" height="189" class="img-class"> 
</li>
</ul>
</li>
</ol>
<p>Now, you just need to make the <a href="#join-user-machines-to-domain">user machines join the Domain</a>.</p>
<h3 id="join-user-machines-to-domain">Join User Machines to Domain</h3>
<p>The final step is to make the user machines join the <code>MARVEL.local</code> Domain.</p>
<p>Repeat the following steps for both User Machines:</p>
<ol>
<li>On the Windows search bar, Search for <code>Control Panel</code> and open it.</li>
<li>Go to <code>Network and Internet &gt; Network and Sharing Center</code>.</li>
<li>On <code>active networks</code>, click on the <code>MARVEL.local</code> Connection.
<ul>
<li>In my case, it’s <code>Ethernet0</code>.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/63e813045fdd49108235c5bf472eebe6.DAlNJGjE_2w3OsX.png" alt="814bd1d4417d087c041e5ab1b49e2df2.png" data-full-src="/_astro/63e813045fdd49108235c5bf472eebe6.DAlNJGjE.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="263" height="58" class="img-class"> 
</li>
</ul>
</li>
<li>Next, Go to <code>Properties &gt; Internet Protocol Version 4 (TCP/IPv4)</code>.</li>
<li>For the DNS server address, we will use the IPv4 from the DC :
<ul>
<li>You can get this by running <code>ipconfig</code> on <code>cmd.exe</code> on the DC.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/3890e38c608044118243003e4f9acb61.Dn6R2h16_ZcPCGd.png" alt="cae57c04807316fa931c2d28813f62c7.png" data-full-src="/_astro/3890e38c608044118243003e4f9acb61.Dn6R2h16.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="181" height="205" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Ok &gt; Ok &gt; Close</code>.</li>
<li>In the Windows Search Bar, Search for <code>Access Work or School</code> and open it.</li>
<li>On this new window, Click on <code>Connect</code>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/9ff51833968c4514939212870a8e173d.CHpTZiPN_dpmEl.png" alt="fc652d571b1f124427b3605954257198.png" data-full-src="/_astro/9ff51833968c4514939212870a8e173d.CHpTZiPN.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="287" height="51" class="img-class"> 
</li>
</ul>
</li>
<li>Select <code>Join this device to a local Active Directory Domain</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/108c39ef358747dc8efd6326eb56059b.B74UuQ_h_1Q4Iw0.png" alt="68cc9925b765a938473772a089e705a0.png" data-full-src="/_astro/108c39ef358747dc8efd6326eb56059b.B74UuQ_h.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="187" height="225" class="img-class"> 
</li>
</ul>
</li>
<li>Enter the name of your domain in the new window, click <code>Next</code>, and log in with the Administrator account:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/1a5168cb07fb48b2a96f3cbca5752719.BrFQWmWe_ZbQAl5.png" alt="cee3af2ea2b0b3b498366bfb5c02012f.png" data-full-src="/_astro/1a5168cb07fb48b2a96f3cbca5752719.BrFQWmWe.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="165" height="90" class="img-class"> 
</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/5ac968f53ad6427b8c05e35846a6c540.BGYq-pgh_js9Q9.png" alt="1cc899feb53a79e4ca4288ee39140bc8.png" data-full-src="/_astro/5ac968f53ad6427b8c05e35846a6c540.BGYq-pgh.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="126" height="75" class="img-class"> 
</li>
</ul>
</li>
<li>As the <code>Account type</code>, select <code>Administrator</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/f3e36d5f9a1e4e2cbc557fd631a820b9.BttltshA_qkR4u.png" alt="baba590e2f1c7c6a3ea8b236d03e6a8a.png" data-full-src="/_astro/f3e36d5f9a1e4e2cbc557fd631a820b9.BttltshA.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="192" height="163" class="img-class"> 
</li>
</ul>
</li>
<li>Click <code>Next &gt; Restart Now</code>.</li>
<li>In the Windows search bar, Search for <code>Edit local users and groups</code> and open it:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/a26e2a4efcd84404b03ecd073417c134.CsdN-Jfg_ZEKXLr.png" alt="20edc9d47ec5ae866c7b3fffcfbb1596.png" data-full-src="/_astro/a26e2a4efcd84404b03ecd073417c134.CsdN-Jfg.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="204" height="131" class="img-class"> 
</li>
</ul>
</li>
<li>In this new window, Left-click <code>Users</code>, Right-Click <code>Administrator</code> and Select <code>Set Password &gt; Proceed</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/bbc9957a92ec49448da46d1493c950e4.rwyJYq3j_Z1MKviU.png" alt="5450c5614ee936bcba31741a8f0dc884.png" data-full-src="/_astro/bbc9957a92ec49448da46d1493c950e4.rwyJYq3j.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="341" height="71" class="img-class"> 
</li>
</ul>
</li>
<li>Set the Administrator password to <code>Password1!</code>.</li>
<li>Only on the <code>SPIDERMAN</code> machine, Go to <code>Groups</code>, double left-click <code>Administrators</code> group, and click <code>Add</code>.
<ul>
<li>Enter <code>fcastle</code> and click <code>Ok &gt; Apply &gt; Ok</code>.</li>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/bbc9957a92ec49448da46d1493c950e4.rwyJYq3j_Z1MKviU.png" alt="5450c5614ee936bcba31741a8f0dc884.png" data-full-src="/_astro/bbc9957a92ec49448da46d1493c950e4.rwyJYq3j.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="341" height="71" class="img-class"> 
</li>
<li>This allows you to login into the <code>SPIDERMAN</code> machine using the <code>fcastle</code> user, enabling lateral movement for practice</li>
</ul>
</li>
<li>Open any folder, go to the <code>Network</code> section, click the blue rectangle with <code>Click to Change...</code>, and choose <code>Turn on Network Discovery and File Sharing</code>:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/c4f6bcc76af94d8dad7d343d09bc7ec5.CA1-U73O_1GggVO.png" alt="baf310060dc521f0be2c1b944f3c6e94.png" data-full-src="/_astro/c4f6bcc76af94d8dad7d343d09bc7ec5.CA1-U73O.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="238" height="189" class="img-class"> 
</li>
</ul>
</li>
<li>Only on the <code>SPIDERMAN</code> machine, Open any folder, go to the <code>This PC</code> section, click on the 3 dots, and select <code>Map network drive</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/aa55813d9992487ea166e1f662bd75e6.jqqrX_Tm_1SlFNq.png" alt="711ea438e3597f2683ebbab4e3dc9653.png" data-full-src="/_astro/aa55813d9992487ea166e1f662bd75e6.jqqrX_Tm.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="258" height="189" class="img-class"> 
</li>
</ul>
</li>
<li>In this new window, write <code>\\HYDRA-DC\hackme</code> in the folder name, check <code>Connect using different credentials</code>, and click <code>finish</code>.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/8d1a6417a55f43de9e0b57689b75bd7d.C5_5zQBo_ZJk8M1.png" alt="60d5159b2a1c399e4ac24908a5295f5e.png" data-full-src="/_astro/8d1a6417a55f43de9e0b57689b75bd7d.C5_5zQBo.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="312" height="154" class="img-class"> 
</li>
</ul>
</li>
<li>Login using the DC’s Administrator account, and <code>check Remember my credentials</code>:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/4e0b65f8df784145b7ed1262414b1773.CHzcqpNW_Z1oW9hk.png" alt="38e8a6c9e5aef066e93f7cda4e39d0c6.png" data-full-src="/_astro/4e0b65f8df784145b7ed1262414b1773.CHzcqpNW.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="166" height="153" class="img-class"> 
</li>
</ul>
</li>
<li>Now, you should have access to the <code>hackme</code> share as Administrator:
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/5f39354b5b33437f8fd88dbf19bc38d8.CzFAV1pn_Z1L1XD8.png" alt="f8f4971e3b7d30fd419a8aa282a86ddb.png" data-full-src="/_astro/5f39354b5b33437f8fd88dbf19bc38d8.CzFAV1pn.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="228" height="124" class="img-class"> 
</li>
</ul>
</li>
</ol>
<p>Great job! You’ve successfully built the foundation of our lab.</p>
<p>Now, all that’s left is to <a href="#adding-elastic-edr">add Elastic EDR</a>, and your lab setup will be complete!</p>
<h2 id="adding-elastic-edr">Adding Elastic EDR</h2>
<p>This section will teach you how to add Elastic EDR to any machine using <a href="https://github.com/peasead/elastic-container">peasead’s elastic-container</a>.</p>
<p>You will need Docker to run Elastic EDR. You can run Docker either in a virtual machine (VM) or directly on your host OS. I’ll be using a Ubuntu VM in this guide.</p>
<ol>
<li><a href="#installing-docker">Installing Docker</a></li>
<li><a href="#creating-elastic-container">Creating Elastic Container</a></li>
<li><a href="#all-elastic-edr-container-options">All Elastic EDR container options</a></li>
</ol>
<h3 id="installing-docker">Installing Docker</h3>
<p>1.  Set up Docker’s <code>apt</code> repository.</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="python" data-astro-cid-jgrc2lfe><code><span class="line"><span style="color:#6A737D"># Add Docker&#39;s official GPG key:</span></span>
<span class="line"><span style="color:#E1E4E8">sudo apt</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">get update</span></span>
<span class="line"><span style="color:#E1E4E8">sudo apt</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">get install ca</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">certificates curl</span></span>
<span class="line"><span style="color:#E1E4E8">sudo install </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">m </span><span style="color:#79B8FF">0</span><span style="color:#FDAEB7;font-style:italic">755</span><span style="color:#F97583"> -</span><span style="color:#E1E4E8">d </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">etc</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">apt</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">keyrings</span></span>
<span class="line"><span style="color:#E1E4E8">sudo curl </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">fsSL https:</span><span style="color:#F97583">//</span><span style="color:#E1E4E8">download.docker.com</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">linux</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">ubuntu</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">gpg </span><span style="color:#F97583">-</span><span style="color:#E1E4E8">o </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">etc</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">apt</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">keyrings</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">docker.asc</span></span>
<span class="line"><span style="color:#E1E4E8">sudo chmod a</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">r </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">etc</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">apt</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">keyrings</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">docker.asc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Ubuntu</span></span>
<span class="line"><span style="color:#6A737D"># Add the repository to Apt sources:</span></span>
<span class="line"><span style="color:#E1E4E8">echo </span><span style="color:#9ECBFF">&quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu $(. /etc/os-release &amp;&amp; echo &quot;</span><span style="color:#FDAEB7;font-style:italic">$</span><span style="color:#79B8FF">VERSION_CODENAME</span><span style="color:#9ECBFF">&quot;) stable&quot;</span><span style="color:#F97583"> |</span><span style="color:#E1E4E8"> sudo tee </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">etc</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">apt</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">sources.list.d</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">docker.list </span><span style="color:#F97583">&gt;</span><span style="color:#F97583"> /</span><span style="color:#E1E4E8">dev</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">null</span></span>
<span class="line"><span style="color:#E1E4E8">sudo apt</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">get update</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Kali Linux</span></span>
<span class="line"><span style="color:#6A737D"># Add the repository to Apt sources:</span></span>
<span class="line"><span style="color:#E1E4E8">echo </span><span style="color:#9ECBFF">&quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian bookworm stable&quot;</span><span style="color:#F97583"> |</span><span style="color:#E1E4E8"> sudo tee </span><span style="color:#F97583">/</span><span style="color:#E1E4E8">etc</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">apt</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">sources.list.d</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">docker.list </span><span style="color:#F97583">&gt;</span><span style="color:#F97583"> /</span><span style="color:#E1E4E8">dev</span><span style="color:#F97583">/</span><span style="color:#E1E4E8">null</span></span>
<span class="line"><span style="color:#E1E4E8">sudo apt</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">get update</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>2.  Install Docker’s packages.</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>3.  Verify that the installation is successful by running the <code>hello-world</code> image:</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>sudo docker run hello-world</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>4.  Optional, Grant the <code>docker</code> right to the default user.</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>sudo groupadd docker</span></span>
<span class="line"><span>sudo usermod -aG docker $USER</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<h3 id="creating-elastic-container">Creating Elastic Container</h3>
<p>1.  Install elastic container pre-requisites:</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash" data-astro-cid-jgrc2lfe><code><span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> apt-get</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> jq</span><span style="color:#9ECBFF"> git</span><span style="color:#9ECBFF"> curl</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>2.  Clone the Git repository and navigate to the Elastic container directory:</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash" data-astro-cid-jgrc2lfe><code><span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> clone</span><span style="color:#9ECBFF"> https://github.com/peasead/elastic-container.git</span></span>
<span class="line"><span style="color:#79B8FF">cd</span><span style="color:#9ECBFF"> elastic-container</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>3.  Edit the file <code>.env</code> and change the following settings:</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>ELASTIC_PASSWORD=&quot;changeme&quot;</span></span>
<span class="line"><span>KIBANA_PASSWORD=&quot;changeme&quot;</span></span>
<span class="line"><span>WindowsDR=1</span></span>
<span class="line"><span>LICENSE=trial # enable 30-day free trial with the platinum features (EDR)</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>4.  Run <code>elastic-container.sh</code>.</p>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span>chmod +x ./elastic-container.sh</span></span>
<span class="line"><span>sudo ./elastic-container.sh start</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<p>5.  Click on the 3 horizontal lines, scroll down, and click on <code>Fleet</code>.</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/5ead1c8e225c45fc8268866317530a0a.CWvYelyM_Z1UHrpf.png" alt="f4eb1b92bd1aed2dda843a48c5ade678.png" data-full-src="/_astro/5ead1c8e225c45fc8268866317530a0a.CWvYelyM.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="127" height="166" class="img-class"> 
</li>
</ul>
<p>6.  Select <code>Add agent</code>.</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/ea0fbe25a58a452ca9601bddcbcf3a5b.WG-agAYI_Z8Kg2f.png" alt="136c8c136331b5d6cd49e34d63c50367.png" data-full-src="/_astro/ea0fbe25a58a452ca9601bddcbcf3a5b.WG-agAYI.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="452" height="79" class="img-class"> 
</li>
</ul>
<p>7.  Scroll down to <code>Install Elastic Agent on your Host</code>, select <code>Windows</code> and copy the PowerShell script.</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/b0bd05b2753e44d784cfc80b8df20068.brq_xpAc_AdsaE.png" alt="1955eef6fe48a9d45be6908967e34003.png" data-full-src="/_astro/b0bd05b2753e44d784cfc80b8df20068.brq_xpAc.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="251" height="149" class="img-class"> 
</li>
</ul>
<p>8.  Now, go to each machine from the AD Lab, and follow these steps:</p>
<ul>
<li>Copy the URL from the PowerShell script and paste it into your browser to download the .zip file faster.
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/8d7b349a13ed4344a85d408d274b4618.DJdYeG5J_wlSq0.png" alt="2da87a8f0f7690946b8e9635af831a69.png" data-full-src="/_astro/8d7b349a13ed4344a85d408d274b4618.DJdYeG5J.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="528" height="46" class="img-class"> 
</li>
</ul>
</li>
<li>Once downloaded, extract the contents of the <code>.zip</code> file.</li>
<li>Run <code>elastic-agent.exe</code> using the arguments provided in the PowerShell script.</li>
<li>If you encounter a certificate trust error, add the <code>--insecure</code> flag to solve it.</li>
</ul>
<p>9.  Now, you should see your machines in the Fleet section of Elastic EDR:</p>
<ul>
<li>
<!-- If scale exists, then apply the img-class class --><img src="/_astro/dc4f9ecab32f469e9687236350d945de.o5JqVzve_Z1AFX3Y.png" alt="9d5747d4e5cc9a5c720fa2d413034eed.png" data-full-src="/_astro/dc4f9ecab32f469e9687236350d945de.o5JqVzve.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="474" height="127" class="img-class"> 
</li>
</ul>
<h3 id="all-elastic-edr-container-options">All Elastic EDR container options</h3>
<div class="code-block-wrapper" data-astro-cid-jgrc2lfe> <pre class="astro-code github-dark astro-jgrc2lfe" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext" data-astro-cid-jgrc2lfe><code><span class="line"><span># Start</span></span>
<span class="line"><span>./elastic-container.sh start</span></span>
<span class="line"><span># Destroy Containers</span></span>
<span class="line"><span>./elastic-container.sh destroy</span></span>
<span class="line"><span># Stop</span></span>
<span class="line"><span>./elastic-container.sh stop</span></span>
<span class="line"><span># Restart</span></span>
<span class="line"><span>./elastic-container.sh restart</span></span>
<span class="line"><span># Status</span></span>
<span class="line"><span>./elastic-container.sh status</span></span>
<span class="line"><span># Clear all logs</span></span>
<span class="line"><span>./elastic-container.sh clear</span></span></code></pre> <div class="copy-area" data-astro-cid-jgrc2lfe> <button class="copy-button" title="Copy code" data-astro-cid-jgrc2lfe> <svg class="copy-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <svg class="success-icon w-6 h-6" data-astro-cid-jgrc2lfe="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"> <polyline points="20 6 9 17 4 12"></polyline> </svg> </button> </div> </div>  
<h2 id="conclusion">Conclusion</h2>
<p>Congratulations! You now have your own fully functional malware lab with Elastic EDR.</p>
<p>I hope this guide was helpful and easy to follow. If you have any questions, feel free to reach out to me directly.</p>
<p>Happy hacking!</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://swisskyrepo.github.io/InternalAllTheThings/redteam/evasion/elastic-edr/">swisskyrepo’s Elastic EDR Post</a></li>
<li><a href="https://academy.tcm-sec.com/p/practical-ethical-hacking-the-complete-course">TCM Security’s Ethical Hacking Course</a></li>
<li><a href="https://github.com/peasead/elastic-container">peasead’s elastic-container</a></li>
</ul>  </div> </article>  <aside class="hidden lg:block lg:col-span-4" data-astro-cid-scuu7fyy> <div class="sticky top-18 flex flex-col max-w-[36ch] h-[calc(95vh-4.5rem)]" data-astro-cid-scuu7fyy> <div class="border-l-1 border-slate-600 pl-3 toc-content-area" data-astro-cid-scuu7fyy> <h2 class="font-semibold text-lg text-gray-200 mb-1" data-astro-cid-scuu7fyy>Table of Contents</h2>
            <div class="max-h-[70vh] overflow-y-auto scroll-fade-container" data-astro-cid-scuu7fyy> <ul class="pl-3 pr-2 " data-astro-cid-xvrfupwn> <li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#introduction" class="toc-link" data-astro-cid-xvrfupwn> Introduction </a> </div>  </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#initial-lab" class="toc-link" data-astro-cid-xvrfupwn> Initial Lab </a> </div> <div class="h3-list-wrapper" data-astro-cid-xvrfupwn> <ul class="toc-h3-list pl-6 pr-2" data-astro-cid-xvrfupwn>  <li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#pre-requisites" class="toc-link" data-astro-cid-xvrfupwn> Pre-requisites </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-the-domain-controller" class="toc-link" data-astro-cid-xvrfupwn> Setting up the Domain Controller </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-the-user-machines" class="toc-link" data-astro-cid-xvrfupwn> Setting up the User Machines </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-users-groups-and-policies-on-the-domain-controller" class="toc-link" data-astro-cid-xvrfupwn> Setting up Users, Groups, and Policies on the Domain Controller </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#join-user-machines-to-domain" class="toc-link" data-astro-cid-xvrfupwn> Join User Machines to Domain </a> </li> </ul> </div> </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#adding-elastic-edr" class="toc-link" data-astro-cid-xvrfupwn> Adding Elastic EDR </a> </div> <div class="h3-list-wrapper" data-astro-cid-xvrfupwn> <ul class="toc-h3-list pl-6 pr-2" data-astro-cid-xvrfupwn>  <li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#installing-docker" class="toc-link" data-astro-cid-xvrfupwn> Installing Docker </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#creating-elastic-container" class="toc-link" data-astro-cid-xvrfupwn> Creating Elastic Container </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#all-elastic-edr-container-options" class="toc-link" data-astro-cid-xvrfupwn> All Elastic EDR container options </a> </li> </ul> </div> </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#conclusion" class="toc-link" data-astro-cid-xvrfupwn> Conclusion </a> </div>  </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#references" class="toc-link" data-astro-cid-xvrfupwn> References </a> </div>  </li> </ul> <script type="module">const n=new Map;let o=!1;function a(){document.querySelectorAll("a.toc-link").forEach(i=>i.setAttribute("data-active","false")),document.querySelectorAll("h2[data-active], h3[data-active]").forEach(i=>i.removeAttribute("data-active"))}function d(){const t=document.querySelector("a.toc-link"),e=document.querySelector(".content-style h2, .content-style h3");!t||!e||(t.setAttribute("data-active","true"),t.scrollIntoView({behavior:"smooth",block:"nearest"}),e.setAttribute("data-active","true"))}function u(){let t=!1;const e=()=>{window.scrollY<200&&!t?(a(),d(),t=!0):window.scrollY>=200&&(t=!1)};window.addEventListener("scroll",e)}function s(){const t=document.querySelector('h2[data-active="true"], h3[data-active="true"]');if(t){const e=t.id;document.querySelector(`a.toc-link[href="#${e}"]`)?.setAttribute("data-active","true")}}function h(t){for(const i of t){if(!i.isIntersecting){n.delete(i.target);continue}n.set(i.target,i)}if(n.size===0)return;let e=null;for(const i of Array.from(n.values()))e||(e=i),i.boundingClientRect.top<e.boundingClientRect.top&&(e=i);e?.target.getAttribute("data-active")!=="true"&&(a(),e&&e.target.setAttribute("data-active","true"),o&&s())}function c(t){o=t.matches,o&&s()}function f(){const t=window.matchMedia("(min-width: 1024px)");t.addEventListener("change",c),c(t);const e=document.querySelectorAll(".content-style h2, .content-style h3");if(e.length===0)return;const i={root:null,rootMargin:"0px 0px -60% 0px",threshold:0},r=new IntersectionObserver(h,i);e.forEach(l=>r.observe(l)),u()}document.addEventListener("DOMContentLoaded",()=>{f()});</script>  </div> </div> </div> </aside> <!-- Post-article sections --> <div id="post-article-div" class="lg:col-span-7" data-astro-cid-scuu7fyy> <hr class="mt-10 border-gray-700" data-astro-cid-scuu7fyy> <div id="post-content-section" class="mt-4 mb-5 lg:flex lg:justify-between lg:items-start lg:gap-x-8 lg:gap-y-4" data-astro-cid-scuu7fyy> <!-- Tags Section --> <div id="tag-section" class="mb-4 lg:mb-0" data-astro-cid-scuu7fyy> <div class="text-left mb-2 lg:mb-4 flex items-center gap-1" data-astro-cid-scuu7fyy> <svg class="w-6 h-auto" data-astro-cid-scuu7fyy="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <defs> <mask id="tagMask1"> <rect width="24" height="24" fill="white"></rect> <circle cx="7" cy="7" r="1.5" fill="black"></circle> </mask> <mask id="tagMask2"> <rect width="24" height="24" fill="white"></rect> <circle cx="5" cy="9" r="1.5" fill="black"></circle> </mask> </defs> <!-- Back tag --> <g transform="translate(2, -2)" opacity="0.6"> <path d="M22.09 15.91L14.92 23.08C14.55 23.45 14.05 23.66 13.52 23.66C12.99 23.66 12.49 23.45 12.12 23.08L3.89 14.85C3.52 14.48 3.31 13.98 3.31 13.45V6.68C3.31 5.62 4.16 4.77 5.22 4.77H11.99C12.52 4.77 13.02 4.98 13.39 5.35L21.62 13.58C21.99 13.95 22.2 14.45 22.2 14.98C22.2 15.51 21.99 16.01 21.62 16.38L22.09 15.91Z" fill="currentColor" opacity="0.6" mask="url(#tagMask2)"></path> </g> <!-- Front tag --> <path d="M20.59 13.41L13.42 20.58C13.05 20.95 12.55 21.16 12.02 21.16C11.49 21.16 10.99 20.95 10.62 20.58L2.39 12.35C2.02 11.98 1.81 11.48 1.81 10.95V4.18C1.81 3.12 2.66 2.27 3.72 2.27H10.49C11.02 2.27 11.52 2.48 11.89 2.85L20.12 11.08C20.49 11.45 20.7 11.95 20.7 12.48C20.7 13.01 20.49 13.51 20.12 13.88L20.59 13.41Z" fill="currentColor" mask="url(#tagMask1)"></path> </svg> <h2 class="text-2xl font-semibold text-white" data-astro-cid-scuu7fyy>Tags</h2> </div> <div id="tags-wrapper" class="flex flex-wrap items-center gap-1" aria-expanded="false" data-astro-cid-scuu7fyy> <!-- Always visible tags (first 7) --> <a href="/work?tags=Malware%20Lab" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> Malware Lab </a><a href="/work?tags=EDR%20Setup" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> EDR Setup </a><a href="/work?tags=Elastic%20EDR" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> Elastic EDR </a><a href="/work?tags=Cybersecurity" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> Cybersecurity </a><a href="/work?tags=Red%20Team" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> Red Team </a> <!-- Conditionally rendered "Show More" button --> <div id="more-tags" class="hidden flex-wrap items-center gap-1" data-astro-cid-scuu7fyy> <a href="/work?tags=Penetration%20testing" class="text-xs px-1.7 py-1 rounded-md
bg-secondary-accent hover:bg-gray-600 transition-colors" data-astro-cid-scuu7fyy> Penetration testing </a> </div> <button id="show-all-btn" class="text-sm font-semibold hover:text-sky-400 transition-colors rounded cursor-pointer" data-astro-cid-scuu7fyy>
Show All
</button> <button id="show-less-btn" class="text-sm font-semibold hover:text-sky-400 transition-colors rounded cursor-pointer" data-astro-cid-scuu7fyy>
Show Less
</button>  </div> </div> <!-- Share Section --> <div id="share-section" data-astro-cid-scuu7fyy> <div class="text-left mb-2 flex items-center gap-1" data-astro-cid-scuu7fyy> <svg class="w-7 h-auto" data-astro-cid-scuu7fyy="true" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g fill="currentColor"> <path d="M6.746704,4 L10.2109085,4 C10.625122,4 10.9609085,4.33578644 10.9609085,4.75 C10.9609085,5.12969577 10.6787546,5.44349096 10.312679,5.49315338 L10.2109085,5.5 L6.746704,5.5 C5.55584001,5.5 4.58105908,6.42516159 4.50189481,7.59595119 L4.496704,7.75 L4.496704,17.25 C4.496704,18.440864 5.42186559,19.4156449 6.59265519,19.4948092 L6.746704,19.5 L16.247437,19.5 C17.438301,19.5 18.4130819,18.5748384 18.4922462,17.4040488 L18.497437,17.25 L18.497437,16.752219 C18.497437,16.3380054 18.8332234,16.002219 19.247437,16.002219 C19.6271328,16.002219 19.940928,16.2843728 19.9905904,16.6504484 L19.997437,16.752219 L19.997437,17.25 C19.997437,19.2542592 18.4250759,20.8912737 16.4465956,20.994802 L16.247437,21 L6.746704,21 C4.74244483,21 3.10543026,19.4276389 3.00190201,17.4491586 L2.996704,17.25 L2.996704,7.75 C2.996704,5.74574083 4.56906505,4.10872626 6.54754543,4.00519801 L6.746704,4 L10.2109085,4 L6.746704,4 Z M14.5006976,6.51985416 L14.5006976,3.75 C14.5006976,3.12602964 15.20748,2.7899466 15.6876724,3.13980165 L15.7698701,3.20874226 L21.7644714,8.95874226 C22.0442311,9.22708681 22.0696965,9.65811353 21.8408438,9.95607385 L21.7645584,10.0411742 L15.7699571,15.7930263 C15.3196822,16.2250675 14.5877784,15.9476738 14.5078455,15.3589039 L14.5006976,15.2518521 L14.5006976,12.5265324 L14.1572053,12.5566444 C11.7575155,12.8069657 9.45747516,13.8878535 7.24265269,15.8173548 C6.72354372,16.2695904 5.9204142,15.8420034 6.00578894,15.1588473 C6.67057872,9.83929778 9.45245108,6.90729635 14.2013326,6.53950096 L14.5006976,6.51985416 L14.5006976,3.75 L14.5006976,6.51985416 Z M16.0006976,5.50864341 L16.0006976,7.25 C16.0006976,7.66421356 15.6649111,8 15.2506976,8 C11.3772927,8 8.97667396,9.67612932 7.93942891,13.1571821 L7.86037164,13.4357543 L8.21256044,13.1989337 C10.4490427,11.7371925 12.7984587,11 15.2506976,11 C15.6303934,11 15.9441885,11.2821539 15.993851,11.6482294 L16.0006976,11.75 L16.0006976,13.4928166 L20.1619348,9.50008715 L16.0006976,5.50864341 Z" id="🎨-Color"></path> </g> </g> </svg> <h2 class="text-2xl font-semibold text-white" data-astro-cid-scuu7fyy>Share</h2> </div> <div class="flex items-center gap-2"> <!-- Twitter --> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F&text=How%20to%20Easily%20Build%20a%20Malware%20Testing%20Lab%20with%20Elastic%20EDR%20and%20TCM's%20AD%20Lab" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.25 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Twitter</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <!-- LinkedIn --> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5<" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>LinkedIn</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F&title=How%20to%20Easily%20Build%20a%20Malware%20Testing%20Lab%20with%20Elastic%20EDR%20and%20TCM's%20AD%20Lab" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5<" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-reddit" viewBox="0 0 16 16"> <path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"></path> <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Reddit</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <!-- Copy Link Button --> <div class="group relative inline-flex copy-button-container" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <button class="cursor-pointer p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200 copy-button" data-text="Copy Link" data-copy-value="https://andrecrafts.com/posts/how-to-build-malware-lab-elastic-edr/" aria-label="Copy Link" data-astro-cid-74lkg7sv> <!-- Button Content Slot -->  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"> <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path> </svg>  </button>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Copy Link</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <script type="module">function c(){const r=document.querySelectorAll(".copy-button-container");for(const n of r){const t=n.querySelector(".copy-button");if(!t||t.dataset.initialized)continue;t.dataset.initialized="true";const e=n.querySelector(".tooltip"),o=n.querySelector(".tooltip-text"),a=t.dataset.copyValue,i=t.dataset.text;!e||!o||!a||!i||(t.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(a),o.innerText="Copied!",e.classList.add("opacity-100")}catch{o.innerText="Copy Failed!",e.classList.add("opacity-100")}window.matchMedia("(hover: hover)").matches||(setTimeout(()=>{e.classList.remove("opacity-100")},1500),setTimeout(()=>{o.innerText=i},1800))}),t.addEventListener("mouseleave",()=>{window.matchMedia("(hover: hover)").matches&&(e.classList.remove("opacity-100"),setTimeout(()=>{o.innerText=i},300))}))}}c();document.addEventListener("DOMContentLoaded",c);</script>  </div> </div> </div> </div> </div> <button class="
flex justify-center items-center p-2 
cursor-pointer rounded-full
text-white bg-white/10 
hover:bg-white/30 rotate-90
fixed bottom-4 right-4 z-50 hidden lg:flex
 back-to-top mr-[2%]" aria-label="Back to top" data-astro-cid-scuu7fyy> <svg class="w-8 h-auto" data-astro-cid-scuu7fyy="true" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path> </svg> </button> <section id="read-next" class="pt-4 pb-10 mt-10 bg-secondary"> <div class="text-center mb-2"> <h2 class="text-4xl font-bold text-white">Read Next</h2> </div> <!-- Work Card Carousel Container --><div class="flex items-center justify-center gap-2 w-fit mx-auto" data-astro-cid-oyovcjtc> <button id="scroll-left" class="
hidden md:flex 2xl:hidden p-2
text-white bg-white/10 rounded-full cursor-pointer
transition-all duration-300 hover:bg-white/30" aria-label="Scroll left" data-astro-cid-oyovcjtc> <svg class="w-8 h-8" data-astro-cid-oyovcjtc="true" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path> </svg> </button> <div id="projects-carousel" class="
scroll-smooth overflow-x-auto hide-scrollbar
flex mx-auto gap-2 xl:gap-4 px-4 pt-6 pb-2
w-[19rem] sm:w-[23rem] md:w-[37rem]
2xl:overflow-visible 2xl:snap-none 2xl:justify-center 2xl:w-full relative" data-astro-cid-oyovcjtc> <div class="flex-shrink-0 w-60 sm:w-70 scroll-snap-center" data-astro-cid-r7kjq4ip> <div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2" data-astro-cid-r7kjq4ip> <div class="relative" data-astro-cid-r7kjq4ip> <a href="/posts/hide-shellcode-in-images" data-astro-cid-r7kjq4ip> <div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center" data-astro-cid-r7kjq4ip> <!-- If scale exists, then apply the img-class class --><img src="/_astro/hiding_shellcode_in_Images.DZ1-0QCA_Z2a1HO.png" alt="Hiding Shellcode in Images with Python and C/C++" data-astro-cid-r7kjq4ip="true" data-full-src="/_astro/hiding_shellcode_in_Images.DZ1-0QCA.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="1286" height="630" class="w-auto h-full img-class">  </div> </a> <a class="absolute top-1.5 right-1.5
flex justify-center items-center p-2 rounded-full
bg-gray-800/60 text-white hover:bg-gray-800/80 
transition-colors duration-200 transform" href="https://github.com/andrecrafts/hide-payload-in-images" target="_blank" rel="noopener noreferrer" aria-label="View Project on Github" data-astro-cid-r7kjq4ip> <svg class="w-5 h-5" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> </div> <a href="/posts/hide-shellcode-in-images" class="m-4 flex flex-col flex-grow overflow-hidden" data-astro-cid-r7kjq4ip> <h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="Hiding Shellcode in Images with Python and C/C++" data-astro-cid-r7kjq4ip>Hiding Shellcode in Images with Python and C/C++</h3> <p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Learn how to hide shellcode payloads in plain sight by embedding them into image files, such as PNGs, using Python." data-astro-cid-r7kjq4ip>Learn how to hide shellcode payloads in plain sight by embedding them into image files, such as PNGs, using Python.</p> <div class="mt-auto" data-astro-cid-r7kjq4ip> <div title="Python, C++, Malware, Red Team, EDR Evasion, Cybersecurity, Hacking, Steganography, Payload Hiding, Programming" class="flex gap-2 mb-4" data-astro-cid-r7kjq4ip>  <span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Python</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>C++</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Malware</span> </div> <div class="flex items-center text-sm text-subtle-gray" data-astro-cid-r7kjq4ip> <span class="mr-auto" data-astro-cid-r7kjq4ip>17 Dec 2024</span> <span data-astro-cid-r7kjq4ip>203</span>
            <svg class="w-5 h-5 text-yellow-400 -mt-1 ml-1" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"> <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon> </svg> </div> </div> </a> </div> </div> <div class="flex-shrink-0 w-60 sm:w-70 scroll-snap-center" data-astro-cid-r7kjq4ip> <div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2" data-astro-cid-r7kjq4ip> <div class="relative" data-astro-cid-r7kjq4ip> <a href="/posts/convert-bloodhound-legacy-queries-to-ce" data-astro-cid-r7kjq4ip> <div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center" data-astro-cid-r7kjq4ip> <!-- If scale exists, then apply the img-class class --><img src="/_astro/blood-hound.DWEY7bi5_yIOW0.png" alt="How to Convert Custom Queries from BloodHound Legacy to BloodHound CE" data-astro-cid-r7kjq4ip="true" data-full-src="/_astro/blood-hound.DWEY7bi5.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="1286" height="630" class="w-auto h-full img-class">  </div> </a> <a class="absolute top-1.5 right-1.5
flex justify-center items-center p-2 rounded-full
bg-gray-800/60 text-white hover:bg-gray-800/80 
transition-colors duration-200 transform" href="https://github.com/andrecrafts/Bloodhound-query-legacy2ce" target="_blank" rel="noopener noreferrer" aria-label="View Project on Github" data-astro-cid-r7kjq4ip> <svg class="w-5 h-5" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> </div> <a href="/posts/convert-bloodhound-legacy-queries-to-ce" class="m-4 flex flex-col flex-grow overflow-hidden" data-astro-cid-r7kjq4ip> <h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="How to Convert Custom Queries from BloodHound Legacy to BloodHound CE" data-astro-cid-r7kjq4ip>How to Convert Custom Queries from BloodHound Legacy to BloodHound CE</h3> <p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Complete guide to migrate and convert custom queries from Legacy BloodHound to BloodHound CE (Community Edition)." data-astro-cid-r7kjq4ip>Complete guide to migrate and convert custom queries from Legacy BloodHound to BloodHound CE (Community Edition).</p> <div class="mt-auto" data-astro-cid-r7kjq4ip> <div title="BloodHound, Red Team, Python, Security Tools, Active Directory, Network Security, Pentesting, Hacking, Programming" class="flex gap-2 mb-4" data-astro-cid-r7kjq4ip>  <span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>BloodHound</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Red Team</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Python</span> </div> <div class="flex items-center text-sm text-subtle-gray" data-astro-cid-r7kjq4ip> <span class="mr-auto" data-astro-cid-r7kjq4ip>9 Jan 2025</span> <span data-astro-cid-r7kjq4ip>31</span>
            <svg class="w-5 h-5 text-yellow-400 -mt-1 ml-1" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"> <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon> </svg> </div> </div> </a> </div> </div> <div class="flex-shrink-0 w-60 sm:w-70 scroll-snap-center" data-astro-cid-r7kjq4ip> <div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2" data-astro-cid-r7kjq4ip> <div class="relative" data-astro-cid-r7kjq4ip> <a href="/posts/bypass-yara-rule-cobaltstrike" data-astro-cid-r7kjq4ip> <div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center" data-astro-cid-r7kjq4ip> <!-- If scale exists, then apply the img-class class --><img src="/_astro/bypass_yara_f0b627fc_evade_edrs.D_48sdOF_ZHMefM.png" alt="Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs" data-astro-cid-r7kjq4ip="true" data-full-src="/_astro/bypass_yara_f0b627fc_evade_edrs.D_48sdOF.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="1285" height="630" class="w-auto h-full img-class">  </div> </a> <a class="absolute top-1.5 right-1.5
flex justify-center items-center p-2 rounded-full
bg-gray-800/60 text-white hover:bg-gray-800/80 
transition-colors duration-200 transform" href="https://github.com/andrecrafts/CobaltStrike-YARA-Bypass-f0b627fc" target="_blank" rel="noopener noreferrer" aria-label="View Project on Github" data-astro-cid-r7kjq4ip> <svg class="w-5 h-5" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> </div> <a href="/posts/bypass-yara-rule-cobaltstrike" class="m-4 flex flex-col flex-grow overflow-hidden" data-astro-cid-r7kjq4ip> <h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs" data-astro-cid-r7kjq4ip>Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs</h3> <p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Bypass Yara Rule Windows_Trojan_CobaltStrike_f0b627fc by randomizing its shellcode signature using a Python script." data-astro-cid-r7kjq4ip>Bypass Yara Rule Windows_Trojan_CobaltStrike_f0b627fc by randomizing its shellcode signature using a Python script.</p> <div class="mt-auto" data-astro-cid-r7kjq4ip> <div title="EDR Evasion, Cobalt Strike, Python, YARA Evasion, Shellcode, Red Team, Programming" class="flex gap-2 mb-4" data-astro-cid-r7kjq4ip>  <span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>EDR Evasion</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Cobalt Strike</span> </div> <div class="flex items-center text-sm text-subtle-gray" data-astro-cid-r7kjq4ip> <span class="mr-auto" data-astro-cid-r7kjq4ip>16 Oct 2024</span> <span data-astro-cid-r7kjq4ip>45</span>
            <svg class="w-5 h-5 text-yellow-400 -mt-1 ml-1" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"> <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon> </svg> </div> </div> </a> </div> </div> <div class="flex-shrink-0 w-60 sm:w-70 scroll-snap-center" data-astro-cid-r7kjq4ip> <div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2" data-astro-cid-r7kjq4ip> <div class="relative" data-astro-cid-r7kjq4ip> <a href="/projects/waffles-force" data-astro-cid-r7kjq4ip> <div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center" data-astro-cid-r7kjq4ip> <!-- If scale exists, then apply the img-class class --><img src="/_astro/waffles-force.DSCEwXiZ_8EQk2.png" alt="WafflesFORCE: Login Brute-Forcer with CSRF Bypass" data-astro-cid-r7kjq4ip="true" data-full-src="/_astro/waffles-force.DSCEwXiZ.png" data-astro-cid-qqdm6bys="true" loading="lazy" decoding="async" fetchpriority="auto" width="1285" height="630" class="w-auto h-full img-class">  </div> </a> <a class="absolute top-1.5 right-1.5
flex justify-center items-center p-2 rounded-full
bg-gray-800/60 text-white hover:bg-gray-800/80 
transition-colors duration-200 transform" href="https://github.com/andrecrafts/WafflesFORCE" target="_blank" rel="noopener noreferrer" aria-label="View Project on Github" data-astro-cid-r7kjq4ip> <svg class="w-5 h-5" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> </div> <a href="/projects/waffles-force" class="m-4 flex flex-col flex-grow overflow-hidden" data-astro-cid-r7kjq4ip> <h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="WafflesFORCE: Login Brute-Forcer with CSRF Bypass" data-astro-cid-r7kjq4ip>WafflesFORCE: Login Brute-Forcer with CSRF Bypass</h3> <p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="A multi-threaded login brute-forcer designed to bypass CSRF token protection by automatically capturing and injecting tokens per request." data-astro-cid-r7kjq4ip>A multi-threaded login brute-forcer designed to bypass CSRF token protection by automatically capturing and injecting tokens per request.</p> <div class="mt-auto" data-astro-cid-r7kjq4ip> <div title="Brute Force, CSRF Bypass, Python, Web Security, Pentesting, Red Team, Security Tools" class="flex gap-2 mb-4" data-astro-cid-r7kjq4ip>  <span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>Brute Force</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md" data-astro-cid-r7kjq4ip>CSRF Bypass</span> </div> <div class="flex items-center text-sm text-subtle-gray" data-astro-cid-r7kjq4ip> <span class="mr-auto" data-astro-cid-r7kjq4ip>16 Jul 2024</span> <span data-astro-cid-r7kjq4ip>9</span>
            <svg class="w-5 h-5 text-yellow-400 -mt-1 ml-1" data-astro-cid-r7kjq4ip="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"> <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon> </svg> </div> </div> </a> </div> </div>  </div> <button id="scroll-right" class="
hidden md:flex 2xl:hidden p-2
text-white bg-white/10 rounded-full cursor-pointer
transition-all duration-300 hover:bg-white/30 rotate-180" aria-label="Scroll right" data-astro-cid-oyovcjtc> <svg class="w-8 h-8" data-astro-cid-oyovcjtc="true" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path> </svg> </button> </div> <div id="dots-container" class="carousel-dots flex justify-center
gap-3 mt-4 2xl:hidden" data-astro-cid-oyovcjtc> <div class="dot
[@media(hover:hover)]:hover:bg-sky-500
w-2.5 h-2.5 rounded-full cursor-pointer
bg-white/30 transition-all duration-200" data-astro-cid-oyovcjtc></div><div class="dot
[@media(hover:hover)]:hover:bg-sky-500
w-2.5 h-2.5 rounded-full cursor-pointer
bg-white/30 transition-all duration-200" data-astro-cid-oyovcjtc></div><div class="dot
[@media(hover:hover)]:hover:bg-sky-500
w-2.5 h-2.5 rounded-full cursor-pointer
bg-white/30 transition-all duration-200" data-astro-cid-oyovcjtc></div><div class="dot
[@media(hover:hover)]:hover:bg-sky-500
w-2.5 h-2.5 rounded-full cursor-pointer
bg-white/30 transition-all duration-200" data-astro-cid-oyovcjtc></div> </div> <script type="module">function u(){const t=document.getElementById("projects-carousel"),i=document.getElementById("dots-container");if(!t||!i)return;const n=Array.from(t.children),o=Array.from(i.children);if(n.length===0||o.length===0)return;const h=window.matchMedia("(min-width: 768px)"),c=window.matchMedia("(min-width: 1536px)"),a=new IntersectionObserver(e=>{const l=e.find(s=>s.isIntersecting);if(!l)return;const m=n.indexOf(l.target);let r;h.matches?r=Math.floor(m/2):r=m,o.forEach((s,f)=>{s.classList.toggle("active",f===r)})},{root:t,threshold:.95});function d(){c.matches?(a.disconnect(),o.forEach(e=>e.classList.remove("active"))):n.forEach(e=>a.observe(e))}c.addEventListener("change",d),d()}document.addEventListener("DOMContentLoaded",u);</script> <script type="module">function m(){const r=document.getElementById("projects-carousel"),c=document.getElementById("scroll-left"),i=document.getElementById("scroll-right"),s=document.getElementById("dots-container");if(!r||!c||!i||!s)return;const t=Array.from(r.children);if(t.length===0)return;const o=Array.from(s.children);if(o.length===0)return;const a=window.matchMedia("(min-width: 768px)");function n(e){const d=t[e];let l="center";e===0?l="center":e===t.length-1&&(l="end"),d.scrollIntoView({behavior:"smooth",inline:l,block:"nearest"})}c.addEventListener("click",()=>{n(0)}),i.addEventListener("click",()=>{n(t.length-1)});for(let e=0;e<o.length;e++)o[e].addEventListener("click",()=>{if(!a.matches){n(e);return}e===0?n(0):e===1&&n(t.length-1)})}document.addEventListener("DOMContentLoaded",m);</script>  <div class="flex justify-center gap-4 flex-col 
items-center mt-10"> <a class="
text-white font-bold text-lg
rounded-lg py-3 px-5
will-change-transform transform transition-all duration-300 bg-secondary-accent
hover:ring-white hover:bg-white hover:text-black hover:scale-105" href="/work">View more</a> </div> </section> <div class="lg:hidden" data-astro-cid-scuu7fyy> <div class="back-to-top z-50 lg:hidden fixed bottom-0 left-0 right-0 flex justify-center items-center
    bg-header border-t border-l border-r border-white/10 rounded-t-lg cursor-pointer" data-astro-cid-scuu7fyy> <svg class="w-6 h-6 rotate-90" data-astro-cid-scuu7fyy="true" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path> </svg> </div> <astro-modal data-unique-id="modal-toc-trigger" data-trigger-selector="toc-trigger" data-astro-cid-qmzm2soj="true"> <div id="modal-toc-trigger" class="modal-container z-10 fixed inset-0 bg-black/60 flex items-center justify-center p-4" data-astro-cid-qmzm2soj> <div class="bg-header rounded-lg max-w-md md:max-w-2xl max-h-[60vh] flex flex-col" data-astro-cid-qmzm2soj> <header class="py-2 px-3 flex justify-between items-center border-b border-gray-700" data-astro-cid-qmzm2soj> <h2 class="font-semibold text-lg" data-astro-cid-qmzm2soj>Table of Contents</h2> <button class="close-modal-btn cursor-pointer" data-astro-cid-qmzm2soj> <svg class="h-6 w-6" data-astro-cid-qmzm2soj="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </header>  <div class="overflow-y-auto scroll-fade-container py-3 px-2 flex-1 md:text-lg" data-astro-cid-qmzm2soj>  <ul class="pl-3 pr-2 " data-astro-cid-xvrfupwn> <li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#introduction" class="toc-link-mobile" data-astro-cid-xvrfupwn> Introduction </a> </div>  </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#initial-lab" class="toc-link-mobile" data-astro-cid-xvrfupwn> Initial Lab </a> </div> <div class="h3-list-wrapper" data-astro-cid-xvrfupwn> <ul class="toc-h3-list pl-6 pr-2" data-astro-cid-xvrfupwn>  <li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#pre-requisites" class="toc-link-mobile" data-astro-cid-xvrfupwn> Pre-requisites </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-the-domain-controller" class="toc-link-mobile" data-astro-cid-xvrfupwn> Setting up the Domain Controller </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-the-user-machines" class="toc-link-mobile" data-astro-cid-xvrfupwn> Setting up the User Machines </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#setting-up-users-groups-and-policies-on-the-domain-controller" class="toc-link-mobile" data-astro-cid-xvrfupwn> Setting up Users, Groups, and Policies on the Domain Controller </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#join-user-machines-to-domain" class="toc-link-mobile" data-astro-cid-xvrfupwn> Join User Machines to Domain </a> </li> </ul> </div> </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#adding-elastic-edr" class="toc-link-mobile" data-astro-cid-xvrfupwn> Adding Elastic EDR </a> </div> <div class="h3-list-wrapper" data-astro-cid-xvrfupwn> <ul class="toc-h3-list pl-6 pr-2" data-astro-cid-xvrfupwn>  <li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#installing-docker" class="toc-link-mobile" data-astro-cid-xvrfupwn> Installing Docker </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#creating-elastic-container" class="toc-link-mobile" data-astro-cid-xvrfupwn> Creating Elastic Container </a> </li><li class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#all-elastic-edr-container-options" class="toc-link-mobile" data-astro-cid-xvrfupwn> All Elastic EDR container options </a> </li> </ul> </div> </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#conclusion" class="toc-link-mobile" data-astro-cid-xvrfupwn> Conclusion </a> </div>  </li><li class="toc-h2-item" data-astro-cid-xvrfupwn>  <div class="line-height-[1.10rem] mb-3 text-wrap wrap-break-word text-slate-400 [@media_(hover:hover)]:hover:text-sky-400 transition-colors" data-astro-cid-xvrfupwn> <a href="#references" class="toc-link-mobile" data-astro-cid-xvrfupwn> References </a> </div>  </li> </ul>    </div> </div> </div> </astro-modal> <script type="module">function c(s){if(!s)return;const t=()=>{if(!(s.scrollHeight>s.clientHeight)){s.classList.remove("is-scrolling","is-at-top","is-at-bottom");return}const e=s.scrollTop<1,i=s.scrollHeight-s.scrollTop<=s.clientHeight+1;e?(s.classList.add("is-at-top"),s.classList.remove("is-scrolling","is-at-bottom")):i?(s.classList.add("is-at-bottom"),s.classList.remove("is-scrolling","is-at-top")):(s.classList.add("is-scrolling"),s.classList.remove("is-at-top","is-at-bottom"))};s.addEventListener("scroll",t),window.addEventListener("resize",t),new MutationObserver(t).observe(s,{childList:!0,subtree:!0}),t()}document.querySelectorAll(".scroll-fade-container").forEach(s=>{c(s)});</script>  <script type="module">class i extends HTMLElement{connectedCallback(){const r=this.dataset.uniqueId,n=this.dataset.triggerSelector,e=this.querySelector(`#${r}`);if(!e){console.error("Modal container not found!");return}function t(){e.classList.toggle("show")}function c(){const o=document.querySelector(`#${n}`);if(!o){console.error(`Modal trigger element "${n}" not found!`);return}const l=e.querySelector(".close-modal-btn");o.addEventListener("click",t),l?.addEventListener("click",t),e.addEventListener("click",s=>{s.target===e&&t()})}c()}}customElements.define("astro-modal",i);</script>  </div> <astro-modal data-unique-id="modal-share-trigger" data-trigger-selector="share-trigger" data-astro-cid-qmzm2soj="true"> <div id="modal-share-trigger" class="modal-container z-10 fixed inset-0 bg-black/60 flex items-center justify-center p-4" data-astro-cid-qmzm2soj> <div class="bg-header rounded-lg max-w-md md:max-w-2xl max-h-[60vh] flex flex-col" data-astro-cid-qmzm2soj> <header class="py-2 px-3 flex justify-between items-center border-b border-gray-700" data-astro-cid-qmzm2soj> <h2 class="font-semibold text-lg" data-astro-cid-qmzm2soj>Share</h2> <button class="close-modal-btn cursor-pointer" data-astro-cid-qmzm2soj> <svg class="h-6 w-6" data-astro-cid-qmzm2soj="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </header>  <div class="scroll-fade-container py-3 px-2 flex-1 md:text-lg" data-astro-cid-qmzm2soj>  <div class="flex items-center gap-2"> <!-- Twitter --> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F&text=How%20to%20Easily%20Build%20a%20Malware%20Testing%20Lab%20with%20Elastic%20EDR%20and%20TCM's%20AD%20Lab" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"> <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.25 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Twitter</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <!-- LinkedIn --> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5<" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>LinkedIn</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <div class="group relative inline-flex" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fandrecrafts.com%2Fposts%2Fhow-to-build-malware-lab-elastic-edr%2F&title=How%20to%20Easily%20Build%20a%20Malware%20Testing%20Lab%20with%20Elastic%20EDR%20and%20TCM's%20AD%20Lab" target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200"> <svg class="w-5 h-5<" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-reddit" viewBox="0 0 16 16"> <path d="M6.167 8a.83.83 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661m1.843 3.647c.315 0 1.403-.038 1.976-.611a.23.23 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83s.83-.381.83-.83a.831.831 0 0 0-1.66 0z"></path> <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.2.2 0 0 0-.153.028.2.2 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224q-.03.17-.029.353c0 1.795 2.091 3.256 4.669 3.256s4.668-1.451 4.668-3.256c0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165"></path> </svg> </a>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Reddit</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div> <!-- Copy Link Button --> <div class="group relative inline-flex copy-button-container" data-astro-cid-lejbfuzf> <!-- Whatever you put inside the TooltipWrapper tags goes here -->  <button class="cursor-pointer p-2 rounded-lg bg-secondary-accent hover:bg-sky-600 text-subtle-gray hover:text-white transition-all duration-200 copy-button" data-text="Copy Link" data-copy-value="https://andrecrafts.com/posts/how-to-build-malware-lab-elastic-edr/" aria-label="Copy Link" data-astro-cid-74lkg7sv> <!-- Button Content Slot -->  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"> <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path> </svg>  </button>  <div role="tooltip" class="tooltip
  absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1.5 
  text-sm font-medium bg-secondary-accent
  rounded-md shadow-lg w-max max-w-xs
  opacity-0 [@media_(hover:hover)]:group-hover:opacity-100
  transition-opacity duration-300 pointer-events-none
" data-astro-cid-lejbfuzf> <span class="tooltip-text" data-astro-cid-lejbfuzf>Copy Link</span> <div class="tooltip-arrow absolute left-1/2 -translate-x-1/2
  top-full w-4 h-2
  bg-secondary-accent
" data-astro-cid-lejbfuzf></div> </div> </div>   </div>  </div> </div> </div> </astro-modal>     <dialog id="image-modal" class="modal-container bg-transparent p-0 max-w-full max-h-full w-full h-full backdrop:bg-black/80" data-astro-cid-qj24g3rp> <!-- Modal Content Container --> <div class="modal-container relative w-full h-full flex items-center justify-center p-4 md:p-8" data-astro-cid-qj24g3rp> <!-- Close Button --> <button id="modal-close-btn" class="modal-container outline-none cursor-pointer absolute top-13 right-13 z-20 text-white bg-gray-600 hover:bg-gray-500  rounded-full p-2 transition-colors" aria-label="Close image viewer" data-astro-cid-qj24g3rp> <svg class="w-6 h-6" data-astro-cid-qj24g3rp="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> <!-- Image Wrapper for zooming --> <div class="modal-container relative w-full h-full flex items-center justify-center" data-astro-cid-qj24g3rp> <img id="modal-image" src="" alt="" class="max-w-full max-h-full object-contain transition-transform duration-300 ease-in-out cursor-zoom-in" data-zoomed="false" data-astro-cid-qj24g3rp> </div> </div> </dialog> <script type="module">document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("image-modal"),a=document.querySelectorAll(".modal-container"),e=document.getElementById("modal-image"),c=document.querySelector("article");if(!n||!e||!a||!c)return;c.querySelectorAll(".img-class").forEach(o=>{o.addEventListener("click",()=>{const l=o.dataset.fullSrc||o.src;e.src=l,e.alt=o.alt,e.dataset.zoomed="false",n.showModal(),document.body.style.overflow="hidden"})});function d(o){if(o.stopPropagation(),e.dataset.zoomed==="true")e.dataset.zoomed="false";else{const t=e.getBoundingClientRect(),r=o.clientX-t.left,i=o.clientY-t.top,m=r/t.width*100,f=i/t.height*100;e.style.transformOrigin=`${m}% ${f}%`,e.dataset.zoomed="true"}}e.addEventListener("click",d);const s=()=>{n.close(),document.body.style.overflow=""};for(const o of a)o.addEventListener("click",s)});</script>   </main> <footer id="contact" class="bg-header border-t-1 border-white " data-astro-cid-sz7xmlte> <div class="container mx-auto pt-8 pb-10 px-4 text-center" data-astro-cid-sz7xmlte> <h2 class="text-3xl sm:text-4xl font-bold text-white mb-6 2xl:mb-4" data-astro-cid-sz7xmlte>
Let's Build Something Together
</h2> <p class="mb-6 text-lg" data-astro-cid-sz7xmlte>
Have a project in mind or just want to chat?
<br data-astro-cid-sz7xmlte>Feel free to reach out at
<span id="email-text" class="font-bold" data-astro-cid-sz7xmlte>andrecrafts.work@gmail.com</span> <button id="copy-button" class="-mt-1 -ml-0.5 
relative group inline-flex items-baseline 
highlight-btn cursor-pointer transition-colors duration-300
" aria-label="Copy email address" data-astro-cid-sz7xmlte> <svg class="w-6 h-6 translate-y-1.7" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <div id="tooltip" role="tooltip" class="
absolute md:text-nowrap -top-7.1 left-1/2 -translate-x-1/2 z-10 px-1 py-1 
text-sm font-medium text-white bg-secondary-accent 
rounded-sm shadow-sm opacity-0 
[@media_(hover:hover)]:group-hover:opacity-100 pointer-events-none transition-opacity duration-300" data-astro-cid-sz7xmlte> <span id="tooltip-text" data-astro-cid-sz7xmlte>Copy email</span> <div class="
tooltip-arrow absolute w-3 h-1.5 top-full left-1/2 -translate-x-1/2" data-astro-cid-sz7xmlte></div> </div> </button> </p> <a href="https://cal.com/andrecrafts/meet" target="_blank" rel="noopener noreferrer" aria-label="Google Calendar Meeting" class="
  text-white text-lg font-bold 
  py-3 px-6 mb-8 rounded-lg inline-block 
  bg-sky-500 transition-all duration-300
  hover:scale-105 hover:bg-sky-400 transform will-change-transform" data-astro-cid-sz7xmlte>
Schedule Meeting
</a> <div class="flex justify-center space-x-6 mb-6" data-astro-cid-sz7xmlte> <a href="https://github.com/andrecrafts" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="hover:text-sky-500 transition-colors duration-300" data-astro-cid-sz7xmlte> <svg class="w-8 h-8" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> <a href="https://linkedin.com/in/andre0liveira" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="hover:text-sky-500 transition-colors duration-300" data-astro-cid-sz7xmlte> <svg class="w-8 h-8" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path> </svg> </a> </div> <p class="text-sm text-slate-300" data-astro-cid-sz7xmlte>
© 2025 AndreCrafts. All Rights Reserved.
</p> </div> </footer> <script type="module">function a(){const t=document.getElementById("copy-button"),e=document.getElementById("tooltip"),o=document.getElementById("tooltip-text");!t||!e||!o||(t.addEventListener("click",async()=>{try{await navigator.clipboard.writeText("andrecrafts.work@gmail.com"),o.innerText="Copied!",e.classList.add("opacity-100")}catch(n){console.error(n);return}window.matchMedia("(hover: hover)").matches||(t.classList.add("highlight-btn"),setTimeout(()=>{e.classList.remove("opacity-100"),t.classList.remove("highlight-btn")},1500),setTimeout(()=>{o.innerText="Copy email"},1800))}),t.addEventListener("mouseleave",()=>{window.matchMedia("(hover: hover)").matches&&(e.classList.remove("opacity-100"),setTimeout(()=>{o.innerText="Copy email"},300))}))}document.addEventListener("DOMContentLoaded",a);</script>  </body></html>   <script type="module">document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("tags-wrapper"),t=document.getElementById("show-all-btn"),n=document.getElementById("show-less-btn");if(!e||!t||!n)return;const s=()=>{const d=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!d)),d?t.focus():n.focus()};t.addEventListener("click",s),n.addEventListener("click",s)});</script> <script type="module">function e(o,t){window.scrollY>t?o.classList.add("show"):o.classList.remove("show")}function s(){window.scrollTo({top:0,behavior:"smooth"})}function i(){const o=document.querySelectorAll(".back-to-top");if(o.length===0)return;const t=200;for(const n of o)n.addEventListener("click",s);window.addEventListener("scroll",()=>{for(const n of o)e(n,t)})}document.addEventListener("DOMContentLoaded",i);</script> <script type="module">function n(){const e=document.querySelector('h2[data-active="true"], h3[data-active="true"]');if(document.querySelectorAll("a.toc-link-mobile").forEach(t=>t.setAttribute("data-active","false")),e){const t=e.id,o=document.querySelector(`a.toc-link-mobile[href="#${t}"]`);o?.setAttribute("data-active","true"),o?.scrollIntoView({behavior:"smooth",block:"center"})}}function l(){const e=document.getElementById("modal-toc-trigger"),c=document.getElementById("toc-trigger"),t=document.querySelectorAll(".toc-link-mobile");if(!e||!c||!t)return;function o(){e.classList.toggle("show")}c.addEventListener("click",()=>{n()}),t.forEach(i=>{i.addEventListener("click",o)})}document.addEventListener("DOMContentLoaded",l);</script> 